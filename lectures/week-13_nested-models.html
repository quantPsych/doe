<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Davood Tofighi, Ph.D.">

<title>Nested Models in Statistical Design – STAT 454/545 - Analysis of Variance and Experimental Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-68b729f92b170261f1b1556cc4834a67.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Montserrat:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Nested Models in Statistical Design – STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:description" content="Analysis of Variance and Experimental Design">
<meta property="og:image" content="https://Data-Wise.github.io/doe/lectures/assets/images/logo.png">
<meta property="og:site_name" content="STAT 454/545 - Analysis of Variance and Experimental Design">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 545</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/syllabus-final.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_lectures.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_help.html"> 
<span class="menu-text">R Help</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_appendix.html"> 
<span class="menu-text">Appendix</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contents.html"> 
<span class="menu-text">Contents</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Nested Models in Statistical Design</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Nested Models in Statistical Design</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Davood Tofighi, Ph.D. </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">05-Jan-2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus-final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R Code and Datasets</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r_help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Help</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r-code-data-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Code and Datasets from the Book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data-files-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets from the Book</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  </ul></li>
  <li><a href="#key-concepts" id="toc-key-concepts" class="nav-link" data-scroll-target="#key-concepts">Key Concepts</a>
  <ul class="collapse">
  <li><a href="#nested-vs.-crossed-factors" id="toc-nested-vs.-crossed-factors" class="nav-link" data-scroll-target="#nested-vs.-crossed-factors">Nested vs.&nbsp;Crossed Factors</a>
  <ul class="collapse">
  <li><a href="#nested-factors" id="toc-nested-factors" class="nav-link" data-scroll-target="#nested-factors">Nested Factors</a></li>
  <li><a href="#crossed-factors" id="toc-crossed-factors" class="nav-link" data-scroll-target="#crossed-factors">Crossed Factors</a></li>
  <li><a href="#applications-of-nested-models" id="toc-applications-of-nested-models" class="nav-link" data-scroll-target="#applications-of-nested-models">Applications of Nested Models</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#model-formulation" id="toc-model-formulation" class="nav-link" data-scroll-target="#model-formulation">Model Formulation</a>
  <ul class="collapse">
  <li><a href="#fixed-effects-nested-model" id="toc-fixed-effects-nested-model" class="nav-link" data-scroll-target="#fixed-effects-nested-model">Fixed-Effects Nested Model</a>
  <ul class="collapse">
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification">Model Specification</a></li>
  </ul></li>
  <li><a href="#random-effects-nested-model" id="toc-random-effects-nested-model" class="nav-link" data-scroll-target="#random-effects-nested-model">Random-Effects Nested Model</a>
  <ul class="collapse">
  <li><a href="#model-specification-1" id="toc-model-specification-1" class="nav-link" data-scroll-target="#model-specification-1">Model Specification</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#analysis-of-variance-components" id="toc-analysis-of-variance-components" class="nav-link" data-scroll-target="#analysis-of-variance-components">Analysis of Variance Components</a>
  <ul class="collapse">
  <li><a href="#expected-mean-squares" id="toc-expected-mean-squares" class="nav-link" data-scroll-target="#expected-mean-squares">Expected Mean Squares</a>
  <ul class="collapse">
  <li><a href="#ems-for-fixed-effects-nested-model" id="toc-ems-for-fixed-effects-nested-model" class="nav-link" data-scroll-target="#ems-for-fixed-effects-nested-model">EMS for Fixed-Effects Nested Model</a></li>
  <li><a href="#estimation-of-variance-components" id="toc-estimation-of-variance-components" class="nav-link" data-scroll-target="#estimation-of-variance-components">Estimation of Variance Components</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#practical-applications-in-r" id="toc-practical-applications-in-r" class="nav-link" data-scroll-target="#practical-applications-in-r">Practical Applications in R</a>
  <ul class="collapse">
  <li><a href="#example-1-machine-heads-nested-in-machines" id="toc-example-1-machine-heads-nested-in-machines" class="nav-link" data-scroll-target="#example-1-machine-heads-nested-in-machines">Example 1: Machine Heads Nested in Machines</a>
  <ul class="collapse">
  <li><a href="#step-by-step-r-implementation" id="toc-step-by-step-r-implementation" class="nav-link" data-scroll-target="#step-by-step-r-implementation">Step-by-Step R Implementation</a></li>
  </ul></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#example-2-nested-design-anova" id="toc-example-2-nested-design-anova" class="nav-link" data-scroll-target="#example-2-nested-design-anova">Example 2: Nested Design ANOVA</a>
  <ul class="collapse">
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  </ul></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  </ul></li>
  <li><a href="#advanced-topics" id="toc-advanced-topics" class="nav-link" data-scroll-target="#advanced-topics">Advanced Topics</a>
  <ul class="collapse">
  <li><a href="#degrees-of-freedom" id="toc-degrees-of-freedom" class="nav-link" data-scroll-target="#degrees-of-freedom">Degrees of Freedom</a></li>
  <li><a href="#estimable-contrasts" id="toc-estimable-contrasts" class="nav-link" data-scroll-target="#estimable-contrasts">Estimable Contrasts</a>
  <ul class="collapse">
  <li><a href="#constructing-contrasts" id="toc-constructing-contrasts" class="nav-link" data-scroll-target="#constructing-contrasts">Constructing Contrasts</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  </ul></li>
  <li><a href="#appendix-mathematical-derivations" id="toc-appendix-mathematical-derivations" class="nav-link" data-scroll-target="#appendix-mathematical-derivations">Appendix: Mathematical Derivations</a>
  <ul class="collapse">
  <li><a href="#variance-component-estimation" id="toc-variance-component-estimation" class="nav-link" data-scroll-target="#variance-component-estimation">Variance Component Estimation</a>
  <ul class="collapse">
  <li><a href="#deriving-expected-mean-squares-for-nested-models" id="toc-deriving-expected-mean-squares-for-nested-models" class="nav-link" data-scroll-target="#deriving-expected-mean-squares-for-nested-models">Deriving Expected Mean Squares for Nested Models</a></li>
  <li><a href="#expected-mean-squares-1" id="toc-expected-mean-squares-1" class="nav-link" data-scroll-target="#expected-mean-squares-1">Expected Mean Squares</a></li>
  </ul></li>
  <li><a href="#derivation-steps" id="toc-derivation-steps" class="nav-link" data-scroll-target="#derivation-steps">Derivation Steps</a>
  <ul class="collapse">
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#confidence-intervals-for-variance-components" id="toc-confidence-intervals-for-variance-components" class="nav-link" data-scroll-target="#confidence-intervals-for-variance-components">Confidence Intervals for Variance Components</a>
  <ul class="collapse">
  <li><a href="#satterthwaite-approximation" id="toc-satterthwaite-approximation" class="nav-link" data-scroll-target="#satterthwaite-approximation">Satterthwaite Approximation</a>
  <ul class="collapse">
  <li><a href="#steps" id="toc-steps" class="nav-link" data-scroll-target="#steps">Steps</a></li>
  </ul></li>
  <li><a href="#example-in-r" id="toc-example-in-r" class="nav-link" data-scroll-target="#example-in-r">Example in R</a>
  <ul class="collapse">
  <li><a href="#interpretation-2" id="toc-interpretation-2" class="nav-link" data-scroll-target="#interpretation-2">Interpretation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#medium-difficulty" id="toc-medium-difficulty" class="nav-link" data-scroll-target="#medium-difficulty">Medium Difficulty</a></li>
  <li><a href="#two-way-ancova-with-interaction" id="toc-two-way-ancova-with-interaction" class="nav-link" data-scroll-target="#two-way-ancova-with-interaction">1. Two-Way ANCOVA with Interaction</a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#expected-answers" id="toc-expected-answers" class="nav-link" data-scroll-target="#expected-answers">Expected Answers</a></li>
  </ul></li>
  <li><a href="#challenging-problems" id="toc-challenging-problems" class="nav-link" data-scroll-target="#challenging-problems">Challenging Problems</a>
  <ul class="collapse">
  <li><a href="#unbalanced-two-factor-ancova-analysis" id="toc-unbalanced-two-factor-ancova-analysis" class="nav-link" data-scroll-target="#unbalanced-two-factor-ancova-analysis">1. Unbalanced Two-Factor ANCOVA Analysis</a></li>
  <li><a href="#r-code-example" id="toc-r-code-example" class="nav-link" data-scroll-target="#r-code-example">R Code Example</a></li>
  <li><a href="#discussion-points" id="toc-discussion-points" class="nav-link" data-scroll-target="#discussion-points">Discussion Points</a></li>
  <li><a href="#expected-insights" id="toc-expected-insights" class="nav-link" data-scroll-target="#expected-insights">Expected Insights</a></li>
  <li><a href="#three-factor-interaction-interpretation" id="toc-three-factor-interaction-interpretation" class="nav-link" data-scroll-target="#three-factor-interaction-interpretation">2. Three-Factor Interaction Interpretation</a></li>
  <li><a href="#r-code-example-1" id="toc-r-code-example-1" class="nav-link" data-scroll-target="#r-code-example-1">R Code Example</a></li>
  <li><a href="#interpretation-3" id="toc-interpretation-3" class="nav-link" data-scroll-target="#interpretation-3">Interpretation</a></li>
  <li><a href="#mathematical-proof-of-interaction-contrasts" id="toc-mathematical-proof-of-interaction-contrasts" class="nav-link" data-scroll-target="#mathematical-proof-of-interaction-contrasts">3. Mathematical Proof of Interaction Contrasts</a></li>
  <li><a href="#proof-outline" id="toc-proof-outline" class="nav-link" data-scroll-target="#proof-outline">Proof Outline</a></li>
  </ul></li>
  <li><a href="#appendix-advanced-mathematical-derivations" id="toc-appendix-advanced-mathematical-derivations" class="nav-link" data-scroll-target="#appendix-advanced-mathematical-derivations">Appendix: Advanced Mathematical Derivations</a>
  <ul class="collapse">
  <li><a href="#adjusted-treatment-means" id="toc-adjusted-treatment-means" class="nav-link" data-scroll-target="#adjusted-treatment-means">Adjusted Treatment Means</a></li>
  <li><a href="#derivation" id="toc-derivation" class="nav-link" data-scroll-target="#derivation">Derivation</a></li>
  <li><a href="#f-test-for-homogeneity-of-slopes" id="toc-f-test-for-homogeneity-of-slopes" class="nav-link" data-scroll-target="#f-test-for-homogeneity-of-slopes">F-Test for Homogeneity of Slopes</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a></li>
  <li><a href="#confidence-intervals-for-higher-order-contrasts" id="toc-confidence-intervals-for-higher-order-contrasts" class="nav-link" data-scroll-target="#confidence-intervals-for-higher-order-contrasts">Confidence Intervals for Higher-Order Contrasts</a></li>
  <li><a href="#steps-in-r" id="toc-steps-in-r" class="nav-link" data-scroll-target="#steps-in-r">Steps in R</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul></li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1">Exercises</a>
  <ul class="collapse">
  <li><a href="#medium-difficulty-1" id="toc-medium-difficulty-1" class="nav-link" data-scroll-target="#medium-difficulty-1">Medium Difficulty</a></li>
  <li><a href="#r-code-example-2" id="toc-r-code-example-2" class="nav-link" data-scroll-target="#r-code-example-2">R Code Example</a></li>
  <li><a href="#questions-1" id="toc-questions-1" class="nav-link" data-scroll-target="#questions-1">Questions</a></li>
  <li><a href="#expected-answers-1" id="toc-expected-answers-1" class="nav-link" data-scroll-target="#expected-answers-1">Expected Answers</a></li>
  </ul></li>
  <li><a href="#challenging-problems-1" id="toc-challenging-problems-1" class="nav-link" data-scroll-target="#challenging-problems-1">Challenging Problems</a>
  <ul class="collapse">
  <li><a href="#unbalanced-two-factor-ancova-analysis-1" id="toc-unbalanced-two-factor-ancova-analysis-1" class="nav-link" data-scroll-target="#unbalanced-two-factor-ancova-analysis-1">1. Unbalanced Two-Factor ANCOVA Analysis</a></li>
  <li><a href="#r-code-example-3" id="toc-r-code-example-3" class="nav-link" data-scroll-target="#r-code-example-3">R Code Example</a></li>
  <li><a href="#discussion-points-1" id="toc-discussion-points-1" class="nav-link" data-scroll-target="#discussion-points-1">Discussion Points</a></li>
  <li><a href="#expected-insights-1" id="toc-expected-insights-1" class="nav-link" data-scroll-target="#expected-insights-1">Expected Insights</a></li>
  <li><a href="#three-factor-interaction-interpretation-1" id="toc-three-factor-interaction-interpretation-1" class="nav-link" data-scroll-target="#three-factor-interaction-interpretation-1">2. Three-Factor Interaction Interpretation</a></li>
  <li><a href="#r-code-example-4" id="toc-r-code-example-4" class="nav-link" data-scroll-target="#r-code-example-4">R Code Example</a></li>
  <li><a href="#interpretation-4" id="toc-interpretation-4" class="nav-link" data-scroll-target="#interpretation-4">Interpretation</a></li>
  <li><a href="#mathematical-proof-of-interaction-contrasts-1" id="toc-mathematical-proof-of-interaction-contrasts-1" class="nav-link" data-scroll-target="#mathematical-proof-of-interaction-contrasts-1">3. Mathematical Proof of Interaction Contrasts</a></li>
  <li><a href="#proof-outline-1" id="toc-proof-outline-1" class="nav-link" data-scroll-target="#proof-outline-1">Proof Outline</a></li>
  </ul></li>
  <li><a href="#appendix-advanced-mathematical-derivations-1" id="toc-appendix-advanced-mathematical-derivations-1" class="nav-link" data-scroll-target="#appendix-advanced-mathematical-derivations-1">Appendix: Advanced Mathematical Derivations</a>
  <ul class="collapse">
  <li><a href="#expected-mean-squares-for-nested-models" id="toc-expected-mean-squares-for-nested-models" class="nav-link" data-scroll-target="#expected-mean-squares-for-nested-models">Expected Mean Squares for Nested Models</a></li>
  <li><a href="#derivation-steps-1" id="toc-derivation-steps-1" class="nav-link" data-scroll-target="#derivation-steps-1">Derivation Steps</a></li>
  </ul></li>
  <li><a href="#mathematical-proof-of-interaction-contrasts-2" id="toc-mathematical-proof-of-interaction-contrasts-2" class="nav-link" data-scroll-target="#mathematical-proof-of-interaction-contrasts-2">Mathematical Proof of Interaction Contrasts</a>
  <ul class="collapse">
  <li><a href="#interaction-contrasts-measure-deviations-from-additivity" id="toc-interaction-contrasts-measure-deviations-from-additivity" class="nav-link" data-scroll-target="#interaction-contrasts-measure-deviations-from-additivity">Interaction Contrasts Measure Deviations from Additivity</a></li>
  <li><a href="#proof-steps" id="toc-proof-steps" class="nav-link" data-scroll-target="#proof-steps">Proof Steps</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the realm of experimental design and statistical analysis, <strong>Nested Models</strong> are indispensable for handling data with hierarchical or grouped structures. These models are particularly useful when the levels of one factor are only meaningful within the levels of another factor. Understanding nested models allows researchers to account for variability at different levels, ensuring more accurate and generalizable inferences.</p>
<p><strong>Intuitive Analogy:</strong></p>
<p>Consider a university conducting a study on student performance across different courses. Here, courses can be nested within departments, meaning each course belongs to only one department. This hierarchical structure necessitates a nested model to appropriately account for the variability both within and between departments.</p>
<section id="objectives" class="level3">
<h3 class="anchored" data-anchor-id="objectives">Objectives</h3>
<p>By the end of this lecture, you will be able to:</p>
<ul>
<li><strong>Recognize and model</strong> nested factors.</li>
<li><strong>Differentiate</strong> between nested and crossed factors.</li>
<li><strong>Formulate</strong> fixed and random nested models.</li>
<li><strong>Apply</strong> variance components and hypothesis tests to nested designs.</li>
<li><strong>Implement</strong> nested models using R.</li>
<li><strong>Engage</strong> with advanced mathematical concepts through proofs and derivations.</li>
<li><strong>Enhance</strong> your understanding through practical R examples and exercises.</li>
</ul>
</section>
</section>
<section id="key-concepts" class="level1">
<h1>Key Concepts</h1>
<section id="nested-vs.-crossed-factors" class="level2">
<h2 class="anchored" data-anchor-id="nested-vs.-crossed-factors">Nested vs.&nbsp;Crossed Factors</h2>
<section id="nested-factors" class="level3">
<h3 class="anchored" data-anchor-id="nested-factors">Nested Factors</h3>
<p><strong>Definition:</strong></p>
<p>Nested factors occur when the levels of one factor are exclusively contained within the levels of another factor. Each level of the nested factor appears only within one level of the parent factor.</p>
<p><strong>Examples:</strong></p>
<ul>
<li><strong>Cores within Bales</strong>: In wool experiments, multiple cores are sampled from each bale. Here, cores are nested within bales.</li>
<li><strong>Heads within Machines</strong>: When evaluating machine performance, different heads are used within each machine, and each head is specific to a machine.</li>
</ul>
<p><strong>Visual Representation:</strong></p>
<p>Machine 1</p>
<p>├── Head 1</p>
<p>├── Head 2</p>
<p>Machine 2</p>
<p>├── Head 1</p>
<p>├── Head 2</p>
<p>├── Head 3</p>
<p>…</p>
</section>
<section id="crossed-factors" class="level3">
<h3 class="anchored" data-anchor-id="crossed-factors">Crossed Factors</h3>
<p><strong>Definition:</strong></p>
<p>Crossed factors are those where every level of one factor appears with every level of another factor. There is no hierarchical containment, and levels are fully crossed.</p>
<p><strong>Examples:</strong></p>
<ul>
<li><strong>Treatments across Blocks</strong>: Applying multiple treatments across all blocks in an experiment.</li>
<li><strong>Students and Teachers</strong>: If every teacher instructs every student, factors are crossed.</li>
</ul>
<p><strong>Visual Representation:</strong></p>
<p>Teacher 1</p>
<p>├── Student 1</p>
<p>├── Student 2</p>
<p>Teacher 2</p>
<p>├── Student 1</p>
<p>├── Student 2</p>
<p>…</p>
</section>
<section id="applications-of-nested-models" class="level3">
<h3 class="anchored" data-anchor-id="applications-of-nested-models">Applications of Nested Models</h3>
<ul>
<li><strong>Manufacturing:</strong> Assessing variability of machine components within different machines.</li>
<li><strong>Biological Studies:</strong> Measuring responses of plants within different plots.</li>
<li><strong>Educational Research:</strong> Evaluating student performance within classrooms and schools.</li>
</ul>
<p><strong>Reference:</strong></p>
<p>Dean, A., Voss, D., &amp; Draguljić, D. (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
</section>
<section id="model-formulation" class="level1">
<h1>Model Formulation</h1>
<section id="fixed-effects-nested-model" class="level2">
<h2 class="anchored" data-anchor-id="fixed-effects-nested-model">Fixed-Effects Nested Model</h2>
<p>A <strong>Fixed-Effects Nested Model</strong> is used when both the parent and nested factors are of primary interest and their effects are fixed.</p>
<section id="model-specification" class="level3">
<h3 class="anchored" data-anchor-id="model-specification">Model Specification</h3>
<p><span class="math display">\[
Y_{ijt} = \mu + \alpha_i + \beta_j(i) + \epsilon_{ijt}, \quad \epsilon_{ijt} \sim N(0, \sigma^2)
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{ijt}\)</span>: Response for the <span class="math inline">\(t\)</span>-th observation in the <span class="math inline">\(j\)</span>-th nested factor within the <span class="math inline">\(i\)</span>-th parent factor.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\alpha_i\)</span>: Fixed effect of the <span class="math inline">\(i\)</span>-th level of Factor <span class="math inline">\(A\)</span> (parent factor).</li>
<li><span class="math inline">\(\beta_j(i)\)</span>: Fixed effect of the <span class="math inline">\(j\)</span>-th level of Factor <span class="math inline">\(B\)</span> nested within Factor <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(\epsilon_{ijt}\)</span>: Random error.</li>
</ul>
<p><strong>Intuitive Example:</strong></p>
<p>Evaluating the performance of different machine heads within specific machines, where both machines and heads are of fixed interest.</p>
</section>
</section>
<section id="random-effects-nested-model" class="level2">
<h2 class="anchored" data-anchor-id="random-effects-nested-model">Random-Effects Nested Model</h2>
<p>A <strong>Random-Effects Nested Model</strong> treats the nested factors as random effects, assuming they are randomly sampled from a larger population.</p>
<section id="model-specification-1" class="level3">
<h3 class="anchored" data-anchor-id="model-specification-1">Model Specification</h3>
<p><span class="math display">\[
Y_{ijt} = \mu + \alpha_i + B_j(i) + \epsilon_{ijt}, \quad B_j(i) \sim N(0, \sigma^2_B), \quad \epsilon_{ijt} \sim N(0, \sigma^2)
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(B_j(i)\)</span>: Random effect for the <span class="math inline">\(j\)</span>-th level of Factor <span class="math inline">\(B\)</span> nested within Factor <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(\sigma^2_B\)</span>: Variance component for the nested random effect.</li>
<li><span class="math inline">\(\sigma^2\)</span>: Residual error variance.</li>
</ul>
<p><strong>Intuitive Example:</strong></p>
<p>Assessing the variability of machine heads across randomly selected machines from a factory population.</p>
<p><strong>Reference:</strong></p>
<p>Montgomery, D. C., &amp; Runger, G. C. (2010). <em>Applied Statistics and Probability for Engineers</em>. Wiley.</p>
</section>
</section>
</section>
<section id="analysis-of-variance-components" class="level1">
<h1>Analysis of Variance Components</h1>
<section id="expected-mean-squares" class="level2">
<h2 class="anchored" data-anchor-id="expected-mean-squares">Expected Mean Squares</h2>
<p>In random-effects nested models, the <strong>Expected Mean Squares (EMS)</strong> are pivotal for estimating variance components. EMS are derived based on the model’s structure and assumptions.</p>
<section id="ems-for-fixed-effects-nested-model" class="level3">
<h3 class="anchored" data-anchor-id="ems-for-fixed-effects-nested-model">EMS for Fixed-Effects Nested Model</h3>
<p>Given the model:</p>
<p><span class="math display">\[
Y_{ijt} = \mu + \alpha_i + \beta_j(i) + \epsilon_{ijt}
\]</span></p>
<p><strong>Expected Mean Squares:</strong></p>
<p><span class="math display">\[
EMS_A = \sigma^2 + r \sigma^2_B + r b Q(\alpha_i)
\]</span></p>
<p><span class="math display">\[
EMS_B(A) = \sigma^2 + r \sigma^2_B
\]</span></p>
<p><span class="math display">\[
EMS_E = \sigma^2
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(r\)</span>: Number of replicates per nested factor.</li>
<li><span class="math inline">\(b\)</span>: Number of levels of Factor <span class="math inline">\(B\)</span> within each level of Factor <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(Q(\alpha_i)\)</span>: Sum of squares of fixed effects.</li>
</ul>
<p><strong>Reference:</strong></p>
<p>Christensen, R. (2018). <em>Analysis of Variance, Design, and Regression</em>. Chapman and Hall/CRC.</p>
</section>
<section id="estimation-of-variance-components" class="level3">
<h3 class="anchored" data-anchor-id="estimation-of-variance-components">Estimation of Variance Components</h3>
<p>Using the EMS, variance components are estimated as follows:</p>
<p><span class="math display">\[
\hat{\sigma}^2_B = \frac{MS_B(A) - MS_E}{r}
\]</span></p>
<p><span class="math display">\[
\hat{\sigma}^2 = MS_E
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(MS_B(A)\)</span>: Mean Square for the nested factor.</li>
<li><span class="math inline">\(MS_E\)</span>: Mean Square for the error term.</li>
</ul>
<p><strong>Step-by-Step Example:</strong></p>
<p>Suppose we have:</p>
<ul>
<li><span class="math inline">\(a = 5\)</span> levels of Factor <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(b = 4\)</span> levels of Factor <span class="math inline">\(B\)</span> nested within each <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(r = 3\)</span> replicates per <span class="math inline">\(B\)</span>.</li>
</ul>
<p>An ANOVA table would provide <span class="math inline">\(MS_A\)</span>, <span class="math inline">\(MS_B(A)\)</span>, and <span class="math inline">\(MS_E\)</span>, from which variance components are estimated.</p>
</section>
</section>
</section>
<section id="practical-applications-in-r" class="level1">
<h1>Practical Applications in R</h1>
<section id="example-1-machine-heads-nested-in-machines" class="level2">
<h2 class="anchored" data-anchor-id="example-1-machine-heads-nested-in-machines">Example 1: Machine Heads Nested in Machines</h2>
<p><strong>Scenario:</strong></p>
<p>Assessing the performance of machine heads nested within machines to understand variability attributable to different machines.</p>
<section id="step-by-step-r-implementation" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-r-implementation">Step-by-Step R Implementation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated Data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>machines <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each =</span> <span class="dv">20</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>heads <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">5</span>), <span class="dv">5</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="fu">as.numeric</span>(machines) <span class="sc">+</span> <span class="fu">as.numeric</span>(heads) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(response, machines, heads) <span class="co"># Fit Random-Effects Nested Model</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(response <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> machines <span class="sc">/</span> heads), <span class="at">data =</span> data)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Variance Components</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<ol type="1">
<li>Model Fitting:</li>
</ol>
<p>The lmer function fits a random-intercept model where heads are nested within machines.</p>
<ol type="1">
<li>Summary Output:</li>
</ol>
<p>Provides estimates for the fixed effect (overall mean) and random effects (variance components for machines and heads).</p>
<ol type="1">
<li>Variance Components:</li>
</ol>
<ul>
<li>machines: Variability attributable to different machines.</li>
<li>heads within machines: Variability attributable to different heads within the same machine.</li>
<li>Residual: Unexplained variability.</li>
</ul>
<p>Reference:</p>
<p>Kempthorne, O. (1977). Design and Analysis of Experiments. Robert E. Krieger Publishing Company.</p>
</section>
<section id="example-2-nested-design-anova" class="level2">
<h2 class="anchored" data-anchor-id="example-2-nested-design-anova">Example 2: Nested Design ANOVA</h2>
<section id="scenario" class="level3">
<h3 class="anchored" data-anchor-id="scenario">Scenario</h3>
<p>Analyzing a nested design using traditional ANOVA methods.</p>
<p>Step-by-Step R Implementation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nested ANOVA with aov</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>model_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(response <span class="sc">~</span> machines <span class="sc">+</span> <span class="fu">Error</span>(machines <span class="sc">/</span> heads), <span class="at">data =</span> data)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="interpretation-1" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-1">Interpretation</h2>
<ol type="1">
<li>Model Fitting:</li>
</ol>
<p>The aov function specifies heads nested within machines using the Error term.</p>
<ol type="1">
<li>ANOVA Summary:</li>
</ol>
<p>Displays sources of variation, degrees of freedom, sum of squares, mean squares, and F-values for both machines and heads within machines.</p>
<ol type="1">
<li>Hypothesis Testing:</li>
</ol>
<ul>
<li>Machines: Tests if there is significant variability between different machines.</li>
<li>Heads within Machines: Tests if there is significant variability between different heads within the same machine.</li>
</ul>
<p>Reference:</p>
<p>Scheffé, H. (1959). The Analysis of Variance. Wiley.</p>
</section>
</section>
<section id="advanced-topics" class="level1">
<h1>Advanced Topics</h1>
<section id="degrees-of-freedom" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom">Degrees of Freedom</h2>
<p>In nested designs, allocating degrees of freedom correctly is crucial for accurate hypothesis testing.</p>
<p>Calculation for Nested Effects</p>
<p>For a nested effect <span class="math inline">\(B(A)\)</span>:</p>
<p><span class="math display">\[
\nu_{B(A)} = (b - 1) \times a
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(b\)</span>: Number of levels of Factor (B) within each level of Factor (A).</li>
<li><span class="math inline">\(a\)</span>: Number of levels of Factor (A).</li>
</ul>
<p>Example:</p>
<p>If there are 5 machines (<span class="math inline">\(a = 5\)</span>) and 4 heads within each machine (<span class="math inline">\(b = 4\)</span>), then:</p>
<p><span class="math display">\[
\nu_{B(A)} = (4 - 1) \times 5 = 15
\]</span></p>
<p>Reference:</p>
<p>Dean, A., Voss, D., &amp; Draguljić, D. (2017). Design and Analysis of Experiments. Springer.</p>
</section>
<section id="estimable-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="estimable-contrasts">Estimable Contrasts</h2>
<p>In nested models, contrasts within nested factors are restricted to comparisons within each level of the parent factor.</p>
<section id="constructing-contrasts" class="level3">
<h3 class="anchored" data-anchor-id="constructing-contrasts">Constructing Contrasts</h3>
<ul>
<li>Within-Machine Contrasts: Compare different heads within the same machine.</li>
<li>Between-Machine Contrasts: Compare different machines, irrespective of heads.</li>
</ul>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>Comparing the performance of Head 1 vs.&nbsp;Head 2 within Machine 3.</p>
<p>Reference:</p>
<p>Christensen, R. (2018). Analysis of Variance, Design, and Regression. Chapman and Hall/CRC.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>Nested Models are essential for analyzing data with hierarchical or grouped structures.</li>
<li>Fixed-Effects Nested Models focus on specific levels of factors, providing detailed insights into those particular levels.</li>
<li>Random-Effects Nested Models generalize findings to larger populations by treating nested factors as random samples.</li>
<li>Variance Components quantify the variability at different hierarchical levels, facilitating a deeper understanding of data structure.</li>
<li>R Implementation using packages like lme4 and functions like aov allows for flexible modeling of nested designs.</li>
<li>Advanced Topics such as degrees of freedom allocation and estimable contrasts ensure rigorous statistical analysis.</li>
<li>Mathematical Derivations in the appendix provide a theoretical foundation, enhancing comprehension of underlying principles.</li>
</ul>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<ul>
<li>Properly modeling nested structures is crucial for accurate inference.</li>
<li>Differentiating between fixed and random effects guides appropriate model selection.</li>
<li>Understanding variance components aids in dissecting sources of variability.</li>
<li>Practical R examples bridge the gap between theory and application, fostering hands-on learning.</li>
</ul>
<p>Reference:</p>
<p>Montgomery, D. C., &amp; Runger, G. C. (2010). Applied Statistics and Probability for Engineers. Wiley.</p>
</section>
</section>
<section id="appendix-mathematical-derivations" class="level1">
<h1>Appendix: Mathematical Derivations</h1>
<section id="variance-component-estimation" class="level2">
<h2 class="anchored" data-anchor-id="variance-component-estimation">Variance Component Estimation</h2>
<section id="deriving-expected-mean-squares-for-nested-models" class="level3">
<h3 class="anchored" data-anchor-id="deriving-expected-mean-squares-for-nested-models">Deriving Expected Mean Squares for Nested Models</h3>
<p>Consider the Fixed-Effects Nested Model:</p>
<p><span class="math display">\[
Y_{ijt} = \mu + \alpha_i + \beta_j(i) + \epsilon_{ijt}, \quad \epsilon_{ijt} \sim N(0, \sigma^2)
\]</span></p>
</section>
<section id="expected-mean-squares-1" class="level3">
<h3 class="anchored" data-anchor-id="expected-mean-squares-1">Expected Mean Squares</h3>
<ol type="1">
<li>For Factor (A):</li>
</ol>
<p><span class="math display">\[
EMS_A = \sigma^2 + r \sigma^2_B + r b Q(\alpha_i)
\]</span></p>
<p>Where <span class="math inline">\(Q(\alpha_i)\)</span> is the sum of squares due to Factor (A).</p>
<ol type="1">
<li>For Factor (B(A)):</li>
</ol>
<p><span class="math display">\[
EMS_B(A) = \sigma^2 + r \sigma^2_B
\]</span></p>
<ol type="1">
<li>For Error:</li>
</ol>
<p><span class="math display">\[
EMS_E = \sigma^2
\]</span></p>
</section>
</section>
<section id="derivation-steps" class="level2">
<h2 class="anchored" data-anchor-id="derivation-steps">Derivation Steps</h2>
<ol type="1">
<li>Assumptions:</li>
</ol>
<ul>
<li><span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\beta_j(i)\)</span> are fixed effects.</li>
<li>Errors are independent and normally distributed.</li>
</ul>
<ol type="1">
<li>Variance Components:</li>
</ol>
<ul>
<li>Between (A) Groups: Variance due to Factor (A) is zero since (A) is fixed.</li>
<li>Between (B(A)) Groups: Variance due to Factor (B) nested within (A) is <span class="math inline">\(\sigma^2_B\)</span>.</li>
<li>Within (B(A)) Groups: Residual variance is <span class="math inline">\(\sigma^2\)</span>.</li>
</ul>
<ol type="1">
<li>Estimation:</li>
</ol>
<ul>
<li>Using the ANOVA table, mean squares are equated to expected mean squares to solve for variance components.</li>
</ul>
<p><span class="math display">\[
MS_A = \sigma^2 + r \sigma^2_B
\]</span></p>
<p><span class="math display">\[
MS_B(A) = \sigma^2 + r \sigma^2_B
\]</span></p>
<p><span class="math display">\[
MS_E = \sigma^2
\]</span></p>
<p>Solving for <span class="math inline">\(\sigma^2_B\)</span>:</p>
<p><span class="math display">\[
\hat{\sigma}^2_B = \frac{MS_A - MS_E}{r}
\]</span></p>
<p><span class="math display">\[
\hat{\sigma}^2 = MS_E
\]</span></p>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>The derivation showcases how ANOVA decomposes total variability into components attributable to nested factors and residual error, facilitating the estimation of variance components.</p>
<p>Reference:</p>
<p>Montgomery, D. C., &amp; Runger, G. C. (2010). Applied Statistics and Probability for Engineers. Wiley.</p>
</section>
</section>
</section>
<section id="confidence-intervals-for-variance-components" class="level1">
<h1>Confidence Intervals for Variance Components</h1>
<section id="satterthwaite-approximation" class="level2">
<h2 class="anchored" data-anchor-id="satterthwaite-approximation">Satterthwaite Approximation</h2>
<p>The Satterthwaite Approximation is employed to estimate the degrees of freedom for variance components, enabling the construction of confidence intervals.</p>
<section id="steps" class="level3">
<h3 class="anchored" data-anchor-id="steps">Steps</h3>
<ol type="1">
<li>Estimate Variance Components:</li>
</ol>
<p>Using REML or other estimation methods, obtain estimates for <span class="math inline">\(\sigma^2_B\)</span> and <span class="math inline">\(\sigma^2\)</span>.</p>
<ol type="1">
<li>Calculate Degrees of Freedom:</li>
</ol>
<p>Approximated based on the variance component estimates.</p>
<ol type="1">
<li>Construct Confidence Intervals:</li>
</ol>
<p><span class="math display">\[
CI = \hat{\sigma}^2 \pm t_{\alpha/2, df} \times SE(\hat{\sigma}^2)
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\hat{\sigma}^2\)</span>: Estimated variance component.</li>
<li><span class="math inline">\(t_{\alpha/2, df}\)</span>: Critical value from the t-distribution.</li>
<li><span class="math inline">\(SE(\hat{\sigma}^2)\)</span>: Standard error of the variance component estimate.</li>
</ul>
</section>
</section>
<section id="example-in-r" class="level2">
<h2 class="anchored" data-anchor-id="example-in-r">Example in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the Model</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(response <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> machines <span class="sc">/</span> heads), <span class="at">data =</span> data)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract variance Components</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>var_components <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(model)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>sigma_B_sq <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(var_components<span class="sc">$</span>machines<span class="sc">:</span>heads)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>sigma_sq <span class="ot">&lt;-</span> <span class="fu">attr</span>(var_components, <span class="st">"sc"</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence Intervals Using Wald Method</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model, <span class="at">parm =</span> <span class="st">"sigma_B_sq"</span>, <span class="at">method =</span> <span class="st">"Wald"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model, <span class="at">parm =</span> <span class="st">"sigma_sq"</span>, <span class="at">method =</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretation-2" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-2">Interpretation</h3>
<p>The <code>confint</code> function provides confidence intervals for the variance components, allowing for inference about population variability.</p>
<p>Reference:</p>
<p>Christensen, R. (2018). Analysis of Variance, Design, and Regression. Chapman and Hall/CRC.</p>
</section>
</section>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<section id="medium-difficulty" class="level2">
<h2 class="anchored" data-anchor-id="medium-difficulty">Medium Difficulty</h2>
</section>
<section id="two-way-ancova-with-interaction" class="level2">
<h2 class="anchored" data-anchor-id="two-way-ancova-with-interaction">1. Two-Way ANCOVA with Interaction</h2>
<p>Dataset: Simulate a dataset with three treatments and one covariate.</p>
<p>Tasks:</p>
<ul>
<li>Generate data for treatments A, B, C with a covariate (X).</li>
<li>Fit an ANCOVA model adjusting for (X).</li>
<li>Test the significance of treatment effects and the covariate.</li>
<li>Generate diagnostic plots and interpret them.</li>
</ul>
<p>R Code Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Factors and Covariate</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each =</span> <span class="dv">30</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Treatment Effects and Covariate EffectY &lt;- 5 + ifelse(Treatment == "A", 0, ifelse(Treatment == "B", 2, 4)) + 0.5 * (X - mean(X)) + rnorm(90, mean=0, sd=3)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Treatment, X, Y)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>model_sim <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">+</span> X, <span class="at">data =</span> data_sim)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_sim)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic Plots</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_sim)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>emm_sim <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_sim, <span class="sc">~</span>Treatment)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>pairwise_sim <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_sim, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions</h2>
<ol type="1">
<li>Main Effects:</li>
</ol>
<ul>
<li>Treatment: What are the estimated effects of treatments A, B, and C?</li>
<li>Covariate (X): How does (X) influence the response variable (Y)?</li>
</ul>
<ol type="1">
<li>Significance Testing:</li>
</ol>
<ul>
<li>Are the treatment effects statistically significant after adjusting for (X)?</li>
<li>Is the covariate (X) a significant predictor of (Y)?</li>
</ul>
<ol type="1">
<li>Diagnostic Plots:</li>
</ol>
<ul>
<li>Do the residual plots indicate any violations of ANCOVA assumptions such as non-linearity, heteroscedasticity, or non-normality?</li>
<li>Are there any influential observations that may affect the model’s validity?</li>
</ul>
<ol type="1">
<li>Interpretation of Pairwise Comparisons:</li>
</ol>
<ul>
<li>Which treatments significantly differ from each other after adjusting for (X)?</li>
<li>How do the adjusted means compare across treatments?</li>
</ul>
</section>
<section id="expected-answers" class="level2">
<h2 class="anchored" data-anchor-id="expected-answers">Expected Answers</h2>
<ol type="1">
<li>Main Effects:</li>
</ol>
<ul>
<li>Treatment: Treatments B and C have positive effects relative to Treatment A, indicating higher response values.</li>
<li>Covariate (X): The covariate (X) has a positive influence on (Y), suggesting that as (X) increases, (Y) tends to increase.</li>
</ul>
<ol type="1">
<li>Significance Testing:</li>
</ol>
<ul>
<li>Treatment Effects: If the p-values for Treatment are below the significance level (e.g., 0.05), treatments have significant effects.</li>
<li>Covariate (X): If the p-value for (X) is below the significance level, (X) is a significant predictor.</li>
</ul>
<ol type="1">
<li>Diagnostic Plots:</li>
</ol>
<ul>
<li>Residuals vs.&nbsp;Fitted: Random scatter suggests homoscedasticity and linearity.</li>
<li>Q-Q Plot: Points close to the diagonal indicate normality of residuals.</li>
<li>Influential Observations: Absence of points with high leverage or large residuals indicates no influential observations.</li>
</ul>
<ol type="1">
<li>Interpretation of Pairwise Comparisons:</li>
</ol>
<ul>
<li>Significant Differences: Significant pairwise differences indicate which specific treatments differ after adjusting for (X).</li>
<li>Adjusted Means: Provide a clearer comparison by accounting for the covariate’s effect, highlighting the true treatment effects.</li>
</ul>
<p>Reference:</p>
<p>Christensen, R. (2018). Analysis of Variance, Design, and Regression. Chapman and Hall/CRC.</p>
</section>
</section>
<section id="challenging-problems" class="level1">
<h1>Challenging Problems</h1>
<section id="unbalanced-two-factor-ancova-analysis" class="level2">
<h2 class="anchored" data-anchor-id="unbalanced-two-factor-ancova-analysis">1. Unbalanced Two-Factor ANCOVA Analysis</h2>
<p>Dataset: Utilize a dataset with unequal numbers of replicates across treatment combinations.</p>
<p>Tasks:</p>
<ul>
<li>Simulate an unbalanced dataset with two factors and one covariate.</li>
<li>Fit an ANCOVA model using both Type II and Type III sums of squares.</li>
<li>Compare the results and discuss how imbalance affects the interpretation of main and interaction effects.</li>
</ul>
</section>
<section id="r-code-example" class="level2">
<h2 class="anchored" data-anchor-id="r-code-example">R Code Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Unbalanced Data</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>FactorA <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>)))FactorB <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>), <span class="at">each =</span> <span class="dv">7</span>, <span class="at">times =</span> <span class="dv">2</span>))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Treatment and Covariate EffectsY &lt;- 5 + ifelse(FactorA == "A1", 0, ifelse(FactorA == "A2", 2, 4)) + ifelse(FactorB == "B1", 0, 3) + 0.5 * (X - mean(X)) + rnorm(15, mean=0, sd=3)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>data_unbalanced <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(FactorA, FactorB, X, Y)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>fit_unbalanced <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">+</span> X, <span class="at">data =</span> data_unbalanced)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Type II Sum of Squares</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>typeII <span class="ot">&lt;-</span> <span class="fu">Anova</span>(fit_unbalanced, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(typeII)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Type III Sum of Squares</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>typeIII <span class="ot">&lt;-</span> <span class="fu">Anova</span>(fit_unbalanced, <span class="at">type =</span> <span class="st">"III"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(typeIII)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="discussion-points" class="level2">
<h2 class="anchored" data-anchor-id="discussion-points">Discussion Points</h2>
<ol type="1">
<li>Type II vs.&nbsp;Type III SS:</li>
</ol>
<ul>
<li>Type II: Tests main effects after accounting for other main effects but ignores interactions.</li>
<li>Type III: Tests main effects after accounting for all other factors, including interactions.</li>
</ul>
<ol type="1">
<li>Impact of Imbalance:</li>
</ol>
<ul>
<li>Type II SS: Provides unbiased estimates of main effects under the assumption of no interaction.</li>
<li>Type III SS: Necessary when interactions are present or when the design is unbalanced, as it accounts for all factors simultaneously.</li>
</ul>
<ol type="1">
<li>Significance of Effects:</li>
</ol>
<ul>
<li>Type II SS: May show significant main effects if there’s true variability not explained by interactions.</li>
<li>Type III SS: May adjust significance levels based on interactions, leading to different conclusions.</li>
</ul>
<ol type="1">
<li>Implications for Experimental Conclusions:</li>
</ol>
<ul>
<li>Choosing SS Type: Critical for accurate inference; Type I SS is inappropriate due to dependency on factor order.</li>
<li>Misinterpretation Risks: Incorrect SS type can lead to misleading conclusions about factor significance and interactions.</li>
</ul>
</section>
<section id="expected-insights" class="level2">
<h2 class="anchored" data-anchor-id="expected-insights">Expected Insights</h2>
<ul>
<li>Type II SS: Suitable when interactions are not of primary interest, providing clear main effect interpretations.</li>
<li>Type III SS: Essential in unbalanced designs or when interactions are present, ensuring main effects are evaluated conditionally.</li>
<li>Imbalance Effects: Can distort Type I SS results, making Type II and III SS more robust alternatives in such scenarios.</li>
</ul>
<p>Reference:</p>
<p>Christensen, R. (2018). Analysis of Variance, Design, and Regression. Chapman and Hall/CRC.</p>
</section>
<section id="three-factor-interaction-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="three-factor-interaction-interpretation">2. Three-Factor Interaction Interpretation</h2>
<p>Dataset: Use a simulated dataset with three factors exhibiting a significant three-way interaction.</p>
<p>Tasks:</p>
<ul>
<li>Simulate data with three factors and one covariate.</li>
<li>Fit a three-way ANCOVA model.</li>
<li>Visualize the three-way interaction.</li>
<li>Use emmeans to estimate marginal means and perform pairwise comparisons.</li>
<li>Explain how the three-way interaction affects the interpretation of main and two-way interactions.</li>
</ul>
</section>
<section id="r-code-example-1" class="level2">
<h2 class="anchored" data-anchor-id="r-code-example-1">R Code Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)<span class="co"># Simulate Data</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>FactorA <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>), <span class="at">each =</span> <span class="dv">24</span>))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>FactorB <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>), <span class="at">each =</span> <span class="dv">12</span>, <span class="at">times =</span> <span class="dv">3</span>))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>FactorC <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span>), <span class="at">times =</span> <span class="dv">8</span>))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">72</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Three-way Interaction</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A1"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A2"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">ifelse</span>(FactorB <span class="sc">==</span> <span class="st">"B1"</span>, <span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ifelse</span>(FactorC <span class="sc">==</span> <span class="st">"C1"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(FactorC <span class="sc">==</span> <span class="st">"C2"</span>, <span class="fl">1.5</span>, <span class="dv">3</span>)) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span> <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A1"</span> <span class="sc">&amp;</span> FactorB <span class="sc">==</span> <span class="st">"B1"</span>, <span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A2"</span> <span class="sc">&amp;</span> FactorB <span class="sc">==</span> <span class="st">"B2"</span>, <span class="dv">1</span>, <span class="dv">2</span>)<span class="er">)</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">72</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)data_three <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(FactorA, FactorB, FactorC, X, Y)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Three-way ANCOVA Model</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>fit_three <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC <span class="sc">+</span> X, <span class="at">data =</span> data_three)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_three)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Three-way Interaction</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_three, <span class="fu">aes</span>(<span class="at">x=</span>FactorA, <span class="at">y=</span>Y, <span class="at">color=</span>FactorB, <span class="at">group=</span>FactorB)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> FactorC) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Three-Way Interaction Plot"</span>, <span class="at">x=</span><span class="st">"Factor A"</span>, <span class="at">y=</span><span class="st">"Response"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()<span class="co"># Estimated Marginal means</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>emm_three <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fit_three, <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>contrast_results <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_three, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretation-3" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-3">Interpretation</h2>
<ol type="1">
<li>Three-Way Interaction:</li>
</ol>
<ul>
<li>Visualization: Non-parallel lines across different levels of Factor C indicate a significant three-way interaction.</li>
<li>Statistical Significance: Significant three-way interaction in the model summary confirms that the combined effect of Factors A, B, and C deviates from additivity.</li>
</ul>
<ol type="1">
<li>Impact on Main and Two-Way Interactions:</li>
</ol>
<ul>
<li>Main Effects: Cannot be interpreted independently as their effects depend on the levels of other factors.</li>
<li>Two-Way Interactions: The presence of a significant three-way interaction implies that two-way interactions also vary across the third factor.</li>
</ul>
<ol type="1">
<li>Practical Implications:</li>
</ol>
<ul>
<li>Complex Relationships: Understanding how multiple factors interact provides deeper insights into the data.</li>
<li>Decision Making: Facilitates more informed decisions by recognizing nuanced effect patterns.</li>
</ul>
<p>Reference:</p>
<p>Dean, Voss &amp; Draguljić (2017). Design and Analysis of Experiments. Springer.</p>
</section>
<section id="mathematical-proof-of-interaction-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-proof-of-interaction-contrasts">3. Mathematical Proof of Interaction Contrasts</h2>
<p>Task: Derive formulas for interaction contrasts in a three-factor design and prove that they measure deviations from additivity.</p>
<p>Requirements:</p>
<ul>
<li>Show how to construct interaction contrasts.</li>
<li>Prove that if all interaction contrasts are zero, the model is additive.</li>
</ul>
<p>Hints:</p>
<ul>
<li>Utilize the definitions of main effects and interaction terms.</li>
<li>Employ properties of linear algebra to demonstrate the relationship between interaction contrasts and additivity.</li>
<li>Reference Dean et al.&nbsp;(2017) and Christensen (2018) for theoretical foundations.</li>
</ul>
</section>
<section id="proof-outline" class="level2">
<h2 class="anchored" data-anchor-id="proof-outline">Proof Outline</h2>
<ol type="1">
<li>Define the Three-Factor Model:</li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta){ij} + (\alpha\gamma){ik} + (\beta\gamma){jk} + (\alpha\beta\gamma){ijk} + \epsilon_{ijk}
\]</span></p>
<p>Where <span class="math inline">\(\sum \alpha_i = \sum \beta_j = \sum \gamma_k = 0\)</span>.</p>
<ol type="1">
<li>Construct Interaction Contrasts:</li>
</ol>
<ul>
<li>Two-Way Interactions:</li>
<li><span class="math inline">\((\alpha\beta)*{ij}\)</span>: Measures the interaction between Factors A and B.</li>
<li>Similarly for <span class="math inline">\((\alpha\gamma){ik}\)</span> and <span class="math inline">\((\beta\gamma){jk}\)</span>.</li>
<li>Three-Way Interaction:</li>
<li><span class="math inline">\((\alpha\beta\gamma)*{ijk}\)</span>: Measures the deviation from additivity among all three factors.</li>
</ul>
<ol type="1">
<li>Prove Deviations from Additivity:</li>
</ol>
<ul>
<li>Additive Model:</li>
</ul>
<p>If all interaction terms are zero (<span class="math inline">\((\alpha\beta){ij} = (\alpha\gamma){ik} = (\beta\gamma){jk} = (\alpha\beta\gamma){ijk} = 0\)</span>), the model simplifies to:</p>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + \epsilon_{ijk}
\]</span></p>
<p>This represents a purely additive model where the combined effect of factors is the sum of their individual effects.</p>
<ul>
<li>Non-Additive Model:</li>
</ul>
<p>If any of the interaction terms are non-zero, the model deviates from additivity, indicating that the effect of one factor depends on the levels of other factors.</p>
<ol type="1">
<li>Conclusion:</li>
</ol>
<p>Interaction contrasts (<span class="math inline">\((\alpha\beta){ij}\)</span>, <span class="math inline">\((\alpha\gamma){ik}\)</span>, <span class="math inline">\((\beta\gamma){jk}\)</span>, and <span class="math inline">\((\alpha\beta\gamma){ijk}\)</span>) measure the extent to which the observed responses deviate from an additive model. Non-zero contrasts signify the presence of interactions, emphasizing the importance of considering these higher-order effects in experimental analysis.</p>
<p>Reference:</p>
<p>Dean, Voss &amp; Draguljić (2017). Design and Analysis of Experiments. Springer.</p>
</section>
</section>
<section id="appendix-advanced-mathematical-derivations" class="level1">
<h1>Appendix: Advanced Mathematical Derivations</h1>
<section id="adjusted-treatment-means" class="level2">
<h2 class="anchored" data-anchor-id="adjusted-treatment-means">Adjusted Treatment Means</h2>
<p>The Adjusted Mean for treatment (i) accounts for the influence of blocking factors, providing a more accurate estimate of the treatment effect.</p>
<p><span class="math display">\[
\mu + \tau_i = \bar{Y}_i - \beta (\bar{X}_i - \bar{X})
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\tau_i\)</span>: Treatment effect for treatment (i).</li>
<li><span class="math inline">\(\bar{Y}_i\)</span>: Mean response for treatment (i).</li>
<li><span class="math inline">\(\beta\)</span>: Regression coefficient for the covariate.</li>
<li><span class="math inline">\(\bar{X}_i\)</span>: Mean covariate value for treatment (i).</li>
<li><span class="math inline">\(\bar{X}\)</span>: Overall mean of the covariate.</li>
</ul>
</section>
<section id="derivation" class="level2">
<h2 class="anchored" data-anchor-id="derivation">Derivation</h2>
<ol type="1">
<li>Model Equation:</li>
</ol>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta (X_{ij} - \bar{X}) + \epsilon_{ij}
\]</span></p>
<ol type="1">
<li>Taking the Mean for Treatment (i):</li>
</ol>
<p><span class="math display">\[
\bar{Y}_i = \mu + \tau_i + \beta (\bar{X}_i - \bar{X}) + \bar{\epsilon}_i
\]</span></p>
<p>Since <span class="math inline">\(\bar{\epsilon}_i = 0\)</span> (assuming errors have mean zero),</p>
<p><span class="math display">\[
\bar{Y}_i = \mu + \tau_i + \beta (\bar{X}_i - \bar{X})
\]</span></p>
<ol type="1">
<li>Solving for Adjusted Mean:</li>
</ol>
<p><span class="math display">\[
\mu + \tau_i = \bar{Y}_i - \beta (\bar{X}_i - \bar{X})
\]</span></p>
<p>This equation represents the adjusted treatment mean, accounting for differences in the covariate.</p>
<p>Reference:</p>
<p>Montgomery, D. C., &amp; Runger, G. C. (2010). Applied Statistics and Probability for Engineers. Wiley.</p>
</section>
<section id="f-test-for-homogeneity-of-slopes" class="level2">
<h2 class="anchored" data-anchor-id="f-test-for-homogeneity-of-slopes">F-Test for Homogeneity of Slopes</h2>
<p>Testing the assumption of homogeneity of regression slopes ensures that the relationship between the covariate and the response is consistent across all treatment groups.</p>
<p>Model Comparison</p>
<ol type="1">
<li>Model Without Interaction (Assuming Homogeneous Slopes):</li>
</ol>
<p><span class="math display">\[
Y_{hi} = \mu + \theta_h + \tau_i + \beta X_{hi} + \epsilon_{hi}
\]</span></p>
<ol type="1">
<li>Model With Interaction (Allowing Slopes to Vary):</li>
</ol>
<p><span class="math display">\[
Y_{hi} = \mu + \theta_h + \tau_i + \beta X_{hi} + (\theta \tau){hi} + \epsilon{hi}
\]</span></p>
<p>Where <span class="math inline">\((\theta \tau)_{hi}\)</span> allows the slope of the covariate to vary with treatments.</p>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h2>
<ul>
<li>Null Hypothesis ((H_0)): Homogeneity of slopes (<span class="math inline">\(\beta\)</span> is the same across treatments).</li>
<li>Alternative Hypothesis ((H_A)): Slopes vary across treatments (<span class="math inline">\(\beta_i \neq \beta_j\)</span> for some (i, j)).</li>
</ul>
<p>Test Procedure</p>
<ol type="1">
<li>Fit Both Models:</li>
</ol>
<ul>
<li>Reduced Model: Without interaction.</li>
<li>Full Model: With interaction.</li>
</ul>
<ol type="1">
<li>Compare Models Using ANOVA:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Reduced Model</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>model_reduced <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">+</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Full Model with Interaction</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">*</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare Models</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_reduced, model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Decision Rule:</li>
</ol>
<ul>
<li>If the interaction term is significant (<span class="math inline">\(p &lt; \alpha\)</span>), reject (H_0) and conclude that slopes are not homogeneous.</li>
<li>If not significant, accept (H_0) and proceed with the reduced model.</li>
</ul>
<p>Conclusion:</p>
<p>A significant interaction term indicates that the effect of the covariate varies across treatments, violating the homogeneity of slopes assumption and necessitating a more complex model.</p>
<p>Reference:</p>
<p>Scheffé, H. (1959). The Analysis of Variance. Wiley.</p>
</section>
<section id="confidence-intervals-for-higher-order-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals-for-higher-order-contrasts">Confidence Intervals for Higher-Order Contrasts</h2>
<p>For higher-order interactions involving multiple factors, confidence intervals for contrasts provide insights into the magnitude and significance of these interactions.</p>
<p>Formula:</p>
<p><span class="math display">\[
CI = \hat{L} \pm t_{\alpha/2, df} \sqrt{\text{Var}(\hat{L})}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\hat{L}\)</span>: Estimated contrast.</li>
<li><span class="math inline">\(t_{\alpha/2, df}\)</span>: Critical value from the t-distribution.</li>
<li><span class="math inline">\(\text{Var}(\hat{L})\)</span>: Variance of the contrast estimate.</li>
</ul>
</section>
<section id="steps-in-r" class="level2">
<h2 class="anchored" data-anchor-id="steps-in-r">Steps in R</h2>
<ol type="1">
<li>Estimate the Contrast:</li>
</ol>
<p>Using the emmeans package to define and estimate contrasts.</p>
<ol type="1">
<li>Calculate the Confidence Interval:</li>
</ol>
<p>The emmeans package automatically provides confidence intervals when performing contrasts.</p>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the ANCOVA Model</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">+</span> X, <span class="at">data =</span> data_sim)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Estimated Marginal means</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> Treatment)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a Contrast (e.g., Treatment B vs. Treatment A)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>contrast_AB <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_AB, <span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Interpretation:</p>
<p>The output provides the estimated difference, standard error, t-value, and confidence interval for the contrast. If the confidence interval does not include zero, the contrast is statistically significant.</p>
<p>Reference:</p>
<p>Christensen, R. (2018). Analysis of Variance, Design, and Regression. Chapman and Hall/CRC.</p>
</section>
</section>
<section id="exercises-1" class="level1">
<h1>Exercises</h1>
<section id="medium-difficulty-1" class="level2">
<h2 class="anchored" data-anchor-id="medium-difficulty-1">Medium Difficulty</h2>
<ol type="1">
<li>Two-Way ANCOVA with Interaction</li>
</ol>
<p>Dataset: Simulate a dataset with three treatments and one covariate.</p>
<p>Tasks:</p>
<ul>
<li>Generate data for treatments A, B, C with a covariate (X).</li>
<li>Fit an ANCOVA model adjusting for (X).</li>
<li>Test the significance of treatment effects and the covariate.</li>
<li>Generate diagnostic plots and interpret them.</li>
</ul>
</section>
<section id="r-code-example-2" class="level2">
<h2 class="anchored" data-anchor-id="r-code-example-2">R Code Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Factors and Covariate</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each=</span><span class="dv">30</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="dv">50</span>, <span class="at">sd=</span><span class="dv">10</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Treatment Effects and Covariate Effect</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">"A"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">"B"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Treatment, X, Y)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>model_sim <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">+</span> X, <span class="at">data =</span> data_sim)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_sim)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic Plots</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_sim)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>emm_sim <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_sim, <span class="sc">~</span> Treatment)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>pairwise_sim <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_sim, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="questions-1" class="level2">
<h2 class="anchored" data-anchor-id="questions-1">Questions</h2>
<ol type="1">
<li>Main Effects:</li>
</ol>
<ul>
<li>Treatment: What are the estimated effects of treatments A, B, and C?</li>
<li>Covariate (X): How does (X) influence the response variable (Y)?</li>
</ul>
<ol type="1">
<li>Significance Testing:</li>
</ol>
<ul>
<li>Are the treatment effects statistically significant after adjusting for (X)?</li>
<li>Is the covariate (X) a significant predictor of (Y)?</li>
</ul>
<ol type="1">
<li>Diagnostic Plots:</li>
</ol>
<ul>
<li>Do the residual plots indicate any violations of ANCOVA assumptions such as non-linearity, heteroscedasticity, or non-normality?</li>
<li>Are there any influential observations that may affect the model’s validity?</li>
</ul>
<ol type="1">
<li>Interpretation of Pairwise Comparisons:</li>
</ol>
<ul>
<li>Which treatments significantly differ from each other after adjusting for (X)?</li>
<li>How do the adjusted means compare across treatments?</li>
</ul>
</section>
<section id="expected-answers-1" class="level2">
<h2 class="anchored" data-anchor-id="expected-answers-1">Expected Answers</h2>
<ol type="1">
<li>Main Effects:</li>
</ol>
<ul>
<li>Treatment: Treatments B and C have positive effects relative to Treatment A, indicating higher response values.</li>
<li>Covariate (X): The covariate (X) has a positive influence on (Y), suggesting that as (X) increases, (Y) tends to increase.</li>
</ul>
<ol type="1">
<li>Significance Testing:</li>
</ol>
<ul>
<li>Treatment Effects: If the p-values for Treatment are below the significance level (e.g., 0.05), treatments have significant effects.</li>
<li>Covariate (X): If the p-value for (X) is below the significance level, (X) is a significant predictor.</li>
</ul>
<ol type="1">
<li>Diagnostic Plots:</li>
</ol>
<ul>
<li>Residuals vs.&nbsp;Fitted: Random scatter suggests homoscedasticity and linearity.</li>
<li>Q-Q Plot: Points close to the diagonal indicate normality of residuals.</li>
<li>Influential Observations: Absence of points with high leverage or large residuals indicates no influential observations.</li>
</ul>
<ol type="1">
<li>Interpretation of Pairwise Comparisons:</li>
</ol>
<ul>
<li>Significant Differences: Significant pairwise differences indicate which specific treatments differ after adjusting for (X).</li>
<li>Adjusted Means: Provide a clearer comparison by accounting for the covariate’s effect, highlighting the true treatment effects.</li>
</ul>
<p>Reference:</p>
<p>Christensen, R. (2018). Analysis of Variance, Design, and Regression. Chapman and Hall/CRC.</p>
</section>
</section>
<section id="challenging-problems-1" class="level1">
<h1>Challenging Problems</h1>
<section id="unbalanced-two-factor-ancova-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="unbalanced-two-factor-ancova-analysis-1">1. Unbalanced Two-Factor ANCOVA Analysis</h2>
<p>Dataset: Utilize a dataset with unequal numbers of replicates across treatment combinations.</p>
<p>Tasks:</p>
<ul>
<li>Simulate an unbalanced dataset with two factors and one covariate.</li>
<li>Fit an ANCOVA model using both Type II and Type III sums of squares.</li>
<li>Compare the results and discuss how imbalance affects the interpretation of main and interaction effects.</li>
</ul>
</section>
<section id="r-code-example-3" class="level2">
<h2 class="anchored" data-anchor-id="r-code-example-3">R Code Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Unbalanced Data</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>FactorA <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>)))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>FactorB <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>), <span class="at">each =</span> <span class="dv">7</span>, <span class="at">times =</span> <span class="dv">2</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Treatment and Covariate Effects</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A1"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A2"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorB <span class="sc">==</span> <span class="st">"B1"</span>, <span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>data_unbalanced <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(FactorA, FactorB, X, Y)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>fit_unbalanced <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">+</span> X, <span class="at">data =</span> data_unbalanced)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Type II Sum of Squares</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>typeII <span class="ot">&lt;-</span> <span class="fu">Anova</span>(fit_unbalanced, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(typeII)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Type III Sum of Squares</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>typeIII <span class="ot">&lt;-</span> <span class="fu">Anova</span>(fit_unbalanced, <span class="at">type =</span> <span class="st">"III"</span>)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(typeIII)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="discussion-points-1" class="level2">
<h2 class="anchored" data-anchor-id="discussion-points-1">Discussion Points</h2>
<ol type="1">
<li>Type II vs.&nbsp;Type III SS:</li>
</ol>
<ul>
<li>Type II: Tests main effects after accounting for other main effects but ignores interactions.</li>
<li>Type III: Tests main effects after accounting for all other factors, including interactions.</li>
</ul>
<ol type="1">
<li>Impact of Imbalance:</li>
</ol>
<ul>
<li>Type II SS: Provides unbiased estimates of main effects under the assumption of no interaction.</li>
<li>Type III SS: Necessary when interactions are present or when the design is unbalanced, as it accounts for all factors simultaneously.</li>
</ul>
<ol type="1">
<li>Significance of Effects:</li>
</ol>
<ul>
<li>Type II SS: May show significant main effects if there’s true variability not explained by interactions.</li>
<li>Type III SS: May adjust significance levels based on interactions, leading to different conclusions.</li>
</ul>
<ol type="1">
<li>Implications for Experimental Conclusions:</li>
</ol>
<ul>
<li>Choosing SS Type: Critical for accurate inference; Type I SS is inappropriate due to dependency on factor order.</li>
<li>Misinterpretation Risks: Incorrect SS type can lead to misleading conclusions about factor significance and interactions.</li>
</ul>
</section>
<section id="expected-insights-1" class="level2">
<h2 class="anchored" data-anchor-id="expected-insights-1">Expected Insights</h2>
<ul>
<li>Type II SS: Suitable when interactions are not of primary interest, providing clear main effect interpretations.</li>
<li>Type III SS: Essential in unbalanced designs or when interactions are present, ensuring main effects are evaluated conditionally.</li>
<li>Imbalance Effects: Can distort Type I SS results, making Type II and III SS more robust alternatives in such scenarios.</li>
</ul>
<p>Reference:</p>
<p>Christensen, R. (2018). Analysis of Variance, Design, and Regression. Chapman and Hall/CRC.</p>
</section>
<section id="three-factor-interaction-interpretation-1" class="level2">
<h2 class="anchored" data-anchor-id="three-factor-interaction-interpretation-1">2. Three-Factor Interaction Interpretation</h2>
<p>Dataset: Use a simulated dataset with three factors exhibiting a significant three-way interaction.</p>
<p>Tasks:</p>
<ul>
<li>Simulate data with three factors and one covariate.</li>
<li>Fit a three-way ANCOVA model.</li>
<li>Visualize the three-way interaction.</li>
<li>Use emmeans to estimate marginal means and perform pairwise comparisons.</li>
<li>Explain how the three-way interaction affects the interpretation of main and two-way interactions.</li>
</ul>
</section>
<section id="r-code-example-4" class="level2">
<h2 class="anchored" data-anchor-id="r-code-example-4">R Code Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Data</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>FactorA <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>), <span class="at">each =</span> <span class="dv">24</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>FactorB <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>), <span class="at">each =</span> <span class="dv">12</span>, <span class="at">times =</span> <span class="dv">3</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>FactorC <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span>), <span class="at">times =</span> <span class="dv">8</span>))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">72</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Three-way Interaction</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A1"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A2"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorB <span class="sc">==</span> <span class="st">"B1"</span>, <span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorC <span class="sc">==</span> <span class="st">"C1"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(FactorC <span class="sc">==</span> <span class="st">"C2"</span>, <span class="fl">1.5</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A1"</span> <span class="sc">&amp;</span> FactorB <span class="sc">==</span> <span class="st">"B1"</span>, <span class="dv">0</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A2"</span> <span class="sc">&amp;</span> FactorB <span class="sc">==</span> <span class="st">"B2"</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">72</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>data_three <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(FactorA, FactorB, FactorC, X, Y)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Three-way ANCOVA Model</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>fit_three <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC <span class="sc">+</span> X, <span class="at">data =</span> data_three)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_three)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Three-way Interaction</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_three, <span class="fu">aes</span>(<span class="at">x=</span>FactorA, <span class="at">y=</span>Y, <span class="at">color=</span>FactorB, <span class="at">group=</span>FactorB)) <span class="sc">+</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="sc">~</span> FactorC) <span class="sc">+</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Three-Way Interaction Plot"</span>, <span class="at">x=</span><span class="st">"Factor A"</span>, <span class="at">y=</span><span class="st">"Response"</span>) <span class="sc">+</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>emm_three <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fit_three, <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC)</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>contrast_results <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_three, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretation-4" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-4">Interpretation</h2>
<ol type="1">
<li>Three-Way Interaction:</li>
</ol>
<ul>
<li>Visualization: The interaction plot shows non-parallel lines across different levels of Factor C, indicating a significant three-way interaction.</li>
<li>Statistical Significance: The model summary reveals a significant three-way interaction, confirming that the combined effect of Factors A, B, and C is not purely additive.</li>
</ul>
<ol type="1">
<li>Impact on Main and Two-Way Interactions:</li>
</ol>
<ul>
<li>Main Effects: Cannot be interpreted independently as their effects depend on the levels of other factors.</li>
<li>Two-Way Interactions: The presence of a significant three-way interaction implies that two-way interactions also vary across the third factor.</li>
</ul>
<ol type="1">
<li>Practical Implications:</li>
</ol>
<ul>
<li>Complex Relationships: Understanding how multiple factors interact provides deeper insights into the data.</li>
<li>Decision Making: Facilitates more informed decisions by recognizing nuanced effect patterns.</li>
</ul>
<p>Reference:</p>
<p>Dean, Voss &amp; Draguljić (2017). Design and Analysis of Experiments. Springer.</p>
</section>
<section id="mathematical-proof-of-interaction-contrasts-1" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-proof-of-interaction-contrasts-1">3. Mathematical Proof of Interaction Contrasts</h2>
<p>Task: Derive formulas for interaction contrasts in a three-factor design and prove that they measure deviations from additivity.</p>
<p>Requirements:</p>
<ul>
<li>Show how to construct interaction contrasts.</li>
<li>Prove that if all interaction contrasts are zero, the model is additive.</li>
</ul>
<p>Hints:</p>
<ul>
<li>Utilize the definitions of main effects and interaction terms.</li>
<li>Employ properties of linear algebra to demonstrate the relationship between interaction contrasts and additivity.</li>
<li>Reference Dean et al.&nbsp;(2017) and Christensen (2018) for theoretical foundations.</li>
</ul>
</section>
<section id="proof-outline-1" class="level2">
<h2 class="anchored" data-anchor-id="proof-outline-1">Proof Outline</h2>
<ol type="1">
<li>Define the Three-Factor Model:</li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta){ij} + (\alpha\gamma){ik} + (\beta\gamma){jk} + (\alpha\beta\gamma){ijk} + \epsilon_{ijk}
\]</span></p>
<p>Where <span class="math inline">\(\sum \alpha_i = \sum \beta_j = \sum \gamma_k = 0\)</span>.</p>
<ol type="1">
<li>Construct Interaction Contrasts:</li>
</ol>
<ul>
<li>Two-Way Interactions:</li>
<li><span class="math inline">\((\alpha\beta)*{ij}\)</span>: Measures the interaction between Factors A and B.</li>
<li>Similarly for <span class="math inline">\((\alpha\gamma){ik}\)</span> and <span class="math inline">\((\beta\gamma){jk}\)</span>.</li>
<li>Three-Way Interaction:</li>
<li><span class="math inline">\((\alpha\beta\gamma)*{ijk}\)</span>: Measures the deviation from additivity among all three factors.</li>
</ul>
<ol type="1">
<li>Prove Deviations from Additivity:</li>
</ol>
<ul>
<li>Additive Model:</li>
</ul>
<p>If all interaction terms are zero (<span class="math inline">\((\alpha\beta){ij} = (\alpha\gamma){ik} = (\beta\gamma){jk} = (\alpha\beta\gamma){ijk} = 0\)</span>), the model simplifies to:</p>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + \epsilon_{ijk}
\]</span></p>
<p>This represents a purely additive model where the combined effect of factors is the sum of their individual effects.</p>
<ul>
<li>Non-Additive Model:</li>
</ul>
<p>If any of the interaction terms are non-zero, the model deviates from additivity, indicating that the effect of one factor depends on the levels of other factors.</p>
<ol type="1">
<li>Conclusion:</li>
</ol>
<p>Interaction contrasts (<span class="math inline">\((\alpha\beta){ij}\)</span>, <span class="math inline">\((\alpha\gamma){ik}\)</span>, <span class="math inline">\((\beta\gamma){jk}\)</span>, and <span class="math inline">\((\alpha\beta\gamma){ijk}\)</span>) measure the extent to which the observed responses deviate from an additive model. Non-zero contrasts signify the presence of interactions, emphasizing the importance of considering these higher-order effects in experimental analysis.</p>
<p>Reference:</p>
<p>Dean, Voss &amp; Draguljić (2017). Design and Analysis of Experiments. Springer.</p>
</section>
</section>
<section id="appendix-advanced-mathematical-derivations-1" class="level1">
<h1>Appendix: Advanced Mathematical Derivations</h1>
<section id="expected-mean-squares-for-nested-models" class="level2">
<h2 class="anchored" data-anchor-id="expected-mean-squares-for-nested-models">Expected Mean Squares for Nested Models</h2>
<p>For the model <span class="math inline">\(Y_{ijt} = \mu + \alpha_i + \beta_j(i) + \epsilon_{ijt}\)</span>, the Expected Mean Squares (EMS) are:</p>
<p><span class="math display">\[
EMS_A = \sigma^2 + r \sigma^2_B + r b Q(\alpha_i)
\]</span></p>
<p><span class="math display">\[
EMS_B(A) = \sigma^2 + r \sigma^2_B
\]</span></p>
<p><span class="math display">\[
EMS_E = \sigma^2
\]</span></p>
</section>
<section id="derivation-steps-1" class="level2">
<h2 class="anchored" data-anchor-id="derivation-steps-1">Derivation Steps</h2>
<ol type="1">
<li>Assumptions:</li>
</ol>
<ul>
<li>Fixed Effects: <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\beta_j(i)\)</span> are fixed.</li>
<li>Random Error: <span class="math inline">\(\epsilon_{ijt} \sim N(0, \sigma^2)\)</span>.</li>
<li>Replicates: <span class="math inline">\(r\)</span> replicates per nested factor.</li>
</ul>
<ol type="1">
<li>Variance Components:</li>
</ol>
<ul>
<li>Between (A) Groups: Variance due to Factor (A) is captured by <span class="math inline">\(\alpha_i\)</span>.</li>
<li>Between (B(A)) Groups: Variance due to Factor (B) nested within (A) is <span class="math inline">\(\sigma^2_B\)</span>.</li>
<li>Within (B(A)) Groups: Residual variance is <span class="math inline">\(\sigma^2\)</span>.</li>
</ul>
<ol type="1">
<li>Calculation of EMS:</li>
</ol>
<ul>
<li>EMS for Factor (A):</li>
</ul>
<p><span class="math display">\[
EMS_A = Var(\alpha_i) + Var(\beta_j(i)) + Var(\epsilon_{ijt}) = \sigma^2 + r \sigma^2_B + r b Q(\alpha_i)
\]</span></p>
<ul>
<li>EMS for Factor (B(A)):</li>
</ul>
<p><span class="math display">\[
EMS_B(A) = Var(\beta_j(i)) + Var(\epsilon_{ijt}) = \sigma^2 + r \sigma^2_B
\]</span></p>
<ul>
<li>EMS for Error:</li>
</ul>
<p><span class="math display">\[
EMS_E = Var(\epsilon_{ijt}) = \sigma^2
\]</span></p>
<ol type="1">
<li>Estimation of Variance Components:</li>
</ol>
<p>Using the ANOVA table, mean squares are equated to EMS to solve for <span class="math inline">\(\sigma^2_B\)</span> and <span class="math inline">\(\sigma^2\)</span>:</p>
<p><span class="math display">\[
\hat{\sigma}^2_B = \frac{MS_A - MS_E}{r}
\]</span></p>
<p><span class="math display">\[
\hat{\sigma}^2 = MS_E
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(MS_A\)</span>: Mean Square for Factor (A).</li>
<li><span class="math inline">\(MS_E\)</span>: Mean Square for Error.</li>
</ul>
<p>Conclusion:</p>
<p>The derivation demonstrates how ANOVA decomposes total variability into components attributable to nested factors and residual error, enabling the estimation of variance components.</p>
<p>Reference:</p>
<p>Montgomery, D. C., &amp; Runger, G. C. (2010). Applied Statistics and Probability for Engineers. Wiley.</p>
</section>
</section>
<section id="mathematical-proof-of-interaction-contrasts-2" class="level1">
<h1>Mathematical Proof of Interaction Contrasts</h1>
<section id="interaction-contrasts-measure-deviations-from-additivity" class="level2">
<h2 class="anchored" data-anchor-id="interaction-contrasts-measure-deviations-from-additivity">Interaction Contrasts Measure Deviations from Additivity</h2>
<p>Definition:</p>
<p>In a three-factor design, interaction contrasts quantify how the combined effect of three factors deviates from the additive effects of each factor individually and their two-way interactions.</p>
</section>
<section id="proof-steps" class="level2">
<h2 class="anchored" data-anchor-id="proof-steps">Proof Steps</h2>
<ol type="1">
<li>Define the Three-Factor Model:</li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta){ij} + (\alpha\gamma){ik} + (\beta\gamma){jk} + (\alpha\beta\gamma){ijk} + \epsilon_{ijk}
\]</span></p>
<p>Where <span class="math inline">\(\sum \alpha_i = \sum \beta_j = \sum \gamma_k = 0\)</span>.</p>
<ol type="1">
<li>Construct Interaction Contrasts:</li>
</ol>
<ul>
<li>Two-Way Interactions:</li>
<li><span class="math inline">\((\alpha\beta)*{ij}\)</span>: Measures the interaction between Factors A and B.</li>
<li>Similarly for <span class="math inline">\((\alpha\gamma){ik}\)</span> and <span class="math inline">\((\beta\gamma){jk}\)</span>.</li>
<li>Three-Way Interaction:</li>
<li><span class="math inline">\((\alpha\beta\gamma)*{ijk}\)</span>: Measures the deviation from additivity among all three factors.</li>
</ul>
<ol type="1">
<li>Prove Deviations from Additivity:</li>
</ol>
<ul>
<li>Additive Model:</li>
</ul>
<p>If all interaction terms are zero (<span class="math inline">\((\alpha\beta){ij} = (\alpha\gamma){ik} = (\beta\gamma){jk} = (\alpha\beta\gamma){ijk} = 0\)</span>), the model simplifies to:</p>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + \epsilon_{ijk}
\]</span></p>
<p>This represents a purely additive model where the combined effect of factors is the sum of their individual effects.</p>
<ul>
<li>Non-Additive Model:</li>
</ul>
<p>If any of the interaction terms are non-zero, the model deviates from additivity, indicating that the effect of one factor depends on the levels of other factors.</p>
<ol type="1">
<li>Conclusion:</li>
</ol>
<p>Interaction contrasts (<span class="math inline">\((\alpha\beta){ij}\)</span>, <span class="math inline">\((\alpha\gamma){ik}\)</span>, <span class="math inline">\((\beta\gamma){jk}\)</span>, and <span class="math inline">\((\alpha\beta\gamma){ijk}\)</span>) measure the extent to which the observed responses deviate from an additive model. Non-zero contrasts signify the presence of interactions, emphasizing the importance of considering these higher-order effects in experimental analysis.</p>
<p>Reference:</p>
<p>Dean, Voss &amp; Draguljić (2017). Design and Analysis of Experiments. Springer.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>Dean, A., Voss, D., &amp; Draguljić, D. (2017). Design and Analysis of Experiments. Springer.</li>
<li>Montgomery, D. C., &amp; Runger, G. C. (2010). Applied Statistics and Probability for Engineers. Wiley.</li>
<li>Christensen, R. (2018). Analysis of Variance, Design, and Regression. Chapman and Hall/CRC.</li>
<li>Kempthorne, O. (1977). Design and Analysis of Experiments. Robert E. Krieger Publishing Company.</li>
<li>Scheffé, H. (1959). The Analysis of Variance. Wiley.</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<!-- filepath: /Users/dt/Library/CloudStorage/Dropbox/Teaching/DOE/assets/includes/footer.html -->
<footer class="site-footer">
    <div class="container text-center">
        <hr> 
        © <span id="current-year"></span> Dr. Davood Tofighi |
        <a href="https://canvasinfo.unm.edu/">UNM Canvas</a> |
        <a href="https://data-wise.github.io/doe">Course GitHub Page</a> |
    </div>
    <script>
        document.getElementById("current-year").textContent = new Date().getFullYear();
    </script>
</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Data-Wise\.github\.io\/doe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>