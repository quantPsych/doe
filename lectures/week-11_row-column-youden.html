<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Davood Tofighi, Ph.D.">

<title>Row and Column Designs – STAT 454/545 - Analysis of Variance and Experimental Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4f17641596142cbde708c01b3a465e62.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-68b729f92b170261f1b1556cc4834a67.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Montserrat:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Row and Column Designs – STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:description" content="Designs with Two Blocking Factors">
<meta property="og:image" content="https://Data-Wise.github.io/doe/lectures/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="STAT 454/545 - Analysis of Variance and Experimental Design">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 545</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/syllabus-final.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_lectures.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_help.html"> 
<span class="menu-text">R Help</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_appendix.html"> 
<span class="menu-text">Appendix</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contents.html"> 
<span class="menu-text">Contents</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Row and Column Designs</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Row and Column Designs</h1>
            <p class="subtitle lead">Designs with Two Blocking Factors</p>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://Data-Wise.github.io/doe">Davood Tofighi, Ph.D.</a> <a href="mailto:dtofighi@unm.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-8523-7776" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Mathematics and Statistics, University of New Mexico
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">09-Apr-2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus-final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R Code and Datasets</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r_help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Help</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r-code-data-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Code and Datasets from the Book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data-files-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets from the Book</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  </ul></li>
  <li><a href="#fundamentals-of-rowcolumn-designs" id="toc-fundamentals-of-rowcolumn-designs" class="nav-link" data-scroll-target="#fundamentals-of-rowcolumn-designs">Fundamentals of Row–Column Designs</a>
  <ul class="collapse">
  <li><a href="#rowcolumn-design-structure" id="toc-rowcolumn-design-structure" class="nav-link" data-scroll-target="#rowcolumn-design-structure">Row–Column Design Structure</a></li>
  <li><a href="#blocking-factors" id="toc-blocking-factors" class="nav-link" data-scroll-target="#blocking-factors">Blocking Factors</a></li>
  <li><a href="#advantages" id="toc-advantages" class="nav-link" data-scroll-target="#advantages">Advantages</a></li>
  </ul></li>
  <li><a href="#latin-square-designs" id="toc-latin-square-designs" class="nav-link" data-scroll-target="#latin-square-designs">Latin Square Designs</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition">Definition</a></li>
  <li><a href="#construction" id="toc-construction" class="nav-link" data-scroll-target="#construction">Construction</a></li>
  </ul></li>
  <li><a href="#analysis-of-variance-for-rowcolumn-designs" id="toc-analysis-of-variance-for-rowcolumn-designs" class="nav-link" data-scroll-target="#analysis-of-variance-for-rowcolumn-designs">Analysis of Variance for Row–Column Designs</a>
  <ul class="collapse">
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a>
  <ul class="collapse">
  <li><a href="#key-assumptions" id="toc-key-assumptions" class="nav-link" data-scroll-target="#key-assumptions">Key Assumptions</a></li>
  <li><a href="#anova-table" id="toc-anova-table" class="nav-link" data-scroll-target="#anova-table">ANOVA Table</a></li>
  </ul></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a></li>
  <li><a href="#example-interpretation" id="toc-example-interpretation" class="nav-link" data-scroll-target="#example-interpretation">Example Interpretation</a></li>
  <li><a href="#computational-formula" id="toc-computational-formula" class="nav-link" data-scroll-target="#computational-formula">Computational Formula</a></li>
  <li><a href="#derivation-of-row-effect-sum-of-squares" id="toc-derivation-of-row-effect-sum-of-squares" class="nav-link" data-scroll-target="#derivation-of-row-effect-sum-of-squares">Derivation of Row Effect Sum of Squares</a></li>
  <li><a href="#unadjusted-column-effect-sum-of-squares-ss_phi" id="toc-unadjusted-column-effect-sum-of-squares-ss_phi" class="nav-link" data-scroll-target="#unadjusted-column-effect-sum-of-squares-ss_phi">Unadjusted Column Effect Sum of Squares (<span class="math inline">\(ss_\phi\)</span>)</a>
  <ul class="collapse">
  <li><a href="#treatment-effect-adjusted-for-rows-and-columns" id="toc-treatment-effect-adjusted-for-rows-and-columns" class="nav-link" data-scroll-target="#treatment-effect-adjusted-for-rows-and-columns">Treatment Effect (Adjusted for Rows and Columns)</a></li>
  </ul></li>
  <li><a href="#explanation-of-standard-formula" id="toc-explanation-of-standard-formula" class="nav-link" data-scroll-target="#explanation-of-standard-formula">Explanation of Standard Formula:</a></li>
  <li><a href="#adjusted-treatment-sum-of-squares-ss_texttrt-adj" id="toc-adjusted-treatment-sum-of-squares-ss_texttrt-adj" class="nav-link" data-scroll-target="#adjusted-treatment-sum-of-squares-ss_texttrt-adj">Adjusted Treatment Sum of Squares (<span class="math inline">\(SS_\text{Trt adj}\)</span>)</a></li>
  <li><a href="#explanation-of-standard-formula-1" id="toc-explanation-of-standard-formula-1" class="nav-link" data-scroll-target="#explanation-of-standard-formula-1">Explanation of Standard Formula:</a></li>
  </ul></li>
  <li><a href="#latin-square-designs-1" id="toc-latin-square-designs-1" class="nav-link" data-scroll-target="#latin-square-designs-1">Latin Square Designs</a>
  <ul class="collapse">
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova">Analysis of Variance (ANOVA)</a></li>
  <li><a href="#why-they-are-the-same" id="toc-why-they-are-the-same" class="nav-link" data-scroll-target="#why-they-are-the-same">Why They Are the Same</a></li>
  <li><a href="#when-they-might-differ" id="toc-when-they-might-differ" class="nav-link" data-scroll-target="#when-they-might-differ">When They Might Differ</a></li>
  <li><a href="#example-anova-table-for-latin-square" id="toc-example-anova-table-for-latin-square" class="nav-link" data-scroll-target="#example-anova-table-for-latin-square">Example ANOVA Table for Latin Square</a></li>
  <li><a href="#example-in-r" id="toc-example-in-r" class="nav-link" data-scroll-target="#example-in-r">Example in R</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In the realm of experimental design, <strong>Row–Column Designs</strong> serve as an extension of traditional blocking techniques by incorporating two independent blocking factors: <strong>rows</strong> and <strong>columns</strong>. These designs are instrumental in controlling multiple sources of variability, thereby enhancing the precision and efficiency of treatment comparisons. By organizing experimental units into a matrix of rows and columns, Row–Column Designs mitigate the influence of two distinct nuisance factors, enabling clearer insights into the effects of the primary treatments under investigation.</p>
<p><strong>Intuitive Example:</strong> Imagine conducting an agricultural experiment to test different crop varieties. The field is naturally divided into rows and columns due to varying sunlight and soil moisture gradients. By applying each variety once per row and column, you control for these environmental gradients, ensuring that differences in crop performance are attributable to the varieties themselves rather than external factors.</p>
<p>This lecture delves into the structure, analysis, and practical applications of Row–Column Designs, with a focus on specific examples like <strong>Latin Square Designs</strong> and <strong>Youden Designs</strong>. We will explore theoretical foundations, implement analyses using R, and engage with advanced topics to provide a comprehensive understanding suitable for graduate-level studies.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li><strong>Understand</strong> the principles and utility of Row–Column Designs.</li>
<li><strong>Explore</strong> specific examples such as Latin Square and Youden Designs.</li>
<li><strong>Analyze</strong> data using ANOVA tailored for Row–Column Designs.</li>
<li><strong>Extend</strong> designs to accommodate factorial experiments.</li>
<li><strong>Implement</strong> Row–Column Designs in R with step-by-step guidance.</li>
<li><strong>Reinforce</strong> concepts through exercises covering numerical examples, conceptual understanding, and mathematical proofs.</li>
<li><strong>Explore</strong> advanced mathematical derivations and proofs in the Appendix.</li>
</ol>
</section>
</section>
<section id="fundamentals-of-rowcolumn-designs" class="level1">
<h1>Fundamentals of Row–Column Designs</h1>
<section id="rowcolumn-design-structure" class="level2">
<h2 class="anchored" data-anchor-id="rowcolumn-design-structure">Row–Column Design Structure</h2>
<p>A <strong>Row–Column Design</strong> arranges experimental units in a two-dimensional grid comprising rows and columns. Each cell in the grid represents an experimental unit to which a treatment is applied. This design incorporates two independent blocking factors:</p>
<ul>
<li><strong>Rows:</strong> Control for variability along the horizontal dimension.</li>
<li><strong>Columns:</strong> Control for variability along the vertical dimension.</li>
</ul>
<p><strong>Diagram of a 3x3 Latin Square:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>Column 1</th>
<th>Column 2</th>
<th>Column 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Row 1</td>
<td>A</td>
<td>B</td>
<td>C</td>
</tr>
<tr class="even">
<td>Row 2</td>
<td>B</td>
<td>C</td>
<td>A</td>
</tr>
<tr class="odd">
<td>Row 3</td>
<td>C</td>
<td>A</td>
<td>B</td>
</tr>
</tbody>
</table>
</section>
<section id="blocking-factors" class="level2">
<h2 class="anchored" data-anchor-id="blocking-factors">Blocking Factors</h2>
<ul>
<li><strong>Row Blocks:</strong> Address systematic variability across rows, such as gradients in environmental conditions.</li>
<li><strong>Column Blocks:</strong> Address systematic variability across columns, such as variations in soil composition.</li>
</ul>
<p><strong>Intuitive Explanation:</strong> Consider a greenhouse experiment where temperature gradients run horizontally and light intensity gradients run vertically. By arranging treatments in a row–column grid, you control for these two sources of environmental variability, ensuring that treatment effects are not confounded with spatial gradients.</p>
</section>
<section id="advantages" class="level2">
<h2 class="anchored" data-anchor-id="advantages">Advantages</h2>
<ol type="1">
<li><strong>Reduced Variability:</strong> By controlling two sources of variability, Row–Column Designs offer greater precision in estimating treatment effects.</li>
<li><strong>Efficiency:</strong> These designs make efficient use of experimental units, especially in small-scale experiments with inherent multidimensional variability.</li>
<li><strong>Flexibility:</strong> They can be extended to accommodate factorial experiments and multiple interactions.</li>
<li><strong>Enhanced Analytical Power:</strong> ANOVA tailored for Row–Column Designs can effectively isolate treatment effects from block effects.</li>
</ol>
<p><strong>Reference:</strong> Montgomery, D. C., Peck, E. A., &amp; Vining, G. G. (2020). <em>Introduction to Linear Regression Analysis</em>. Wiley.</p>
</section>
</section>
<section id="latin-square-designs" class="level1">
<h1>Latin Square Designs</h1>
<section id="definition" class="level2">
<h2 class="anchored" data-anchor-id="definition">Definition</h2>
<p>A <strong>Latin Square Design</strong> is a specialized type of Row–Column Design where:</p>
<ul>
<li>Each treatment appears exactly once in each row.</li>
<li>Each treatment appears exactly once in each column.</li>
</ul>
<p>This ensures that the design is balanced and controls for both row and column effects effectively.</p>
</section>
<section id="construction" class="level2">
<h2 class="anchored" data-anchor-id="construction">Construction</h2>
<ol type="1">
<li><p><strong>Standard Latin Squares:</strong></p>
<p>For <span class="math inline">\(v = 3\)</span> treatments, a Latin Square can be constructed as follows:</p></li>
</ol>
<p><span class="math display">\[
\begin{array}{|c|c|c|}
   \hline
   A &amp; B &amp; C \\
   \hline
   B &amp; C &amp; A \\
   \hline
   C &amp; A &amp; B \\
   \hline
   \end{array}
\]</span></p>
<ul>
<li><strong>Rows and Columns:</strong> Each treatment <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span> appears once per row and column.</li>
</ul>
<ol type="1">
<li><p><strong>Randomization:</strong></p>
<p>To prevent systematic bias, randomize the order of treatments within rows and columns. This can be achieved by randomly permuting the treatment labels for rows and columns.</p></li>
</ol>
</section>
</section>
<section id="analysis-of-variance-for-rowcolumn-designs" class="level1">
<h1>Analysis of Variance for Row–Column Designs</h1>
<section id="model" class="level2">
<h2 class="anchored" data-anchor-id="model">Model</h2>
<p>For a Row–Column Design with <span class="math inline">\(b\)</span> rows, <span class="math inline">\(c\)</span> columns, and <span class="math inline">\(v\)</span> treatments, the ANOVA model is defined as:</p>
<p><span class="math display">\[
Y_{hqi} = \mu + \theta_h + \phi_q + \tau_i + \epsilon_{hqi},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_{hqi}\)</span>: Response for treatment <span class="math inline">\(i\)</span> in row <span class="math inline">\(h\)</span> and column <span class="math inline">\(q\)</span>.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\theta_h\)</span>: Effect of row <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\phi_q\)</span>: Effect of column <span class="math inline">\(q\)</span>.</li>
<li><span class="math inline">\(\tau_i\)</span>: Effect of treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\epsilon_{hqi} \sim N(0, \sigma^2)\)</span>: Random error term.</li>
</ul>
<section id="key-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="key-assumptions">Key Assumptions</h3>
<ol type="1">
<li><strong>Normality:</strong> The residuals (<span class="math inline">\(\epsilon_{hqi}\)</span>) are normally distributed.</li>
<li><strong>Homogeneity of Variance (Homoscedasticity):</strong> The variance of residuals is constant across all treatments, rows, and columns.</li>
<li><strong>Independence:</strong> Observations are independent of each other.</li>
<li><strong>No Interaction:</strong> There is no interaction between rows and treatments or columns and treatments, i.e., the effects of treatments are consistent across rows and columns.</li>
</ol>
</section>
<section id="anova-table" class="level3">
<h3 class="anchored" data-anchor-id="anova-table">ANOVA Table</h3>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 36%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>Degrees of Freedom (DF)</th>
<th>Sum of Squares (SS)</th>
<th>Mean Square (MS)</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rows</td>
<td><span class="math inline">\(b - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Rows}}\)</span></td>
<td><span class="math inline">\(MS_{\text{Rows}} = \frac{SS_{\text{Rows}}}{b - 1}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_{\text{Rows}}}{MS_{\text{Error}}}\)</span></td>
</tr>
<tr class="even">
<td>Columns</td>
<td><span class="math inline">\(c - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Columns}}\)</span></td>
<td><span class="math inline">\(MS_{\text{Columns}} = \frac{SS_{\text{Columns}}}{c - 1}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_{\text{Columns}}}{MS_{\text{Error}}}\)</span></td>
</tr>
<tr class="odd">
<td>Treatments adj</td>
<td><span class="math inline">\(v - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Trt adj}}\)</span></td>
<td><span class="math inline">\(MS_{\text{Trt adj}} = \frac{SS_{\text{Trt adj}}}{v - 1}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_{\text{Treatments}}}{MS_{\text{Error}}}\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(bc - b - c - v + 2\)</span></td>
<td><span class="math inline">\(SS_{\text{Error}}\)</span></td>
<td><span class="math inline">\(MS_{\text{Error}} = \frac{SS_{\text{Error}}}{bc - b - c - v + 2}\)</span></td>
<td>-</td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td><span class="math inline">\(b c - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Total}}\)</span></td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h2>
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> All treatment means are equal (<span class="math inline">\(\tau_i = 0\)</span> for all <span class="math inline">\(i\)</span>).</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> At least one treatment mean differs.</li>
</ul>
<p><strong>Decision Rule:</strong> Reject <span class="math inline">\(H_0\)</span> if the F-ratio for treatments exceeds the critical value from the F-distribution with degrees of freedom <span class="math inline">\((v - 1, bc - b - c - v + 2)\)</span> at the chosen significance level (<span class="math inline">\(\alpha\)</span>).</p>
</section>
<section id="example-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="example-interpretation">Example Interpretation</h2>
<ul>
<li><strong>Rows and Columns:</strong> Assess the significance of row and column effects. Significant row or column effects indicate that these blocking factors explain a substantial portion of the variability in the response.</li>
<li><strong>Treatments:</strong> Determine if treatments have a significant impact on the response variable after accounting for row and column effects.</li>
<li><strong>Error:</strong> Represents unexplained variability, serving as the denominator for F-ratios.</li>
</ul>
<!-- **Reference:**
Scheffé, H. (1959). *The Analysis of Variance*. Wiley. -->
</section>
<section id="computational-formula" class="level2">
<h2 class="anchored" data-anchor-id="computational-formula">Computational Formula</h2>
<p>These formulas typically apply to the Analysis of Variance (ANOVA) for experimental designs involving treatments laid out in a structure with rows and columns, aiming to control for variability from these two sources (e.g., Latin Squares, Youden Squares, Row-Column Designs).</p>
<ul>
<li><span class="math inline">\(b\)</span>: Number of rows</li>
<li><span class="math inline">\(c\)</span>: Number of columns</li>
<li><span class="math inline">\(v\)</span>: Number of treatments</li>
<li><span class="math inline">\(y_{hq}\)</span>: Observation in row&nbsp;<span class="math inline">\(h\)</span>&nbsp;and column&nbsp;<span class="math inline">\(q\)</span></li>
<li><span class="math inline">\(t(h,q)\)</span>: Treatment applied in cell&nbsp;<span class="math inline">\((h,q)\)</span></li>
<li><span class="math inline">\(N = bc\)</span>: Total number of observations (assuming a complete layout)</li>
<li><span class="math inline">\(B_h = \sum_{q=1}^{c} y_{hq}\)</span>: Total for row&nbsp;<span class="math inline">\(h\)</span>&nbsp;(sum of&nbsp;<span class="math inline">\(c\)</span>&nbsp;observations)</li>
<li><span class="math inline">\(C_q = \sum_{h=1}^{b} y_{hq}\)</span>: Total for column&nbsp;<span class="math inline">\(q\)</span>&nbsp;(sum of&nbsp;<span class="math inline">\(b\)</span>&nbsp;observations)</li>
<li><span class="math inline">\(T_i = \sum_{(h,q): t(h,q)=i} y_{hq}\)</span>: Total for treatment&nbsp;<span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(G = \sum_{h=1}^{b} \sum_{q=1}^{c} y_{hq}\)</span>: Grand total (sum of&nbsp;<span class="math inline">\(N=bc\)</span>&nbsp;observations)</li>
<li><span class="math inline">\(r\)</span>: Number of replications per treatment (assumed constant in some provided formulas, but could be&nbsp;<span class="math inline">\(r_i\)</span>)</li>
<li><span class="math inline">\(n_{h.i}\)</span>: Number of times treatment&nbsp;<span class="math inline">\(i\)</span>&nbsp;appears in row&nbsp;<span class="math inline">\(h\)</span></li>
<li><span class="math inline">\(n_{.qi}\)</span>: Number of times treatment&nbsp;<span class="math inline">\(i\)</span>&nbsp;appears in column&nbsp;<span class="math inline">\(q\)</span></li>
<li><span class="math inline">\(CF = \frac{G^2}{N} = \frac{G^2}{bc}\)</span>: Correction Factor</li>
</ul>
<p>Note. We have <span class="math inline">\(r\)</span> replications per treatment in a complete design, but in some cases, <span class="math inline">\(r_i\)</span> may vary. The formulas provided assume a complete layout with equal replication. ## Unadjusted Row Effect Sum of Squares (<span class="math inline">\(SS_\theta\)</span>)</p>
<p><span class="math display">\[
SS_{Rows} = \frac{1}{c} \sum_{h=1}^{b} B_h^2 - \frac{2 G^2}{bc} + \frac{b G^2}{bc} = \frac{1}{c} \sum_{h=1}^{b} B_h^2 - \frac{G^2}{bc}
\]</span></p>
</section>
<section id="derivation-of-row-effect-sum-of-squares" class="level2">
<h2 class="anchored" data-anchor-id="derivation-of-row-effect-sum-of-squares">Derivation of Row Effect Sum of Squares</h2>
<p>The unadjusted sum of squares for rows measures the variability between row means.</p>
<ul>
<li>Row mean&nbsp;<span class="math inline">\(h\)</span>:&nbsp;<span class="math inline">\(\bar{y}_{h.} = B_h / c\)</span></li>
<li>Grand mean:&nbsp;<span class="math inline">\(\bar{y}_{..} = G / N = G / (bc)\)</span></li>
<li>The sum of squares is the sum of squared deviations from the grand mean, weighted by the number of observations per row:</li>
</ul>
<p><span class="math display">\[
SS_{Rows} = \sum_{h=1}^{b} \sum_{q=1}^{c} (\bar{y}_{h.} - \bar{y}_{..})^2 = \sum_{h=1}^{b} c (\bar{y}_{h.} - \bar{y}_{..})^2
\]</span></p>
<ul>
<li>Substitute the means:</li>
</ul>
<p><span class="math display">\[
SS_{Rows} = \sum_{h=1}^{b} c \left(\frac{B_h}{c} - \frac{G}{bc}\right)^2 = \sum_{h=1}^{b} c \left[\frac{B_h^2}{c^2} - \frac{2 B_h G}{bc^2} + \frac{G^2}{(bc)^2}\right]
\]</span></p>
<ul>
<li>Distribute the sum and simplify:</li>
</ul>
<p><span class="math display">\[
SS_{Rows} = \sum_{h=1}^{b} \left[\frac{B_h^2}{c} - \frac{2 B_h G}{bc} + \frac{c G^2}{b^2 c^2}\right]
\]</span></p>
<p><span class="math display">\[
SS_{Rows} = \left(\frac{1}{c} \sum_{h=1}^{b} B_h^2\right) - \frac{2 G}{bc} \left(\sum_{h=1}^{b} B_h\right) + \sum_{h=1}^{b} \frac{G^2}{bc}
\]</span></p>
<ul>
<li>Since&nbsp;<span class="math inline">\(\sum B_h = G\)</span>&nbsp;and the last term sums&nbsp;<span class="math inline">\(b\)</span>&nbsp;times:</li>
</ul>
<p><span class="math display">\[
SS_{Rows} = \frac{1}{c} \sum_{h=1}^{b} B_h^2 - \frac{2 G^2}{bc} + \frac{b G^2}{bc} = \frac{1}{c} \sum_{h=1}^{b} B_h^2 - \frac{G^2}{bc}
\]</span></p>
<ul>
<li>The formula’s&nbsp;<span class="math inline">\(1/c\)</span>&nbsp;factor arises naturally because each&nbsp;<span class="math inline">\(B_h\)</span>&nbsp;is the sum of&nbsp;<span class="math inline">\(c\)</span>&nbsp;observations. Dividing the squared total&nbsp;<span class="math inline">\(B_h^2\)</span>&nbsp;by&nbsp;<span class="math inline">\(c\)</span>&nbsp;scales it appropriately for the sum of squares calculation based on means.</li>
</ul>
</section>
<section id="unadjusted-column-effect-sum-of-squares-ss_phi" class="level2">
<h2 class="anchored" data-anchor-id="unadjusted-column-effect-sum-of-squares-ss_phi">Unadjusted Column Effect Sum of Squares (<span class="math inline">\(ss_\phi\)</span>)</h2>
<p><span class="math display">\[
SS_{Cols} = \frac{1}{b} \sum_{q=1}^{c} C_q^2 - \frac{G^2}{bc}
\]</span></p>
<ol start="3" type="1">
<li>Derivation of Standard Formula:</li>
</ol>
<p>The derivation is analogous to the Row SS derivation, swapping roles of rows and columns.</p>
<ul>
<li>Column mean&nbsp;<span class="math inline">\(q\)</span>:&nbsp;<span class="math inline">\(\bar{y}_{.q} = C_q / b\)</span></li>
<li>Grand mean:&nbsp;<span class="math inline">\(\bar{y}_{..} = G / (bc)\)</span></li>
<li>Sum of squares:</li>
</ul>
<p><span class="math display">\[
SS_{Cols} = \sum_{q=1}^{c} \sum_{h=1}^{b} (\bar{y}_{.q} - \bar{y}_{..})^2 = \sum_{q=1}^{c} b (\bar{y}_{.q} - \bar{y}_{..})^2
\]</span></p>
<ul>
<li>Following similar algebraic steps as for&nbsp;<span class="math inline">\(SS_{Rows}\)</span>&nbsp;leads to:</li>
</ul>
<p><span class="math display">\[
SS_{Cols} = \frac{1}{b} \sum_{q=1}^{c} C_q^2 - \frac{G^2}{bc}
\]</span></p>
<section id="treatment-effect-adjusted-for-rows-and-columns" class="level3">
<h3 class="anchored" data-anchor-id="treatment-effect-adjusted-for-rows-and-columns">Treatment Effect (Adjusted for Rows and Columns)</h3>
<p>Adjustment is needed because treatments are generally not orthogonal to rows and columns. We first find adjusted treatment totals (<span class="math inline">\(Q_i\)</span>) and then use them to calculate the adjusted treatment sum of squares (<span class="math inline">\(SS_\text{Trt adju}\)</span>).</p>
<section id="adjusted-treatment-totals-q_i" class="level4">
<h4 class="anchored" data-anchor-id="adjusted-treatment-totals-q_i">Adjusted Treatment Totals (<span class="math inline">\(Q_i\)</span>)</h4>
<p><span class="math display">\[
Q_i = T_i - \frac{1}{c} \sum_{h=1}^{b} n_{h.i} B_h - \frac{1}{b} \sum_{q=1}^{c} n_{.qi} C_q + \frac{b}{c} r_i G
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(T_i\)</span>: Total for treatment <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(B_h\)</span>: Total for row <span class="math inline">\(h\)</span></li>
<li><span class="math inline">\(C_q\)</span>: Total for column <span class="math inline">\(q\)</span></li>
<li><span class="math inline">\(G\)</span>: Grand total</li>
<li><span class="math inline">\(h\)</span>: Row index</li>
<li><span class="math inline">\(q\)</span>: Column index</li>
<li><span class="math inline">\(n_{h.i}\)</span>: Number of times treatment <span class="math inline">\(i\)</span> appears in row <span class="math inline">\(h\)</span></li>
<li><span class="math inline">\(n_{.qi}\)</span>: Number of times treatment <span class="math inline">\(i\)</span> appears in column <span class="math inline">\(q\)</span></li>
</ul>
<p>Note. This uses potentially variable replication <span class="math inline">\(r_i\)</span>. If <span class="math inline">\(r\)</span> is constant, <span class="math inline">\(r_i\)</span> becomes <span class="math inline">\(r\)</span>. This formula assumes <span class="math inline">\(r_i\)</span> replications per treatment.</p>
</section>
</section>
</section>
<section id="explanation-of-standard-formula" class="level2">
<h2 class="anchored" data-anchor-id="explanation-of-standard-formula">Explanation of Standard Formula:</h2>
<ul>
<li>The adjusted total <span class="math inline">\(Q_i\)</span> is the raw treatment total$ T_i$ corrected for the effects of the specific rows and columns where treatment <span class="math inline">\(i\)</span> appeared.</li>
<li>The adjustment subtracts the estimated contribution of row means (<span class="math inline">\(B_h/c\)</span>) and column means (<span class="math inline">\(C_q/b\)</span>) for the units receiving treatment i and adds back the overall mean effect (<span class="math inline">\(G/bc\)</span>) scaled by the number of replications (<span class="math inline">\(r_i\)</span>).</li>
<li>This quantity arises naturally from the normal equations for estimating treatment effects (<span class="math inline">\(\tau_i\)</span>) in the linear model <span class="math inline">\(y_{hq(i)} = \mu + \theta_h + \phi_q + \tau_i + \epsilon_{hq(i)}\)</span> after eliminating row and column parameters. The <span class="math inline">\(Q_i\)</span> form the right-hand side of the reduced normal equations for the treatment effects.</li>
</ul>
</section>
<section id="adjusted-treatment-sum-of-squares-ss_texttrt-adj" class="level2">
<h2 class="anchored" data-anchor-id="adjusted-treatment-sum-of-squares-ss_texttrt-adj">Adjusted Treatment Sum of Squares (<span class="math inline">\(SS_\text{Trt adj}\)</span>)</h2>
<p><span class="math display">\[
SS_\text{Trt adj} = \sum_{i=1}^{v} Q_i \hat{\tau}_i
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(ss_{Tadj}\)</span>: Adjusted treatment sum of squares</li>
<li><span class="math inline">\(Q_i\)</span>: Adjusted treatment total for treatment <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\hat{\tau}_i\)</span>: Estimated treatment effect for treatment <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(v\)</span>: Number of treatments</li>
<li><span class="math inline">\(\hat{\tau}_i\)</span>: Estimated treatment effect (solution to the reduced normal equations)</li>
</ul>
</section>
<section id="explanation-of-standard-formula-1" class="level2">
<h2 class="anchored" data-anchor-id="explanation-of-standard-formula-1">Explanation of Standard Formula:</h2>
<ul>
<li>This formula arises directly from the theory of linear models.</li>
<li>The adjusted sum of squares for a factor (here, treatments) can be expressed as the quadratic form <span class="math inline">\(\hat{\tau}' Q\)</span>, where <span class="math inline">\(\hat{\tau}\)</span> is the vector of estimated treatment effects (solutions to the reduced normal equations <span class="math inline">\(C \hat{\tau} = Q\)</span>) and <span class="math inline">\(Q\)</span> is the vector of adjusted totals.</li>
<li>Expanding <span class="math inline">\(\hat{\tau}' Q\)</span> gives the summation <span class="math inline">\(\sum Q_i \hat{\tau}_i\)</span>.</li>
<li>Alternative computational formulas often exist, especially for balanced designs (e.g., involving <span class="math inline">\(\sum Q_i^2\)</span>), but this form is theoretically fundamental.</li>
</ul>
</section>
</section>
<section id="latin-square-designs-1" class="level1">
<h1>Latin Square Designs</h1>
<section id="analysis-of-variance-anova" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-variance-anova">Analysis of Variance (ANOVA)</h2>
<p>For a Latin Square Design with <span class="math inline">\(v\)</span> treatments, the ANOVA model includes:</p>
<p><span class="math display">\[
Y_{hqi} = \mu + \theta_h + \phi_q + \tau_i + \epsilon_{hqi},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_{hqi}\)</span>: Response for treatment <span class="math inline">\(i\)</span> in row <span class="math inline">\(h\)</span> and column <span class="math inline">\(q\)</span>.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\theta_h\)</span>: Effect of row <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\phi_q\)</span>: Effect of column <span class="math inline">\(q\)</span>.</li>
<li><span class="math inline">\(\tau_i\)</span>: Effect of treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\epsilon_{hqi} \sim N(0, \sigma^2)\)</span>: Random error term.</li>
</ul>
<p>In a <strong>classical (fully balanced) Latin Square</strong>, the <strong>treatment sum of squares</strong> is the same whether you view it as “adjusted” (after removing row and column effects) or “unadjusted” (looking at treatments alone). In other words, <strong>they do not differ</strong>.</p>
</section>
<section id="why-they-are-the-same" class="level2">
<h2 class="anchored" data-anchor-id="why-they-are-the-same">Why They Are the Same</h2>
<ol type="1">
<li><p><strong>Orthogonality</strong><br>
In a Latin Square, the design is constructed so that treatments are orthogonal (statistically independent) to the row and column factors. Orthogonality means that when you estimate the effect of treatments, you are not “borrowing” or “confounding” variation that belongs to the row or column blocks.</p></li>
<li><p><strong>Balanced Cells</strong><br>
Each treatment occurs exactly once in every row and once in every column, so there is no overlap in the sum of squares partition:<br>
<span class="math display">\[
\text{SSTotal} \;=\; \text{SSRows} \;+\; \text{SSColumns} \;+\; \text{SSTreatments} \;+\; \text{SSError}.
\]</span> Because of this strict balance, the decomposition of sums of squares is clean and unique.</p></li>
<li><p><strong>Adjusted = Unadjusted for Orthogonal Designs</strong><br>
When factors are orthogonal, “partial” or “adjusted” sum of squares for a given factor (e.g.&nbsp;treatments) equals the “unadjusted” sum of squares you would get if you calculated it <em>before</em> removing the other factors. No matter the sequence in which you enter factors into the model, the SS for each orthogonal factor is unchanged.</p></li>
</ol>
</section>
<section id="when-they-might-differ" class="level2">
<h2 class="anchored" data-anchor-id="when-they-might-differ">When They Might Differ</h2>
<ul>
<li><p><strong>Missing Data or Unbalanced Layout</strong><br>
If some runs are missing or the design is not balanced, the orthogonality breaks. Then the “adjusted” (Type III or partial) sum of squares for treatments can differ from the “unadjusted” (Type I or sequential) sum of squares.</p></li>
<li><p><strong>Non-orthogonal Blocks/Treatments</strong><br>
If blocking factors and treatments are not arranged in an orthogonal way (as in some incomplete-block or more complex designs), you can again see discrepancies.</p></li>
</ul>
<p>In the <strong>standard (complete, balanced) Latin Square</strong>, however, there is perfect orthogonality among row blocks, column blocks, and treatments—so the treatment SS is invariant to whether you consider it “adjusted” or “unadjusted.”</p>
</section>
<section id="example-anova-table-for-latin-square" class="level2">
<h2 class="anchored" data-anchor-id="example-anova-table-for-latin-square">Example ANOVA Table for Latin Square</h2>
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>Degrees of Freedom</th>
<th>Sum of Squares</th>
<th>Mean Square</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rows</td>
<td><span class="math inline">\(v - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Rows}\)</span></td>
<td><span class="math inline">\(MS_\text{Rows}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_\text{Rows}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="even">
<td>Columns</td>
<td><span class="math inline">\(v - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Columns}\)</span></td>
<td><span class="math inline">\(MS_\text{Columns}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_\text{Columns}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="odd">
<td>Treatments Adjusted</td>
<td><span class="math inline">\(v - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Trt Adj}\)</span></td>
<td><span class="math inline">\(MS_\text{Trt adj}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_\text{Trt adj}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\((v-2)(v-1)\)</span></td>
<td><span class="math inline">\(SS_\text{Error}\)</span></td>
<td><span class="math inline">\(MS_\text{Error}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td><span class="math inline">\(v^2 - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Total}\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Hypothesis Testing:</strong></p>
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> All treatment means are equal (<span class="math inline">\(\tau_k = 0\)</span> for all <span class="math inline">\(k\)</span>).</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> At least one treatment mean differs.</li>
</ul>
<p><strong>Decision Rule:</strong> Reject <span class="math inline">\(H_0\)</span> if the F-ratio for treatments exceeds the critical value from the F-distribution with degrees of freedom <span class="math inline">\((v - 1, (v-2)(v-1))\)</span> at the chosen significance level (<span class="math inline">\(\alpha\)</span>).</p>
</section>
<section id="example-in-r" class="level2">
<h2 class="anchored" data-anchor-id="example-in-r">Example in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated Data for Latin Square Design</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">row =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">3</span>)),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">column =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times =</span> <span class="dv">3</span>)),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>)),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">response =</span> <span class="fu">c</span>(<span class="fl">10.2</span>, <span class="fl">15.3</span>, <span class="fl">20.1</span>, <span class="fl">14.8</span>, <span class="fl">19.5</span>, <span class="fl">9.7</span>, <span class="fl">19.0</span>, <span class="fl">9.9</span>, <span class="fl">14.2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANOVA Model</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(response <span class="sc">~</span> row <span class="sc">+</span> column <span class="sc">+</span> treatment, <span class="at">data =</span> data)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">row</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0688889</td>
<td style="text-align: right;">0.5344444</td>
<td style="text-align: right;">6.5890411</td>
<td style="text-align: right;">0.1317690</td>
</tr>
<tr class="even">
<td style="text-align: left;">column</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.1088889</td>
<td style="text-align: right;">0.0544444</td>
<td style="text-align: right;">0.6712329</td>
<td style="text-align: right;">0.5983607</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatment</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">138.2422222</td>
<td style="text-align: right;">69.1211111</td>
<td style="text-align: right;">852.1780822</td>
<td style="text-align: right;">0.0011721</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.1622222</td>
<td style="text-align: right;">0.0811111</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> - <strong>Rows and Columns:</strong> Control for row and column effects, ensuring that treatment comparisons are not confounded by these blocking factors. - <strong>Treatments:</strong> Assess the main effect of treatments on the response variable after accounting for row and column effects. - <strong>Error:</strong> Represents variability not explained by rows, columns, or treatments. <!-- 
# Youden Designs

## Definition

A **Youden Design** is a type of Row–Column Design that extends the Latin Square by allowing for multiple treatments per row or column. Specifically, in a Youden Design:

1. **Row Blocks:** Form a **balanced incomplete block design**.
2. **Column Blocks:** Each treatment appears once per column.

This design is particularly useful when the number of treatments exceeds the number of rows or columns, providing flexibility in experimental layouts.

## Construction

Consider a Youden Design with parameters $v = 4$ treatments, $b = 4$ blocks (rows), and $c = 3$ columns. The design ensures that each treatment appears once in each column and multiple times across rows.

**Example Design:**

$$
\begin{array}{|c|c|c|}
\hline
A & B & C \\
\hline
B & C & D \\
\hline
C & D & A \\
\hline
D & A & B \\
\hline
\end{array}
$$

## Applications

- **Clinical Trials:** When treatments need to be tested across different time periods or conditions.
- **Agricultural Studies:** When testing multiple crop varieties across different soil types and irrigation methods.
- **Industrial Experiments:** When assessing the effects of various process parameters across different machines or shifts.

## Analysis of Youden Designs

The ANOVA model for a Youden Design incorporates both row and column effects, along with treatment effects and their interactions.

$$
Y_{hit} = \mu + \theta_h + \phi_i + \tau_t + (\theta \tau)_{ht} + \epsilon_{hit},
$$

where:

- $Y_{hit}$: Response for treatment $t$ in row $h$ and column $i$.
- $\mu$: Overall mean.
- $\theta_h$: Effect of row $h$.
- $\phi_i$: Effect of column $i$.
- $\tau_t$: Effect of treatment $t$.
- $(\theta \tau)_{ht}$: Interaction effect between row $h$ and treatment $t$.
- $\epsilon_{hit}$: Random error term.

**Degrees of Freedom:**

- Rows: $b - 1$
- Columns: $c - 1$
- Treatments: $v - 1$
- Error: $bc - b - c - v + 2$

**Hypothesis Testing:**

- **Null Hypothesis ($H_0$):** All treatment means are equal.
- **Alternative Hypothesis ($H_A$):** At least one treatment mean differs.

**Decision Rule:**
Reject $H_0$ if the F-ratio for treatments exceeds the critical value from the F-distribution with degrees of freedom $(v - 1, bc - b - c - v + 2)$ at the chosen significance level ($\alpha$).

**Reference:**
Christensen, R. (2018). *Analysis of Variance, Design, and Regression*. Chapman and Hall/CRC.


# Practical Extensions

## Factorial Experiments in Row–Column Designs

When treatments involve multiple factors (e.g., factorial combinations), Row–Column Designs can be extended to accommodate these complexities. This allows for the examination of interactions between factors within the blocking structure.

## Model with Interaction Terms

$$
Y_{hqijk} = \mu + \theta_h + \phi_q + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \epsilon_{hqijk},
$$

where:

- $\alpha_i$, $\beta_j$: Main effects of factors A and B.
- $(\alpha\beta)_{ij}$: Interaction effect between factors A and B.

## R Example: Two-Way Factorial in Row–Column Design





::: {.cell tbl-cap='Two-Way Factorial in Row–Column Design Example 1'}

```{.r .cell-code}
# Two-Way Factorial in Row–Column Design
set.seed(456)

# Define Factors and Blocks
data <- data.frame(
    row = factor(rep(1:3, each = 6)),
    column = factor(rep(rep(1:2, each = 3), 3)),
    factorA = factor(rep(c("Low", "High"), each = 9)),
    factorB = factor(rep(c("Control", "Treatment"), times = 9)),
    response = c(
        rnorm(3, mean = 5, sd = 2),
        rnorm(3, mean = 10, sd = 2),
        rnorm(3, mean = 15, sd = 2),
        rnorm(3, mean = 5, sd = 2),
        rnorm(3, mean = 10, sd = 2),
        rnorm(3, mean = 15, sd = 2)
    )
)

# View the Data
print(data)
```

::: {.cell-output .cell-output-stdout}

```
   row column factorA   factorB  response
1    1      1     Low   Control  2.312957
2    1      1     Low Treatment  6.243551
3    1      1     Low   Control  6.601749
4    1      2     Low Treatment  7.222215
5    1      2     Low   Control  8.571286
6    1      2     Low Treatment  9.351878
7    2      1     Low   Control 16.381286
8    2      1     Low Treatment 15.501096
9    2      1     Low   Control 17.014705
10   2      2    High Treatment  6.146469
11   2      2    High   Control  3.168379
12   2      2    High Treatment  7.622195
13   3      1    High   Control 11.977453
14   3      1    High Treatment 13.307857
15   3      1    High   Control  7.118390
16   3      2    High Treatment 18.894713
17   3      2    High   Control 18.473872
18   3      2    High Treatment 15.774967
```


:::
:::

::: {.cell tbl-cap='ANOVA for Two-Way Factorial in Row–Column Design Example 1'}

```{.r .cell-code}
# Fit ANOVA Model with Interaction
fit <- lm(response ~ row + column + factorA * factorB, data = data)
anova(fit)
```

::: {.cell-output-display}
<div class="kable-table">

|                | Df|     Sum Sq|    Mean Sq|    F value|    Pr(>F)|
|:---------------|--:|----------:|----------:|----------:|---------:|
|row             |  2| 171.522104|  85.761052| 19.2558106| 0.0002551|
|column          |  1|   0.084470|   0.084470|  0.0189659| 0.8929528|
|factorA         |  1| 248.835167| 248.835167| 55.8706166| 0.0000124|
|factorB         |  1|   4.901671|   4.901671|  1.1005655| 0.3166450|
|factorA:factorB |  1|   7.798776|   7.798776|  1.7510484| 0.2125907|
|Residuals       | 11|  48.991527|   4.453775|         NA|        NA|

</div>
:::
:::





**Interpretation:**

- **Main Effects:** Assess the individual impact of factors A and B.
- **Interaction Effect:** Determine if the effect of one factor depends on the level of the other factor.
- **Blocking Factors:** Control for row and column variability, ensuring that treatment comparisons are not confounded by these dimensions.

**Reference:**
Dean, A., Voss, D., & Draguljić, D. (2017). *Design and Analysis of Experiments*. Springer.

# Practical Applications

## Example: Resting Metabolic Rate

### Scenario

A study aims to compare three different exercise protocols (Treatments A, B, C) on subjects' resting metabolic rates. To control for age-related variability, subjects are grouped into four blocks based on age groups.

### Step-by-Step R Code

#### 1. Load and Prepare Data





::: {.cell tbl-cap='Data Simulation for Resting Metabolic Rate Example 2'}

```{.r .cell-code}
# Set Seed for Reproducibility
set.seed(789)

# Define Blocks and Treatments
blocks <- factor(rep(1:4, each = 3))
treatments <- factor(rep(c("A", "B", "C"), times = 4))

# Simulate Response Variable (resting Metabolic Rate in kcal/day)
response <- c(
    rnorm(3, mean = 1500, sd = 50), # Block 1
    rnorm(3, mean = 1550, sd = 50), # Block 2
    rnorm(3, mean = 1480, sd = 50), # Block 3
    rnorm(3, mean = 1520, sd = 50) # Block 4
)

# Create Data Frame
data <- data.frame(blocks, treatments, response)

# View the Data
print(data)
```

::: {.cell-output .cell-output-stdout}

```
   blocks treatments response
1       1          A 1526.205
2       1          B 1386.962
3       1          C 1499.016
4       2          A 1559.157
5       2          B 1531.932
6       2          C 1525.776
7       3          A 1446.684
8       3          B 1471.277
9       3          C 1429.452
10      4          A 1556.985
11      4          B 1499.885
12      4          C 1469.861
```


:::
:::





**Output Interpretation:**
The dataset comprises four blocks, each containing three treatments. The response variable represents the resting metabolic rate, simulated with slight block-specific means to reflect age-related variability.

#### 2. Fit the RCBD Model





::: {.cell tbl-cap='ANOVA for Resting Metabolic Rate Example 2'}

```{.r .cell-code}
# Fit the RCBD Model Using ANOVA
model <- aov(response ~ blocks + treatments, data = data)

# Summary of the Model
summary(model)
```

::: {.cell-output .cell-output-stdout}

```
            Df Sum Sq Mean Sq F value Pr(>F)
blocks       3  14341    4780   2.690  0.140
treatments   2   5663    2831   1.593  0.279
Residuals    6  10664    1777               
```


:::
:::





**Interpretation:**
- **Blocks:** Capture the variability due to different age groups.
- **Treatments:** Assess the effect of exercise protocols after accounting for age-related variability.
- **Error:** Represents unexplained variability in resting metabolic rates.

#### 3. Diagnostic Plots





::: {.cell tbl-cap='Diagnostic Plots for Resting Metabolic Rate Example 2'}

```{.r .cell-code}
# Diagnostic Plots for the ANOVA Model
par(mfrow = c(2, 2))
plot(model)
```

::: {.cell-output-display}
![](week-11_row-column-youden_files/figure-html/tab-rcbd-diagnostic-plots-example2-1.png){width=672}
:::
:::





**Interpretation:**
Examine residual plots to ensure that assumptions of normality, homoscedasticity, and independence are met. Look for random scatter in Residuals vs Fitted and Q-Q plots to assess normality.

#### 4. Post-Hoc Analysis (Multiple Comparisons)





::: {.cell tbl-cap='Pairwise Comparisons for Resting Metabolic Rate Example 2'}

```{.r .cell-code}
# Load Emmeans Package for Estimated Marginal means
library(emmeans)

# Estimated Marginal means for Treatments
emm <- emmeans(model, ~treatments)

# Pairwise Comparisons
pairwise_comparisons <- contrast(emm, method = "pairwise")
summary(pairwise_comparisons)
```

::: {.cell-output-display}
<div class="kable-table">

|contrast |  estimate|       SE| df|    t.ratio|   p.value|
|:--------|---------:|--------:|--:|----------:|---------:|
|A - B    | 49.743808| 29.81103|  6|  1.6686379| 0.2909461|
|A - C    | 41.231543| 29.81103|  6|  1.3830971| 0.4062672|
|B - C    | -8.512266| 29.81103|  6| -0.2855408| 0.9563720|

</div>
:::
:::





**Interpretation:**
Identify which exercise protocols significantly differ in their effect on resting metabolic rates after adjusting for age-related variability.

# Conclusion

**Row–Column Designs**, including **Latin Square Designs** and **Youden Designs**, are powerful tools in experimental research for controlling multiple sources of variability. By structuring experiments to account for both row and column effects, these designs enhance the precision and reliability of treatment comparisons. The integration of ANOVA facilitates robust analysis, allowing researchers to discern meaningful differences among treatments while mitigating confounding factors.

**Key Takeaways:**

- **Row–Column Structure:** Efficiently controls for two independent sources of variability, improving the precision of treatment effect estimates.
- **Latin Square Designs:** Ensure each treatment appears once per row and column, providing a balanced design ideal for experiments with three blocking factors.
- **Youden Designs:** Extend the flexibility of Latin Square Designs by allowing for multiple treatments per row or column, accommodating more complex experimental scenarios.
- **ANOVA in Row–Column Designs:** Decomposes variability into row, column, treatment, and error components, facilitating comprehensive hypothesis testing.
- **Factorial Extensions:** Enable the examination of interactions between multiple factors within the blocking structure, offering deeper insights into treatment effects.
- **Practical Implementation in R:** R provides robust tools for designing, analyzing, and interpreting Row–Column Designs, empowering researchers with advanced statistical capabilities.
- **Advanced Topics:** Understanding interactions and sample size considerations enhances the applicability and rigor of Row–Column Designs in diverse research contexts.

Mastery of Row–Column Designs equips graduate students with the methodological rigor necessary for conducting sophisticated experiments, ensuring that findings are both accurate and generalizable.

**Future Directions:**
Further exploration into advanced experimental designs, mixed-effects models, and nonparametric Row–Column Designs will provide a deeper understanding of complex data structures and enhance analytical capabilities.

# Appendix: Advanced Mathematical Derivations

## Variance Calculations for Latin Square Designs

In a **Latin Square Design** with $v$ treatments, the variance of the estimated treatment effects is influenced by the design's structure.

### Formula

For a Latin Square with $v$ treatments:

$$
Var(\tau_i) = \frac{\sigma^2}{v}
$$

### Derivation

1. **Model Setup:**

   The ANOVA model for a Latin Square is:

$$
Y_{ijk} = \mu + \alpha_i + \beta_j + \tau_k + \epsilon_{ijk},
$$

   where $\epsilon_{ijk} \sim N(0, \sigma^2)$.

1. **Estimator for Treatment Effect ($\tau_k$):**

   The treatment effects are estimated as:

$$
\hat{\tau}_k = \bar{Y}_{\cdot \cdot k} - \bar{Y}_{\cdot \cdot \cdot},
$$

   where $\bar{Y}_{\cdot \cdot k}$ is the mean response for treatment $k$ and $\bar{Y}_{\cdot \cdot \cdot}$ is the grand mean.

1. **Variance of $\hat{\tau}_k$:**

   Since each treatment is replicated $v$ times (once per row and column):

$$
Var(\hat{\tau}_k) = \frac{\sigma^2}{v}
$$

**Conclusion:**
The variance of the treatment effect estimates decreases with increasing number of treatments in the Latin Square, enhancing the precision of the estimates.

**Reference:**
Montgomery, D. C., & Runger, G. C. (2020). *Applied Statistics and Probability for Engineers*. Wiley.

## Degrees of Freedom in Youden Designs

For a **Youden Design** with parameters $v = 4$ treatments, $b = 4$ blocks (rows), and $c = 3$ columns, the degrees of freedom for the error term are calculated as follows:

### Formula

$$
df_{\text{Error}} = bc - b - c - v + 2
$$

### Calculation

Given:

- $v = 4$
- $b = 4$
- $c = 3$

Plugging into the formula:

$$
df_{\text{Error}} = (4 \times 3) - 4 - 3 - 4 + 2 = 12 - 4 - 3 - 4 + 2 = 3
$$

**Interpretation:**
The error degrees of freedom indicate the number of independent pieces of information available to estimate the error variance. In this case, with 3 error degrees of freedom, the design is sufficiently constrained to estimate treatment effects after accounting for row and column effects.

**Reference:**
Dean, Voss & Draguljić (2017). *Design and Analysis of Experiments*. Springer.

## Proof of Interaction Contrasts

### Interaction Contrasts Measure Deviations from Additivity

**Definition:**
In a three-factor design, interaction contrasts quantify how the combined effect of three factors deviates from the additive effects of each factor individually and their two-way interactions.

### Proof Steps

1. **Define the Three-Factor Model:**

$$
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk} + (\alpha\beta\gamma)_{ijk} + \epsilon_{ijk}
$$

   where $\sum \alpha_i = \sum \beta_j = \sum \gamma_k = 0$.

1. **Construct Interaction Contrasts:**

   - **Two-Way Interactions:**
     - $(\alpha\beta)_{ij}$ measures the interaction between Factors A and B.
     - Similarly for $(\alpha\gamma)_{ik}$ and $(\beta\gamma)_{jk}$.
   - **Three-Way Interaction:**
     - $(\alpha\beta\gamma)_{ijk}$ measures the deviation from additivity among all three factors.

2. **Prove Deviations from Additivity:**

   - **Additive Model:**
     If all interaction terms are zero ($(\alpha\beta)_{ij} = (\alpha\gamma)_{ik} = (\beta\gamma)_{jk} = (\alpha\beta\gamma)_{ijk} = 0$), the model simplifies to:

$$
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + \epsilon_{ijk}
$$

     This represents a purely additive model where the combined effect of factors is the sum of their individual effects.

   - **Non-Additive Model:**
     If any of the interaction terms are non-zero, the model deviates from additivity, indicating that the effect of one factor depends on the levels of other factors.

1. **Conclusion:**

   Interaction contrasts ($(\alpha\beta)_{ij}$, $(\alpha\gamma)_{ik}$, $(\beta\gamma)_{jk}$, and $(\alpha\beta\gamma)_{ijk}$) measure the extent to which the observed responses deviate from an additive model. Non-zero contrasts signify the presence of interactions, emphasizing the importance of considering these higher-order effects in experimental analysis.

**Reference:**
Dean, Voss & Draguljić (2017). *Design and Analysis of Experiments*. Springer. --></p>


</section>
</section>

</main> <!-- /main -->
<!-- filepath: /Users/dt/Library/CloudStorage/Dropbox/Teaching/DOE/assets/includes/footer.html -->
<footer class="site-footer">
    <div class="container text-center">
        <hr> 
        © <span id="current-year"></span> Dr. Davood Tofighi |
        <a href="https://canvasinfo.unm.edu/">UNM Canvas</a> |
        <a href="https://data-wise.github.io/doe">Course GitHub Page</a> |
    </div>
    <script>
        document.getElementById("current-year").textContent = new Date().getFullYear();
    </script>
</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Data-Wise\.github\.io\/doe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>