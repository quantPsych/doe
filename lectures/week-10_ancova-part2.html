<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Davood Tofighi, Ph.D.">

<title>ANCOVA: Statistical Analysis of Covariance – STAT 454/545 - Analysis of Variance and Experimental Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4f17641596142cbde708c01b3a465e62.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-68b729f92b170261f1b1556cc4834a67.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Montserrat:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="ANCOVA: Statistical Analysis of Covariance – STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:description" content="Analysis of Variance and Experimental Design">
<meta property="og:image" content="https://Data-Wise.github.io/doe/lectures/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="STAT 454/545 - Analysis of Variance and Experimental Design">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 545</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/syllabus-final.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_lectures.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_help.html"> 
<span class="menu-text">R Help</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_appendix.html"> 
<span class="menu-text">Appendix</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contents.html"> 
<span class="menu-text">Contents</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">ANCOVA: Statistical Analysis of Covariance</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ANCOVA: Statistical Analysis of Covariance</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://Data-Wise.github.io/doe">Davood Tofighi, Ph.D.</a> <a href="mailto:dtofighi@unm.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-8523-7776" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Mathematics and Statistics, University of New Mexico
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">04-Apr-2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus-final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R Code and Datasets</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r_help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Help</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r-code-data-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Code and Datasets from the Book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data-files-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets from the Book</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#packages-used" id="toc-packages-used" class="nav-link" data-scroll-target="#packages-used">Packages Used</a></li>
  </ul></li>
  <li><a href="#theoretical-foundations" id="toc-theoretical-foundations" class="nav-link" data-scroll-target="#theoretical-foundations">Theoretical Foundations</a>
  <ul class="collapse">
  <li><a href="#why-ancova" id="toc-why-ancova" class="nav-link" data-scroll-target="#why-ancova">Why ANCOVA?</a></li>
  <li><a href="#the-ancova-model-centered-form-of-the-model" id="toc-the-ancova-model-centered-form-of-the-model" class="nav-link" data-scroll-target="#the-ancova-model-centered-form-of-the-model">The ANCOVA Model: Centered Form of the Model</a></li>
  <li><a href="#adjusted-treatment-means" id="toc-adjusted-treatment-means" class="nav-link" data-scroll-target="#adjusted-treatment-means">Adjusted Treatment Means</a></li>
  <li><a href="#why-adjustment-is-necessary" id="toc-why-adjustment-is-necessary" class="nav-link" data-scroll-target="#why-adjustment-is-necessary">Why Adjustment is Necessary</a></li>
  <li><a href="#parameter-estimation-via-least-squares" id="toc-parameter-estimation-via-least-squares" class="nav-link" data-scroll-target="#parameter-estimation-via-least-squares">Parameter Estimation via Least Squares</a></li>
  <li><a href="#partitioning-of-variation" id="toc-partitioning-of-variation" class="nav-link" data-scroll-target="#partitioning-of-variation">Partitioning of Variation</a></li>
  <li><a href="#ancova-table" id="toc-ancova-table" class="nav-link" data-scroll-target="#ancova-table">ANCOVA Table</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a></li>
  <li><a href="#example-balloon-experiment" id="toc-example-balloon-experiment" class="nav-link" data-scroll-target="#example-balloon-experiment">Example: Balloon Experiment</a></li>
  </ul></li>
  <li><a href="#adjusted-means" id="toc-adjusted-means" class="nav-link" data-scroll-target="#adjusted-means">Adjusted Means</a>
  <ul class="collapse">
  <li><a href="#explanation-adjusted-vs.-unadjusted-means-in-ancova" id="toc-explanation-adjusted-vs.-unadjusted-means-in-ancova" class="nav-link" data-scroll-target="#explanation-adjusted-vs.-unadjusted-means-in-ancova">Explanation: Adjusted vs.&nbsp;Unadjusted Means in ANCOVA</a></li>
  <li><a href="#bias-in-unadjusted-means-fig.-9.2" id="toc-bias-in-unadjusted-means-fig.-9.2" class="nav-link" data-scroll-target="#bias-in-unadjusted-means-fig.-9.2">Bias in Unadjusted Means (Fig. 9.2)</a></li>
  <li><a href="#r-code-to-replicate-fig.-9.2-unadjusted-means" id="toc-r-code-to-replicate-fig.-9.2-unadjusted-means" class="nav-link" data-scroll-target="#r-code-to-replicate-fig.-9.2-unadjusted-means">R Code to Replicate Fig. 9.2 (Unadjusted Means)</a></li>
  <li><a href="#adjusted-means-1" id="toc-adjusted-means-1" class="nav-link" data-scroll-target="#adjusted-means-1">Adjusted Means</a></li>
  <li><a href="#adjusted-means-plot" id="toc-adjusted-means-plot" class="nav-link" data-scroll-target="#adjusted-means-plot">Adjusted Means Plot</a></li>
  <li><a href="#comparison-of-plots" id="toc-comparison-of-plots" class="nav-link" data-scroll-target="#comparison-of-plots">Comparison of Plots</a>
  <ul class="collapse">
  <li><a href="#key-insight" id="toc-key-insight" class="nav-link" data-scroll-target="#key-insight">Key Insight</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#assumptions-of-ancova" id="toc-assumptions-of-ancova" class="nav-link" data-scroll-target="#assumptions-of-ancova">Assumptions of ANCOVA</a>
  <ul class="collapse">
  <li><a href="#checking-model-assumptions" id="toc-checking-model-assumptions" class="nav-link" data-scroll-target="#checking-model-assumptions">Checking Model Assumptions</a></li>
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity">1. Linearity</a></li>
  <li><a href="#homogeneity-of-regression-slopes" id="toc-homogeneity-of-regression-slopes" class="nav-link" data-scroll-target="#homogeneity-of-regression-slopes">2. Homogeneity of Regression Slopes</a></li>
  <li><a href="#homogeneity-check-statistical" id="toc-homogeneity-check-statistical" class="nav-link" data-scroll-target="#homogeneity-check-statistical">Homogeneity Check (Statistical)</a></li>
  <li><a href="#alternative-check-using-car-package" id="toc-alternative-check-using-car-package" class="nav-link" data-scroll-target="#alternative-check-using-car-package">Alternative Check (Using <code>car</code> package)</a></li>
  <li><a href="#independence-of-covariate-and-treatment" id="toc-independence-of-covariate-and-treatment" class="nav-link" data-scroll-target="#independence-of-covariate-and-treatment">3. Independence of Covariate and Treatment</a></li>
  <li><a href="#normality-of-residuals" id="toc-normality-of-residuals" class="nav-link" data-scroll-target="#normality-of-residuals">4. Normality of Residuals</a></li>
  <li><a href="#homoscedasticity-equal-variances" id="toc-homoscedasticity-equal-variances" class="nav-link" data-scroll-target="#homoscedasticity-equal-variances">5. Homoscedasticity (Equal Variances)</a></li>
  <li><a href="#summary-table" id="toc-summary-table" class="nav-link" data-scroll-target="#summary-table">Summary Table</a></li>
  <li><a href="#treatment-contrasts-and-confidence-intervals" id="toc-treatment-contrasts-and-confidence-intervals" class="nav-link" data-scroll-target="#treatment-contrasts-and-confidence-intervals">7. Treatment Contrasts and Confidence Intervals</a></li>
  </ul></li>
  <li><a href="#multiple-comparisons" id="toc-multiple-comparisons" class="nav-link" data-scroll-target="#multiple-comparisons">Multiple Comparisons</a>
  <ul class="collapse">
  <li><a href="#pairwise-comparisons-of-adjusted-means" id="toc-pairwise-comparisons-of-adjusted-means" class="nav-link" data-scroll-target="#pairwise-comparisons-of-adjusted-means">Pairwise Comparisons of Adjusted Means</a>
  <ul class="collapse">
  <li><a href="#contrast-formula" id="toc-contrast-formula" class="nav-link" data-scroll-target="#contrast-formula"><strong>Contrast Formula</strong></a></li>
  <li><a href="#variance-calculation" id="toc-variance-calculation" class="nav-link" data-scroll-target="#variance-calculation"><strong>Variance Calculation</strong></a></li>
  <li><a href="#confidence-interval-calculation" id="toc-confidence-interval-calculation" class="nav-link" data-scroll-target="#confidence-interval-calculation"><strong>Confidence Interval Calculation</strong></a></li>
  </ul></li>
  <li><a href="#pairwise-comparisons-of-adjusted-means-using-scheffés-method" id="toc-pairwise-comparisons-of-adjusted-means-using-scheffés-method" class="nav-link" data-scroll-target="#pairwise-comparisons-of-adjusted-means-using-scheffés-method">Pairwise Comparisons of Adjusted Means using Scheffé’s Method</a></li>
  <li><a href="#plotting-pairwise-comparisons" id="toc-plotting-pairwise-comparisons" class="nav-link" data-scroll-target="#plotting-pairwise-comparisons">Plotting Pairwise Comparisons</a></li>
  </ul></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model Diagnostics</a>
  <ul class="collapse">
  <li><a href="#residual-analysis-using-r-base-plot" id="toc-residual-analysis-using-r-base-plot" class="nav-link" data-scroll-target="#residual-analysis-using-r-base-plot">Residual Analysis using R base plot</a></li>
  <li><a href="#residual-analysis-using-car-package" id="toc-residual-analysis-using-car-package" class="nav-link" data-scroll-target="#residual-analysis-using-car-package">Residual Analysis using <code>car</code> package</a></li>
  <li><a href="#diagnostics-using-performance-package" id="toc-diagnostics-using-performance-package" class="nav-link" data-scroll-target="#diagnostics-using-performance-package">Diagnostics using <code>performance</code> package</a></li>
  </ul></li>
  <li><a href="#extensions-to-unbalanced-data" id="toc-extensions-to-unbalanced-data" class="nav-link" data-scroll-target="#extensions-to-unbalanced-data">Extensions to Unbalanced Data</a>
  <ul class="collapse">
  <li><a href="#handling-unbalanced-data-in-r" id="toc-handling-unbalanced-data-in-r" class="nav-link" data-scroll-target="#handling-unbalanced-data-in-r">Handling Unbalanced Data in R</a></li>
  </ul></li>
  <li><a href="#multiple-covariates" id="toc-multiple-covariates" class="nav-link" data-scroll-target="#multiple-covariates">Multiple Covariates</a>
  <ul class="collapse">
  <li><a href="#model-with-multiple-covariates" id="toc-model-with-multiple-covariates" class="nav-link" data-scroll-target="#model-with-multiple-covariates">Model with Multiple Covariates</a></li>
  <li><a href="#nonlinear-relationships" id="toc-nonlinear-relationships" class="nav-link" data-scroll-target="#nonlinear-relationships">Nonlinear Relationships</a>
  <ul class="collapse">
  <li><a href="#model-with-polynomial-terms" id="toc-model-with-polynomial-terms" class="nav-link" data-scroll-target="#model-with-polynomial-terms">Model with Polynomial Terms</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendix-advanced-mathematical-derivations" id="toc-appendix-advanced-mathematical-derivations" class="nav-link" data-scroll-target="#appendix-advanced-mathematical-derivations">Appendix: Advanced Mathematical Derivations</a>
  <ul class="collapse">
  <li><a href="#adjusted-treatment-means-1" id="toc-adjusted-treatment-means-1" class="nav-link" data-scroll-target="#adjusted-treatment-means-1">Adjusted Treatment Means</a></li>
  <li><a href="#f-test-for-homogeneity-of-slopes" id="toc-f-test-for-homogeneity-of-slopes" class="nav-link" data-scroll-target="#f-test-for-homogeneity-of-slopes">F-Test for Homogeneity of Slopes</a></li>
  <li><a href="#confidence-intervals-for-higher-order-contrasts" id="toc-confidence-intervals-for-higher-order-contrasts" class="nav-link" data-scroll-target="#confidence-intervals-for-higher-order-contrasts">Confidence Intervals for Higher-Order Contrasts</a>
  <ul class="collapse">
  <li><a href="#formula" id="toc-formula" class="nav-link" data-scroll-target="#formula">Formula</a></li>
  <li><a href="#steps-in-r" id="toc-steps-in-r" class="nav-link" data-scroll-target="#steps-in-r">Steps in R</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<p>In statistical analysis, <em>Analysis of Covariance (ANCOVA)</em> serves as a powerful tool that combines the principles of <strong>ANOVA</strong> (Analysis of Variance) and <strong>regression</strong>. ANCOVA allows researchers to adjust the response variable for one or more <strong>covariates</strong> (also known as nuisance variables) that are related to the response but are not influenced by the treatments. This adjustment enhances the precision of treatment effect estimates and controls for potential confounding factors.</p>
<p><strong>Intuition:</strong> Imagine you are a teacher assessing the effectiveness of different teaching methods (treatments) on students’ final exam scores (response). However, students come with varying levels of prior knowledge (covariate). By using ANCOVA, you can adjust the final scores based on their initial knowledge, providing a clearer picture of how each teaching method truly affects performance.</p>
<p>This lecture delves into the theoretical foundations, assumptions, and applications of ANCOVA. We will explore practical implementations using R, ensuring a balance between theoretical depth and applied understanding. References to classical texts will support and deepen the content, providing a rigorous academic framework.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li><strong>Understand</strong> the purpose and application of ANCOVA.</li>
<li><strong>Explore</strong> the mathematical model and assumptions underlying ANCOVA.</li>
<li><strong>Learn</strong> methods to test and interpret treatment effects adjusted for covariates.</li>
<li><strong>Use</strong> R to perform ANCOVA and evaluate its assumptions.</li>
<li><strong>Extend</strong> the model to unbalanced data and multiple covariates.</li>
<li><strong>Reinforce</strong> concepts with exercises covering numerical examples, conceptual understanding, and mathematical proofs.</li>
<li><strong>Explore</strong> advanced mathematical derivations and proofs in the Appendix.</li>
</ol>
</section>
<section id="packages-used" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="packages-used">Packages Used</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    car, <span class="co"># Companion to Applied Regression</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    emmeans, <span class="co"># Estimated Marginal Means</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    lmtest, <span class="co"># Tests for Linear Models</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    ggplot2, <span class="co"># Data visualization</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    dplyr, <span class="co"># Data manipulation</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    ggpubr, <span class="co"># Publication-ready plots</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    easystats, <span class="co"># Easy statistical analysis</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    here <span class="co"># File path management</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme for ggplot2</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(see<span class="sc">::</span><span class="fu">theme_modern</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the balloon data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>balloon_df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"dean2017"</span>, <span class="st">"balloon.txt"</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data: center the covariate and convert treatment to factor</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>balloon_df <span class="ot">&lt;-</span> balloon_df <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">Order_c =</span> Order <span class="sc">-</span> <span class="fu">mean</span>(Order), <span class="co"># Center the covariate</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">fColor =</span> <span class="fu">factor</span>(Color, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pink"</span>, <span class="st">"yellow"</span>, <span class="st">"orange"</span>, <span class="st">"blue"</span>)) <span class="co"># Convert treatment to factor</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the dataset</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(balloon_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-load-data" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-load-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Order</th>
<th style="text-align: right;">Color</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">Order_c</th>
<th style="text-align: left;">fColor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.0</td>
<td style="text-align: right;">-15.5</td>
<td style="text-align: left;">pink</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">24.6</td>
<td style="text-align: right;">-14.5</td>
<td style="text-align: left;">orange</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.3</td>
<td style="text-align: right;">-13.5</td>
<td style="text-align: left;">pink</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">19.8</td>
<td style="text-align: right;">-12.5</td>
<td style="text-align: left;">blue</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">24.3</td>
<td style="text-align: right;">-11.5</td>
<td style="text-align: left;">orange</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">22.2</td>
<td style="text-align: right;">-10.5</td>
<td style="text-align: left;">yellow</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-load-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Balloon Inflation Times
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="theoretical-foundations" class="level1 page-columns page-full">
<h1>Theoretical Foundations</h1>
<section id="why-ancova" class="level2">
<h2 class="anchored" data-anchor-id="why-ancova">Why ANCOVA?</h2>
<p>ANCOVA addresses several key scenarios in experimental and observational studies:</p>
<ul>
<li><strong>Adjusting for Covariates:</strong> It accounts for variability due to covariates, improving the precision of estimating treatment effects.</li>
<li><strong>Controlling for Confounding Variables:</strong> By adjusting for variables related to the response but not influenced by treatments, ANCOVA enhances causal interpretations.</li>
<li><strong>Increasing Statistical Power:</strong> Reducing error variance by accounting for covariates can lead to more powerful tests of treatment effects.</li>
</ul>
<p><strong>Example:</strong> Consider comparing the effects of three different fertilizers (A, B, C) on crop yield. Soil quality before treatment is a covariate that affects yield but is not influenced by the fertilizer used. ANCOVA can adjust yield differences based on initial soil quality, providing a clearer assessment of fertilizer effectiveness.</p>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017) discuss the integration of covariates in experimental designs, highlighting the benefits of ANCOVA in <em>Design and Analysis of Experiments</em>.</p>
</section>
<section id="the-ancova-model-centered-form-of-the-model" class="level2">
<h2 class="anchored" data-anchor-id="the-ancova-model-centered-form-of-the-model">The ANCOVA Model: Centered Form of the Model</h2>
<p>For <span class="math inline">\(v\)</span> treatments and <span class="math inline">\(n\)</span> total observations, the ANCOVA model is defined as:</p>
<p><span id="eq-ancova-model"><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta (X_{ij} - \bar{X}_{\cdot\cdot}) + \epsilon_{ij},
\qquad(1)\]</span></span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(Y_{ij}\)</span>: Response variable for the <span class="math inline">\(j\)</span>-th unit under treatment <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(X_{ij}\)</span>: Covariate value for the <span class="math inline">\(j\)</span>-th unit under treatment <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(\bar{X}_{\cdot\cdot}\)</span>: Overall mean of the covariate.</p></li>
<li><p><span class="math inline">\(\epsilon_{ij} \sim N(0, \sigma^2)\)</span>: Error term.</p></li>
<li><p><strong><span class="math inline">\(\mu\)</span> (overall mean)</strong>: This is the <em>grand mean</em> of the response variable when the covariate <span class="math inline">\(X_{ij}\)</span> is at its overall mean <span class="math inline">\(\bar{X}_{\cdot\cdot}\)</span>.</p></li>
<li><p><strong><span class="math inline">\(\tau_i\)</span> (treatment effect)</strong>: This represents the deviation of the <span class="math inline">\(i\)</span>-th treatment from the overall mean <strong>adjusted for the covariate</strong>. That is, it estimates the effect of treatment <span class="math inline">\(i\)</span> at the covariate value <span class="math inline">\(\bar{X}_{\cdot\cdot}\)</span>. These are not raw group means; they are <strong>adjusted treatment means</strong>.</p></li>
<li><p><strong><span class="math inline">\(\beta\)</span> (regression coefficient)</strong>: This is the common slope that quantifies the effect of the covariate <span class="math inline">\(X_{ij}\)</span> on the response <span class="math inline">\(Y_{ij}\)</span>, assumed constant across treatments.</p></li>
</ul>
<p><strong>Intuition:</strong> Centering the covariate reduces multicollinearity between the intercept and the covariate, enhancing the interpretability of the model parameters.</p>
</section>
<section id="adjusted-treatment-means" class="level2">
<h2 class="anchored" data-anchor-id="adjusted-treatment-means">Adjusted Treatment Means</h2>
<p>The adjusted mean for treatment <span class="math inline">\(i\)</span> is given by:</p>
<p><span id="eq-adjusted-treatment-mean"><span class="math display">\[
\mu_{i}^\text{adj} = \mu + \tau_i = \bar{Y}_{i \cdot} - \beta (\bar{X}_{i \cdot} - \bar{X}_{\cdot\cdot}),
\qquad(2)\]</span></span></p>
<p><span class="math display">\[
\tau_i = \bar{Y}_{i \cdot} - \mu - \beta (\bar{X}_{i \cdot} - \bar{X}_{\cdot\cdot}),
\]</span></p>
<p><strong>Derivation:</strong></p>
<ol type="1">
<li><strong>Model Equation:</strong></li>
</ol>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta (X_{ij} - \bar{X}_{\cdot\cdot}) + \epsilon_{ij}
\]</span></p>
<ol start="2" type="1">
<li><strong>Taking the Mean for Treatment <span class="math inline">\(i\)</span>:</strong></li>
</ol>
<p><span class="math display">\[
\bar{Y}_{i\cdot} = \mu + \tau_i + \beta (\bar{X}_{i \cdot} - \bar{X}_{\cdot\cdot}) + \bar{\epsilon}_i
\]</span></p>
<p>Since <span class="math inline">\(\bar{\epsilon}_i = 0\)</span> (assuming errors have mean zero),</p>
<p><span class="math display">\[
\bar{Y}_{i\cdot} = \mu + \tau_i + \beta (\bar{X}_{i \cdot}  - \bar{X}_{\cdot\cdot})
\]</span></p>
<ol start="3" type="1">
<li><strong>Solving for Adjusted Mean:</strong></li>
</ol>
<p><span class="math display">\[
\mu + \tau_i = \bar{Y}_{i \cdot} - \beta (\bar{X}_{i \cdot}  - \bar{X}_{\cdot\cdot})
\]</span></p>
<p>This equation represents the adjusted treatment mean, accounting for differences in the covariate.</p>
</section>
<section id="why-adjustment-is-necessary" class="level2">
<h2 class="anchored" data-anchor-id="why-adjustment-is-necessary">Why Adjustment is Necessary</h2>
<p>If the covariate differs across treatment groups (i.e., <span class="math inline">\(\bar{X}_{i\cdot} \ne \bar{X}_{\cdot\cdot}\)</span>), then the unadjusted means <span class="math inline">\(\bar{Y}_{i\cdot}\)</span> reflect not only the treatment effects but also differences in the covariate distributions. To isolate the treatment effect, we use:</p>
<p><span class="math display">\[
\hat{\mu} + \hat{\tau}_i = \bar{Y}_{i\cdot} - \hat{\beta}(\bar{X}_{i\cdot} - \bar{X}_{\cdot\cdot}),
\]</span></p>
<p>which adjusts each treatment mean to the same covariate level, thus removing confounding due to the covariate.</p>
</section>
<section id="parameter-estimation-via-least-squares" class="level2">
<h2 class="anchored" data-anchor-id="parameter-estimation-via-least-squares">Parameter Estimation via Least Squares</h2>
<p>The estimation of model parameters (<span class="math inline">\(\tau_i\)</span> and <span class="math inline">\(\beta\)</span>) typically employs the Least Squares estimation approach:</p>
<ul>
<li>The estimation of the covariate slope coefficient is expressed as:</li>
</ul>
<p><span id="eq-slope-estimate"><span class="math display">\[
\hat{\beta} = \frac{S_{xy}}{S_{xx}}
\qquad(3)\]</span></span></p>
<p>where:</p>
<p><span id="eq-sp_xy"><span class="math display">\[
SP_{xy} = \sum_{i=1}^{a}\sum_{j=1}^{n_i}(x_{ij} - \bar{x}_{i.})(y_{ij} - \bar{y}_{i.})
\qquad(4)\]</span></span></p>
<p>and</p>
<p><span id="eq-ss_xx"><span class="math display">\[
SS_{xx} = \sum_{i=1}^{a}\sum_{j=1}^{n_i}(x_{ij} - \bar{x}_{i.})^2
\qquad(5)\]</span></span></p>
</section>
<section id="partitioning-of-variation" class="level2">
<h2 class="anchored" data-anchor-id="partitioning-of-variation">Partitioning of Variation</h2>
<p>ANCOVA decomposes the total observed variability into components associated with treatments, covariates, and residual errors:</p>
<ul>
<li>Total Sum of Squares (SS Total):</li>
</ul>
<p><span class="math display">\[
SS_\text{Total} = \sum_{i=1}^{a}\sum_{j=1}^{n_i}(y_{ij} - \bar{y}_{..})^2
\]</span></p>
<ul>
<li>Treatment Sum of Squares adjusted for covariates (SS Treatment):</li>
</ul>
<p><span class="math display">\[
SS_{\text{Treatment}|x} = \sum_{i=1}^{a}n_i(\hat{\mu}_i^{adj} - \bar{y}_{..})^2
\]</span></p>
<ul>
<li>Covariate Sum of Squares (SS Covariate):</li>
</ul>
<p><span class="math display">\[
SS_\text{Covariate} = \hat{\beta}^2 SS_{xx}
\]</span></p>
<ul>
<li>Residual Sum of Squares (SS Error):</li>
</ul>
<p><span class="math display">\[
SS_\text{Error} = SS_\text{Total} - SS_{\text{Treatment}|x} - SS_\text{Covariate}
\]</span></p>
</section>
<section id="ancova-table" class="level2">
<h2 class="anchored" data-anchor-id="ancova-table">ANCOVA Table</h2>
<table class="table">
<colgroup>
<col style="width: 23%">
<col style="width: 13%">
<col style="width: 25%">
<col style="width: 24%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>df</th>
<th>Sum of Squares</th>
<th>Mean Square</th>
<th>F-Statistic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment (<span class="math inline">\(\tau\)</span>)</td>
<td><span class="math inline">\(a - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Treatment}\mid x}\)</span></td>
<td><span class="math inline">\(\frac{SS_{\text{Treatment}\mid x}}{a-1}\)</span></td>
<td><span class="math inline">\(\frac{MS_{\text{Treatment}\mid x}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="even">
<td>Covariate (<span class="math inline">\(x\)</span>)</td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(SS_\text{Covariate}\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\(N - a - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Error}\)</span></td>
<td><span class="math inline">\(\frac{SS_E}{N-a-1}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>Total</td>
<td><span class="math inline">\(N - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Total}\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>The ANCOVA F-test evaluates the statistical significance of treatment effects after adjusting for the covariate.</p>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h2>
<p><strong>Objective</strong>: Test the null hypothesis using the F-statistic.</p>
<p><span class="math display">\[
H_0: \tau_1 = \tau_2 = \cdots = \tau_a = 0
\]</span></p>
<p><span class="math display">\[
H_a: \text{At least one } \tau_i \text{ is different from the others}
\]</span></p>
<p><strong>Test Statistic</strong>: <span class="math display">\[
F = \frac{MS_{\text{Treatment}\mid x}}{MS_\text{Error}} \sim F_{a-1, N-a-1}
\]</span></p>
<p><strong>Decision Rule</strong>: Reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(F &gt; F_{\alpha; a-1, N-a-1}\)</span>, where <span class="math inline">\(\alpha\)</span> is the significance level. <strong>Interpretation</strong>: A significant F-statistic indicates that at least one treatment mean is different after adjusting for the covariate.</p>
</section>
<section id="example-balloon-experiment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="example-balloon-experiment">Example: Balloon Experiment</h2>
<ul>
<li><strong>Balloon Experiment Example</strong> (32 observations, 4 treatments):</li>
</ul>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>balloon_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    Time <span class="sc">~</span> fColor <span class="sc">+</span> Order_c,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> balloon_df,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fColor =</span> <span class="st">"contr.sum"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(balloon_fit, <span class="at">type =</span> <span class="st">"III"</span>) <span class="co"># Type III SS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-balloon-experiment" class="cell-output-display quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-balloon-experiment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">13113.9013</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1948.228767</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">fColor</td>
<td style="text-align: right;">127.6788</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6.322745</td>
<td style="text-align: right;">0.0021746</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Order_c</td>
<td style="text-align: right;">120.8353</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17.951550</td>
<td style="text-align: right;">0.0002358</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">181.7422</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-balloon-experiment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Balloon Experiment: Inflation Times by Color
</figcaption>
</figure>
</div>
</div>
<ul>
<li><span class="math inline">\(F = 6.32 &gt; F_{0.01; 3,27} \approx 4.57\)</span>, reject <span class="math inline">\(H_0\)</span> at <span class="math inline">\(\alpha = 0.01\)</span>.</li>
<li>Conclusion: Balloon colors significantly affect inflation time after adjusting for time order.</li>
</ul>
<p><strong>Rationale</strong>: The table partitions variability into treatment and error components, with the F-ratio indicating significance. Adjusted means (from Figure 9.2) visualize these effects.</p>
</section>
</section>
<section id="adjusted-means" class="level1 page-columns page-full">
<h1>Adjusted Means</h1>
<section id="explanation-adjusted-vs.-unadjusted-means-in-ancova" class="level2">
<h2 class="anchored" data-anchor-id="explanation-adjusted-vs.-unadjusted-means-in-ancova">Explanation: Adjusted vs.&nbsp;Unadjusted Means in ANCOVA</h2>
<p>In ANCOVA, <strong>unadjusted means</strong> are simple group averages of the response variable <span class="math inline">\(Y\)</span> , ignoring the covariate <span class="math inline">\(X\)</span> . These can be biased if <span class="math inline">\(X\)</span> is associated with both the treatment and the outcome. <strong>Adjusted means</strong> account for the covariate by estimating the group means at a common value of <span class="math inline">\(X\)</span> (e.g., the grand mean <span class="math inline">\(\bar{X}_{\cdot\cdot}\)</span> ), removing confounding effects.</p>
</section>
<section id="bias-in-unadjusted-means-fig.-9.2" class="level2">
<h2 class="anchored" data-anchor-id="bias-in-unadjusted-means-fig.-9.2">Bias in Unadjusted Means (Fig. 9.2)</h2>
<ul>
<li><strong>Scenario</strong>: Suppose two groups ( <span class="math inline">\(i=1, 2\)</span> ) have different covariate distributions (e.g., Group 1 has lower <span class="math inline">\(X\)</span> , Group 2 has higher <span class="math inline">\(X\)</span> ).</li>
<li><strong>Issue</strong>: If <span class="math inline">\(Y\)</span> increases with <span class="math inline">\(X\)</span> , comparing unadjusted means <span class="math inline">\(\bar{Y}_1\)</span> and <span class="math inline">\(\bar{Y}_2\)</span> (horizontal lines) ignores the covariate effect, leading to biased treatment comparisons.</li>
<li><strong>Solution</strong>: Adjust means by modeling the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> within each group.</li>
</ul>
</section>
<section id="r-code-to-replicate-fig.-9.2-unadjusted-means" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="r-code-to-replicate-fig.-9.2-unadjusted-means">R Code to Replicate Fig. 9.2 (Unadjusted Means)</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (unadj_means &lt;- aggregate(Time ~ fColor, data = balloon_df, mean))</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>means_df <span class="ot">&lt;-</span> balloon_df <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(fColor) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">Time =</span> <span class="fu">mean</span>(Time),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">Order_c =</span> <span class="fu">mean</span>(Order_c)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>means_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-unadjusted-means" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-unadjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">fColor</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">Order_c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pink</td>
<td style="text-align: right;">18.3375</td>
<td style="text-align: right;">-0.250</td>
</tr>
<tr class="even">
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">22.5750</td>
<td style="text-align: right;">-0.875</td>
</tr>
<tr class="odd">
<td style="text-align: left;">orange</td>
<td style="text-align: right;">21.8750</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">blue</td>
<td style="text-align: right;">18.1875</td>
<td style="text-align: right;">0.125</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-unadjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Unadjusted Means (Biased Comparison)
</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(balloon_df, <span class="fu">aes</span>(<span class="at">x =</span> Order_c, <span class="at">y =</span> Time, <span class="at">color =</span> fColor)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="fu">aes</span>(<span class="at">shape =</span> fColor)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> <span class="st">"y~x"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> <span class="co"># True relationship</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> means_df,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">yintercept =</span> Time, <span class="at">color =</span> fColor),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">xintercept =</span> <span class="fu">mean</span>(balloon_df<span class="sc">$</span>Order_c),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">"dotted"</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> <span class="co"># Reference line for adjustment</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">seq</span>(<span class="fu">min</span>(balloon_df<span class="sc">$</span>Time), <span class="fu">max</span>(balloon_df<span class="sc">$</span>Time), <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>            means_df<span class="sc">$</span>Time</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">nsmall =</span> <span class="dv">1</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Unadjusted Means (Biased Comparison)"</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Time (centered)"</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Time"</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-unadjusted-means" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-unadjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-unadjusted-means-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;2: Unadjusted Means (Biased Comparison)"><img src="week-10_ancova-part2_files/figure-html/fig-unadjusted-means-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-unadjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Unadjusted Means (Biased Comparison)
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="adjusted-means-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="adjusted-means-1">Adjusted Means</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>means_df <span class="ot">&lt;-</span> means_df <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Time_adj =</span> Time <span class="sc">-</span> <span class="fu">coef</span>(balloon_fit)[<span class="st">"Order_c"</span>] <span class="sc">*</span> Order_c) <span class="co"># Adjusted means</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>means_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-adjusted-means" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-adjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">fColor</th>
<th style="text-align: right;">Time</th>
<th style="text-align: right;">Order_c</th>
<th style="text-align: right;">Time_adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pink</td>
<td style="text-align: right;">18.3375</td>
<td style="text-align: right;">-0.250</td>
<td style="text-align: right;">18.28474</td>
</tr>
<tr class="even">
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">22.5750</td>
<td style="text-align: right;">-0.875</td>
<td style="text-align: right;">22.39035</td>
</tr>
<tr class="odd">
<td style="text-align: left;">orange</td>
<td style="text-align: right;">21.8750</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">22.08603</td>
</tr>
<tr class="even">
<td style="text-align: left;">blue</td>
<td style="text-align: right;">18.1875</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">18.21388</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-adjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Adjusted Means (Unbiased Comparison)
</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The column <code>Time_adj</code> in the table above represents the adjusted means for each treatment group, accounting for the covariate (Order_c). These adjusted means provide a clearer picture of the treatment effects by removing the influence of the covariate. The column <code>Time</code> represents the unadjusted means, which may be biased due to the covariate’s influence.</p>
</div>
</div>
<div id="tbl-adjusted-means-2" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-adjusted-means-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(balloon_fit, <span class="sc">~</span>fColor)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>emm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> fColor emmean    SE df lower.CL upper.CL
 pink     18.3 0.917 27     16.4     20.2
 yellow   22.4 0.918 27     20.5     24.3
 orange   22.1 0.919 27     20.2     24.0
 blue     18.2 0.917 27     16.3     20.1

Confidence level used: 0.95 </code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-adjusted-means-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Adjusted Means using <code>emmeans</code> package
</figcaption>
</figure>
</div>
<p>The code above uses the <a href="../appendix/r-packages/emmeans-v1.html"><code>emmeans</code></a> package to compute estimated marginal means (EMMs) for the treatment groups. EMMs are adjusted means that account for the covariate, providing a more accurate representation of treatment effects.</p>
</section>
<section id="adjusted-means-plot" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="adjusted-means-plot">Adjusted Means Plot</h2>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(balloon_df, <span class="fu">aes</span>(<span class="at">x =</span> Order_c, <span class="at">y =</span> Time, <span class="at">color =</span> fColor)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="co"># Regression lines</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> means_df,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">yintercept =</span> Time_adj, <span class="at">color =</span> fColor),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> <span class="co"># Reference line for adjustment</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Adjusted Means"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Time (centered)"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Time"</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">seq</span>(<span class="fu">min</span>(balloon_df<span class="sc">$</span>Time), <span class="fu">max</span>(balloon_df<span class="sc">$</span>Time), <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>            means_df<span class="sc">$</span>Time_adj</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">nsmall =</span> <span class="dv">1</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-adjusted-means" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-adjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-adjusted-means-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;3: Adjusted Means (Unbiased Comparison)"><img src="week-10_ancova-part2_files/figure-html/fig-adjusted-means-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-adjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Adjusted Means (Unbiased Comparison)
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="comparison-of-plots" class="level2">
<h2 class="anchored" data-anchor-id="comparison-of-plots">Comparison of Plots</h2>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Aspect</strong></th>
<th><strong>Unadjusted Plot</strong></th>
<th><strong>Adjusted Plot</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Means</strong></td>
<td>Horizontal lines at <span class="math inline">\(\bar{Y}_i\)</span></td>
<td>Horizontal lines at <span class="math inline">\(Y_i\)</span> adjusted to <span class="math inline">\(\bar{X}_{\cdot\cdot}\)</span></td>
</tr>
<tr class="even">
<td><strong>Bias</strong></td>
<td>Biased if <span class="math inline">\(X\)</span> differs between groups</td>
<td>Unbiased by accounting for <span class="math inline">\(X\)</span></td>
</tr>
<tr class="odd">
<td><strong>Interpretation</strong></td>
<td>Misleading treatment effect due to <span class="math inline">\(X\)</span></td>
<td>True treatment effect isolated from <span class="math inline">\(X\)</span></td>
</tr>
<tr class="even">
<td><strong>Reference Line</strong></td>
<td>None</td>
<td>Dotted line at <span class="math inline">\(\bar{X}_{\cdot\cdot}\)</span></td>
</tr>
</tbody>
</table>
<section id="key-insight" class="level3">
<h3 class="anchored" data-anchor-id="key-insight">Key Insight</h3>
<ul>
<li>In the <strong>unadjusted plot</strong>, Group 2’s higher mean <span class="math inline">\(Y\)</span> might be due to its higher <span class="math inline">\(X\)</span> values, not the treatment.</li>
<li>In the <strong>adjusted plot</strong>, both groups are compared at the same <span class="math inline">\(X\)</span> ( <span class="math inline">\(\bar{X}_{\cdot\cdot}\)</span> ), isolating the true treatment effect. The vertical dotted line emphasizes the adjustment point.</li>
</ul>
</section>
</section>
</section>
<section id="assumptions-of-ancova" class="level1 page-columns page-full">
<h1>Assumptions of ANCOVA</h1>
<p>For ANCOVA to yield valid and unbiased results, the following assumptions must hold. Each assumption ensures that the adjusted treatment comparisons are interpretable and statistically sound.</p>
<section id="checking-model-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="checking-model-assumptions">Checking Model Assumptions</h2>
<p><strong>Objective</strong>: Verify ANCOVA assumptions using diagnostics.</p>
<p><strong>Content</strong>:</p>
<ul>
<li><strong>Tools</strong>:
<ul>
<li><strong>Residual Plot</strong>: Plot residuals (<span class="math inline">\(y_{ij} - \hat{y}_{ij}\)</span>) vs.&nbsp;covariate or time order (e.g., Figure 9.3 for balloon experiment, residuals -2 to 2, time order 1 to 29).</li>
<li><strong>Tests</strong>: Interaction test for homogeneity of slopes.</li>
</ul></li>
<li><strong>Checks</strong>:
<ul>
<li>No patterns (linearity).</li>
<li>Constant spread (homoscedasticity).</li>
<li>Random scatter (independence).</li>
</ul></li>
</ul>
<p><strong>Rationale</strong>: Violations like non-linear trends or unequal slopes invalidate ANCOVA results. Residual plots ensure the model fits the data appropriately.</p>
</section>
<section id="linearity" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="linearity">1. Linearity</h2>
<p><strong>Definition:</strong><br>
The relationship between the response variable <span class="math inline">\(Y\)</span> and the covariate <span class="math inline">\(X\)</span> must be linear within each treatment group.</p>
<p><strong>Mathematically:</strong></p>
<p>For treatment <span class="math inline">\(i\)</span>, we assume: <span class="math display">\[
E[Y_{ij} \mid X_{ij}] = \mu + \tau_i + \beta X_{ij}
\]</span></p>
<p><strong>Linearity Check (Graphical):</strong></p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(balloon_df, <span class="fu">aes</span>(<span class="at">x =</span> Order, <span class="at">y =</span> Time, <span class="at">color =</span> fColor)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> fColor)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linearity Check: Response vs. Covariate by Treatment"</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"pink"</span>, <span class="st">"yellow"</span>, <span class="st">"orange"</span>, <span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-linearity-check" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-linearity-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-linearity-check-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;4: Linearity Check: Response vs.&nbsp;Covariate by Treatment"><img src="week-10_ancova-part2_files/figure-html/fig-linearity-check-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-linearity-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Linearity Check: Response vs.&nbsp;Covariate by Treatment
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong><br>
If the regression lines appear approximately straight within each group, the assumption is likely satisfied.</p>
</section>
<section id="homogeneity-of-regression-slopes" class="level2">
<h2 class="anchored" data-anchor-id="homogeneity-of-regression-slopes">2. Homogeneity of Regression Slopes</h2>
<p><strong>Definition:</strong><br>
The effect of the covariate (<span class="math inline">\(\beta\)</span>) is assumed to be the same across all treatment groups.</p>
<p><strong>Mathematically:</strong></p>
<p><span class="math display">\[
\text{Test } H_0: \beta_1 = \beta_2 = \cdots = \beta_v
\]</span></p>
<p>This is equivalent to testing for no interaction between treatment and covariate.</p>
</section>
<section id="homogeneity-check-statistical" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="homogeneity-check-statistical">Homogeneity Check (Statistical)</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model allowing interaction</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">*</span> Order_c, <span class="at">data =</span> balloon_df)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduced model assuming common slope</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>model_reduced <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">+</span> Order_c, <span class="at">data =</span> balloon_df)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_reduced, model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-homogeneity-slopes" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-homogeneity-slopes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Res.Df</th>
<th style="text-align: right;">RSS</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum of Sq</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">27</td>
<td style="text-align: right;">181.7422</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td style="text-align: right;">157.0320</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">24.71016</td>
<td style="text-align: right;">1.258859</td>
<td style="text-align: right;">0.3107502</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-homogeneity-slopes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Homogeneity of Slopes Check: Interaction Term
</figcaption>
</figure>
</div>
</div>
<ul>
<li>If the interaction term is <strong>not significant</strong>, the slopes are homogeneous, and the assumption holds.</li>
<li>A “significant” interaction term suggests that the slopes differ across treatments, indicating a violation of this assumption.</li>
</ul>
</section>
<section id="alternative-check-using-car-package" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="alternative-check-using-car-package">Alternative Check (Using <code>car</code> package)</h2>
<p>Or, using the <code>car</code> package to check the interaction term using Type III sumof squares:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA table for interaction</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(model_full, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-homogeneity-slopes-car" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-homogeneity-slopes-car-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">2678.34230</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">409.344637</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">fColor</td>
<td style="text-align: right;">119.54833</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6.090393</td>
<td style="text-align: right;">0.0031164</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Order_c</td>
<td style="text-align: right;">17.19483</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.627973</td>
<td style="text-align: right;">0.1180616</td>
</tr>
<tr class="even">
<td style="text-align: left;">fColor:Order_c</td>
<td style="text-align: right;">24.71016</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.258859</td>
<td style="text-align: right;">0.3107502</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">157.03202</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-homogeneity-slopes-car-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Homogeneity of Slopes Check: Interaction Term (car package)
</figcaption>
</figure>
</div>
</div>
<ul>
<li>If the interaction term (<code>fColor:Order_c</code>) is <strong>not “significant”</strong>, the slopes are homogeneous, and the assumption holds.</li>
<li>A “significant” interaction implies violation of this assumption and suggests separate slopes per group.</li>
</ul>
</section>
<section id="independence-of-covariate-and-treatment" class="level2">
<h2 class="anchored" data-anchor-id="independence-of-covariate-and-treatment">3. Independence of Covariate and Treatment</h2>
<p><strong>Definition:</strong><br>
The covariate should be independent of treatment assignment, i.e., covariate values should not systematically differ across treatment groups.</p>
<p>Random assignment of treatments is crucial to ensure this independence.</p>
<!-- 


::: {.cell output-location='slide'}

```{.r .cell-code}
# Boxplot of covariate by treatment
ggplot(balloon_df, aes(x = Color, y = Order_c, color = fColor)) +
    geom_point() +
    geom_boxplot(aes(fill = fColor), alpha = 0.5) +
    labs(title = "Covariate Distribution by Treatment")
```

::: {.cell-output-display}
![Independence Check: Covariate Distribution by Treatment](week-10_ancova-part2_files/figure-html/fig-independence-covariate-1.png){#fig-independence-covariate width=672}
:::
:::

::: {#tbl-independence-covariate .cell tbl-cap='ANOVA on Covariate by Treatment'}

```{.r .cell-code}
# One-way ANOVA on covariate
anova(lm(Order_c ~ fColor, data = balloon_df))
```

::: {.cell-output-display}
<div class="kable-table">

|          | Df|  Sum Sq|   Mean Sq|   F value|    Pr(>F)|
|:---------|--:|-------:|---------:|---------:|---------:|
|fColor    |  3|   14.75|  4.916667| 0.0507387| 0.9845807|
|Residuals | 28| 2713.25| 96.901786|        NA|        NA|

</div>
:::
:::



- If the boxplots are similar and the ANOVA is not significant, independence holds.
- Violations suggest potential confounding between treatment and covariate.
-->
</section>
<section id="normality-of-residuals" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="normality-of-residuals">4. Normality of Residuals</h2>
<p><strong>Definition:</strong><br>
Residuals from the model should follow a normal distribution.</p>
<p><strong>Diagnostic Check (Graphical &amp; Statistical):</strong></p>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plots</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model_reduced))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(model_reduced))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">resid</span>(model_reduced), <span class="at">breaks =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="st">"Histogram of Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-normality-check" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-normality-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-normality-check-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;5: Normality Check: Q-Q Plot and Histogram of Residuals"><img src="week-10_ancova-part2_files/figure-html/fig-normality-check-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-normality-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Normality Check: Q-Q Plot and Histogram of Residuals
</figcaption>
</figure>
</div>
</div>
</div>
<div id="tbl-normality-check" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-normality-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(model_reduced))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(model_reduced)
W = 0.96374, p-value = 0.3465</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-normality-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Shapiro-Wilk Test for Normality of Residuals
</figcaption>
</figure>
</div>
<ul>
<li>Q-Q plot should lie along the reference line.</li>
<li>Histogram should resemble a bell curve.</li>
<li>Shapiro-Wilk p-value &gt; 0.05 indicates normality.</li>
</ul>
</section>
<section id="homoscedasticity-equal-variances" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="homoscedasticity-equal-variances">5. Homoscedasticity (Equal Variances)</h2>
<p><strong>Definition:</strong><br>
The variance of residuals should be constant across levels of the covariate and treatments.</p>
<p><strong>Diagnostic Check (Graphical &amp; Statistical):</strong></p>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    model_reduced<span class="sc">$</span>fitted.values,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">resid</span>(model_reduced),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Homoscedasticity Check"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-homoscedasticity-check" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-homoscedasticity-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-homoscedasticity-check-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;6: Homoscedasticity Check: Residuals vs.&nbsp;Fitted Values"><img src="week-10_ancova-part2_files/figure-html/fig-homoscedasticity-check-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-homoscedasticity-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Homoscedasticity Check: Residuals vs.&nbsp;Fitted Values
</figcaption>
</figure>
</div>
</div>
</div>
<div id="tbl-homoscedasticity-check-bp" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-homoscedasticity-check-bp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Breusch-Pagan Test</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">bptest</span>(model_reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  model_reduced
BP = 3.9212, df = 4, p-value = 0.4168</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-homoscedasticity-check-bp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Breusch-Pagan Test for Homoscedasticity
</figcaption>
</figure>
</div>
<ul>
<li>Random scatter around zero with no funneling supports homoscedasticity.</li>
<li>Breusch-Pagan p-value &gt; 0.05 suggests equal variances.</li>
</ul>
</section>
<section id="summary-table" class="level2">
<h2 class="anchored" data-anchor-id="summary-table">Summary Table</h2>
<table class="table">
<colgroup>
<col style="width: 36%">
<col style="width: 34%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Check Method</th>
<th>R Code / Tool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linearity</td>
<td>Scatterplot with linear fit</td>
<td><code>ggplot2::geom_smooth()</code></td>
</tr>
<tr class="even">
<td>Homogeneity of slopes</td>
<td>Model comparison (F-test)</td>
<td><code>anova()</code> on interaction</td>
</tr>
<tr class="odd">
<td>Independence of covariate/treatment</td>
<td>Boxplot, ANOVA on covariate</td>
<td><code>lm()</code> and <code>anova()</code></td>
</tr>
<tr class="even">
<td>Normality of residuals</td>
<td>Q-Q plot, histogram, Shapiro test</td>
<td><code>qqnorm()</code>, <code>shapiro.test()</code></td>
</tr>
<tr class="odd">
<td>Homoscedasticity</td>
<td>Residuals plot, BP test</td>
<td><code>lmtest::bptest()</code></td>
</tr>
</tbody>
</table>
<p>Each assumption plays a critical role in ensuring valid inference from ANCOVA. Always assess assumptions before interpreting model results.</p>
<p><strong>Analogy:</strong> Think of ANCOVA as leveling the playing field. Just as a referee ensures that all players are subject to the same rules regardless of their backgrounds, ANCOVA adjusts the response variable based on covariates, ensuring that treatment comparisons are fair and unbiased.</p>
</section>
<section id="treatment-contrasts-and-confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="treatment-contrasts-and-confidence-intervals">7. Treatment Contrasts and Confidence Intervals</h2>
<p><strong>Objective</strong>: Make inferences about specific treatment differences.</p>
<ul>
<li><strong>Contrast</strong>: Linear combination <span class="math inline">\(\sum c_i \tau_i\)</span>, where <span class="math inline">\(\sum c_i = 0\)</span> (e.g., <span class="math inline">\(\tau_1 - \tau_2\)</span>).</li>
<li><strong>Estimator</strong>: <span class="math inline">\(\sum c_i \hat{\tau}_i = \sum c_i (\bar{y}_{i.} - \hat{\beta}_1 \bar{x}_{i.})\)</span>.</li>
<li><strong>Variance</strong>:</li>
</ul>
<p><span class="math display">\[
\text{Var}(\sum c_i \hat{\tau}_i) = \sigma^2 \left( \sum \frac{c_i^2}{n_i} + \frac{(\sum c_i \bar{x}_{i.})^2}{SS_{xx}} \right)
\]</span></p>
<p><span class="math display">\[
\widehat{\text{Var}(\sum c_i \hat{\tau}_i)} = MS_\text{Error} \left( \sum \frac{c_i^2}{n_i} + \frac{(\sum c_i \bar{x}_{i.})^2}{SS_{xx}} \right)
\]</span></p>
<ul>
<li><strong>Confidence Interval</strong>:</li>
</ul>
<p><span class="math display">\[
\sum c_i \tau_i \in \sum c_i \hat{\tau}_i \pm t_{\alpha/2; n-a-1} \sqrt{\widehat{\text{Var}(\sum c_i \hat{\tau}_i)}}
\]</span></p>
<!-- - **Balloon Experiment Data**: $\hat{\beta}_1 = -0.21105$, $MS_\text{Error} = 6.731$, $n_i = 8$. -->
<p><strong>Rationale</strong>: Confidence intervals pinpoint which treatment differences are significant, adjusted for the covariate, aiding targeted conclusions.</p>
</section>
</section>
<section id="multiple-comparisons" class="level1 page-columns page-full">
<h1>Multiple Comparisons</h1>
<section id="pairwise-comparisons-of-adjusted-means" class="level2">
<h2 class="anchored" data-anchor-id="pairwise-comparisons-of-adjusted-means">Pairwise Comparisons of Adjusted Means</h2>
<p><strong>Objective</strong>: Adjust for multiple tests to control error rates.</p>
<section id="contrast-formula" class="level3">
<h3 class="anchored" data-anchor-id="contrast-formula"><strong>Contrast Formula</strong></h3>
<p>For pairwise comparison <span class="math inline">\(\tau_i - \tau_j\)</span> (e.g., <span class="math inline">\(\tau_1 - \tau_3\)</span>):</p>
<p><span class="math display">\[
\text{Estimate: } \hat{\tau}_i - \hat{\tau}_j = (\bar{y}_i - \hat{\beta}_1 \bar{x}_i) - (\bar{y}_j - \hat{\beta}_1 \bar{x}_j)
\]</span></p>
</section>
<section id="variance-calculation" class="level3">
<h3 class="anchored" data-anchor-id="variance-calculation"><strong>Variance Calculation</strong></h3>
<p>From ANCOVA theory:</p>
<p><span class="math display">\[
\widehat{\text{Var}}(\hat\tau_i - \hat\tau_j) = MS_{\text{Error}} \left[ \frac{1}{n_i} + \frac{1}{n_j} + \frac{(\bar{x}_i - \bar{x}_j)^2}{SS_{xx}} \right]
\]</span></p>
<ul>
<li><span class="math inline">\(SS_{xx} = \sum_{i=1}^a \sum_{k=1}^{n_i} (x_{ik} - \bar{x}_{\cdot\cdot})^2\)</span> (total covariate SS)</li>
<li>Balloon data parameters: <span class="math inline">\(n_i = 8\)</span>, <span class="math inline">\(\hat{\beta}_1 = -0.211\)</span>, <span class="math inline">\(MS_{\text{Error}} = 6.731\)</span>, <span class="math inline">\(SS_{xx}\)</span> (unreported but embedded in SEs)</li>
</ul>
</section>
<section id="confidence-interval-calculation" class="level3">
<h3 class="anchored" data-anchor-id="confidence-interval-calculation"><strong>Confidence Interval Calculation</strong></h3>
<p><span class="math display">\[
\text{CI: } \hat{\tau}_i - \hat{\tau}_j \pm  (\text{Critical Value}) \sqrt{\widehat{\text{Var}}(\hat\tau_i - \hat\tau_j)}
\]</span></p>
<ul>
<li><strong>CI Critical Values</strong>:
<ul>
<li><strong>Bonferroni</strong>: Critical value <span class="math inline">\(t_{\alpha/(2m); sn-a-1}\)</span>, where <span class="math inline">\(m\)</span> is the number of comparisons.</li>
<li><strong>Scheffé</strong>: Critical value <span class="math inline">\(\sqrt{(a-1) F_{\alpha; a-1, n-a-1}}\)</span>.</li>
</ul></li>
<li>When multiple treatments are involved, pairwise comparisons of adjusted means can be performed to identify specific differences.</li>
<li>Use the <code>emmeans</code> package to perform pairwise comparisons of adjusted means.</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because the adjusted means are not independent unless the covariate is balanced across treatments (i.e., treatment means are equal), the Scheffé method is preferred for multiple comparisons. The Bonferroni method is conservative and may not be appropriate for all situations. The Scheffé method is more powerful and flexible, allowing for a wider range of contrasts to be tested.</p>
</div>
</div>
</section>
</section>
<section id="pairwise-comparisons-of-adjusted-means-using-scheffés-method" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="pairwise-comparisons-of-adjusted-means-using-scheffés-method">Pairwise Comparisons of Adjusted Means using Scheffé’s Method</h2>
<div class="cell page-columns page-full" data-tbl-width="8">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scheffé's Method</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>scheffe <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"scheffe"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>scheffe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-multiple-comparisons-sheffe" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-tbl-width="8">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-multiple-comparisons-sheffe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">lower.CL</th>
<th style="text-align: right;">upper.CL</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pink - yellow</td>
<td style="text-align: right;">-4.1056039</td>
<td style="text-align: right;">1.297600</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">-7.9725957</td>
<td style="text-align: right;">-0.2386121</td>
<td style="text-align: right;">-3.1639969</td>
<td style="text-align: right;">0.0340731</td>
</tr>
<tr class="even">
<td style="text-align: left;">pink - orange</td>
<td style="text-align: right;">-3.8012923</td>
<td style="text-align: right;">1.298720</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">-7.6716211</td>
<td style="text-align: right;">0.0690365</td>
<td style="text-align: right;">-2.9269524</td>
<td style="text-align: right;">0.0557052</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pink - blue</td>
<td style="text-align: right;">0.0708623</td>
<td style="text-align: right;">1.297362</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">-3.7954172</td>
<td style="text-align: right;">3.9371419</td>
<td style="text-align: right;">0.0546203</td>
<td style="text-align: right;">0.9999555</td>
</tr>
<tr class="even">
<td style="text-align: left;">yellow - orange</td>
<td style="text-align: right;">0.3043116</td>
<td style="text-align: right;">1.300584</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">-3.5715725</td>
<td style="text-align: right;">4.1801957</td>
<td style="text-align: right;">0.2339807</td>
<td style="text-align: right;">0.9965626</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yellow - blue</td>
<td style="text-align: right;">4.1764662</td>
<td style="text-align: right;">1.298183</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">0.3077388</td>
<td style="text-align: right;">8.0451936</td>
<td style="text-align: right;">3.2171632</td>
<td style="text-align: right;">0.0304163</td>
</tr>
<tr class="even">
<td style="text-align: left;">orange - blue</td>
<td style="text-align: right;">3.8721546</td>
<td style="text-align: right;">1.297959</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">0.0040946</td>
<td style="text-align: right;">7.7402145</td>
<td style="text-align: right;">2.9832644</td>
<td style="text-align: right;">0.0496784</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-multiple-comparisons-sheffe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Scheffé’s Method for Multiple Comparisons
</figcaption>
</figure>
</div>
</div>
<!-- ## Pairwise Comparisons of Adjusted Means using Tukey's HSD



::: {#tbl-multiple-comparisons-tukey .cell tbl-cap='Multiple Comparisons of Adjusted Means using Tukey\'s HSD'}

```{.r .cell-code}
# Pairwise comparisons

# Tukey's HSD
tukey <- contrast(emm, method = "pairwise", adjust = "tukey") |>
    summary(infer = TRUE)
tukey
```

::: {.cell-output-display}
<div class="kable-table">

|contrast        |   estimate|       SE| df|   lower.CL|   upper.CL|    t.ratio|   p.value|
|:---------------|----------:|--------:|--:|----------:|----------:|----------:|---------:|
|pink - yellow   | -4.1056039| 1.297600| 27| -7.6565703| -0.5546375| -3.1639969| 0.0188606|
|pink - orange   | -3.8012923| 1.298720| 27| -7.3553230| -0.2472616| -2.9269524| 0.0327033|
|pink - blue     |  0.0708623| 1.297362| 27| -3.4794500|  3.6211747|  0.0546203| 0.9999399|
|yellow - orange |  0.3043116| 1.300584| 27| -3.2548204|  3.8634436|  0.2339807| 0.9953789|
|yellow - blue   |  4.1764662| 1.298183| 27|  0.6239060|  7.7290264|  3.2171632| 0.0166214|
|orange - blue   |  3.8721546| 1.297959| 27|  0.3202073|  7.4241019|  2.9832644| 0.0287541|

</div>
:::
:::


-->
</section>
<section id="plotting-pairwise-comparisons" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="plotting-pairwise-comparisons">Plotting Pairwise Comparisons</h2>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(emm, <span class="at">comparisons =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pairwise Comparisons of Adjusted Means"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-pairwise-comparisons" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pairwise-comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-pairwise-comparisons-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;7: Pairwise Comparisons of Adjusted Means"><img src="week-10_ancova-part2_files/figure-html/fig-pairwise-comparisons-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pairwise-comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Pairwise Comparisons of Adjusted Means
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> Identify which balloon colors have significantly different inflation times after adjusting for run order.</p>
</section>
</section>
<section id="model-diagnostics" class="level1 page-columns page-full">
<h1>Model Diagnostics</h1>
<section id="residual-analysis-using-r-base-plot" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="residual-analysis-using-r-base-plot">Residual Analysis using R base plot</h2>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-post-model-diagnostics" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-post-model-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-post-model-diagnostics-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;8: Post-Model Diagnostics: Residuals vs.&nbsp;Fitted Values"><img src="week-10_ancova-part2_files/figure-html/fig-post-model-diagnostics-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-post-model-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Post-Model Diagnostics: Residuals vs.&nbsp;Fitted Values
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="residual-analysis-using-car-package" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="residual-analysis-using-car-package">Residual Analysis using <code>car</code> package</h2>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">residualPlots</span>(model_reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Test stat Pr(&gt;|Test stat|)
fColor                               
Order_c       0.5213           0.6066
Tukey test    0.8772           0.3804</code></pre>
</div>
<div class="cell-output-display page-columns page-full">
<div id="fig-post-model-diagnostics-car" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-post-model-diagnostics-car-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-post-model-diagnostics-car-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;9: Post-Model Diagnostics using car package"><img src="week-10_ancova-part2_files/figure-html/fig-post-model-diagnostics-car-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-post-model-diagnostics-car-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Post-Model Diagnostics using car package
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="diagnostics-using-performance-package" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="diagnostics-using-performance-package">Diagnostics using <code>performance</code> package</h2>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(model_reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-post-model-diagnostics-performance" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-post-model-diagnostics-performance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-10_ancova-part2_files/figure-html/fig-post-model-diagnostics-performance-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;10: Post-Model Diagnostics using performance package"><img src="week-10_ancova-part2_files/figure-html/fig-post-model-diagnostics-performance-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-post-model-diagnostics-performance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Post-Model Diagnostics using performance package
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="extensions-to-unbalanced-data" class="level1">
<h1>Extensions to Unbalanced Data</h1>
<p>When treatment groups have unequal sample sizes, ANCOVA can still be performed using Type II or Type III sums of squares to handle the imbalance.</p>
<section id="handling-unbalanced-data-in-r" class="level2">
<h2 class="anchored" data-anchor-id="handling-unbalanced-data-in-r">Handling Unbalanced Data in R</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA model with unbalanced data</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume 'data_unbalanced' is loaded with unequal replicates</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fit_unbalanced <span class="ot">&lt;-</span> <span class="fu">lm</span>(Response <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB, <span class="at">data =</span> data_unbalanced)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Type II Sum of Squares</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(fit_unbalanced, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Type III Sum of Squares</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(fit_unbalanced, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Considerations:</strong></p>
<ul>
<li><strong>Type II SS:</strong> Suitable when interactions are not of primary interest.</li>
<li><strong>Type III SS:</strong> Appropriate when interactions are present or main effects need to be tested conditionally.</li>
</ul>
</section>
</section>
<section id="multiple-covariates" class="level1">
<h1>Multiple Covariates</h1>
<p>ANCOVA can be extended to include multiple covariates, enhancing the model’s ability to adjust for various sources of variability.</p>
<section id="model-with-multiple-covariates" class="level2">
<h2 class="anchored" data-anchor-id="model-with-multiple-covariates">Model with Multiple Covariates</h2>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta_1 X_{1ij} + \beta_2 X_{2ij} + \ldots + \epsilon_{ij}
\]</span></p>
<p><strong>R Implementation:</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA model with multiple covariates</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>model_multi_cov <span class="ot">&lt;-</span> <span class="fu">lm</span>(Response <span class="sc">~</span> FactorA <span class="sc">+</span> FactorB <span class="sc">+</span> Covariate1 <span class="sc">+</span> Covariate2, <span class="at">data =</span> data)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_multi_cov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretation:</strong> Assess the effect of each covariate and treatment while controlling for other covariates.</p>
</section>
<section id="nonlinear-relationships" class="level2">
<h2 class="anchored" data-anchor-id="nonlinear-relationships">Nonlinear Relationships</h2>
<p>If the relationship between the response and covariate is not linear, polynomial terms can be included in the model.</p>
<section id="model-with-polynomial-terms" class="level3">
<h3 class="anchored" data-anchor-id="model-with-polynomial-terms">Model with Polynomial Terms</h3>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta_1 X_{ij} + \beta_2 X_{ij}^2 + \epsilon_{ij}
\]</span></p>
<p><strong>R Implementation:</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA model with quadratic term</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>model_poly <span class="ot">&lt;-</span> <span class="fu">lm</span>(Response <span class="sc">~</span> FactorA <span class="sc">+</span> FactorB <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> data)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_poly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretation:</strong> Determine if adding a quadratic term improves model fit and captures the nonlinear relationship.</p>
<!-- **Reference:**
Montgomery & Runger (2010) explain handling nonlinear relationships in regression models in *Applied Statistics and Probability for Engineers*. -->
</section>
</section>
</section>
<section id="appendix-advanced-mathematical-derivations" class="level1">
<h1>Appendix: Advanced Mathematical Derivations</h1>
<section id="adjusted-treatment-means-1" class="level2">
<h2 class="anchored" data-anchor-id="adjusted-treatment-means-1">Adjusted Treatment Means</h2>
<p>The adjusted mean for treatment <span class="math inline">\(i\)</span> is given by:</p>
<p><span class="math display">\[
\mu^\text{adj} = \mu + \tau_i = \bar{Y}_{i \cdot} - \beta (\bar{X}_{i \cdot} - \bar{X}_{\cdot\cdot}),
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\tau_i\)</span>: Treatment effect for treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\bar{Y}_{i\cdot}\)</span>: Mean response for treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\beta\)</span>: Regression coefficient for the covariate.</li>
<li><span class="math inline">\(\bar{X}_{i \cdot}\)</span>: Mean covariate value for treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\bar{X}_{\cdot\cdot}\)</span>: Overall mean of the covariate.</li>
</ul>
<p><strong>Derivation:</strong></p>
<ol type="1">
<li><strong>Model Equation:</strong></li>
</ol>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta (X_{ij} - \bar{X}_{\cdot\cdot}) + \epsilon_{ij}
\]</span></p>
<ol type="1">
<li><strong>Taking the Mean for Treatment <span class="math inline">\(i\)</span>:</strong></li>
</ol>
<p><span class="math display">\[
\bar{Y}_{i\cdot} = \mu + \tau_i + \beta (\bar{X}_{i \cdot} - \bar{X}_{\cdot\cdot}) + \bar{\epsilon}_i
\]</span></p>
<p>Since <span class="math inline">\(\bar{\epsilon}_i = 0\)</span> (assuming errors have mean zero),</p>
<p><span class="math display">\[
\bar{Y}_{i\cdot} = \mu + \tau_i + \beta (\bar{X}_{i \cdot}  - \bar{X}_{\cdot\cdot})
\]</span></p>
<ol type="1">
<li><strong>Solving for Adjusted Mean:</strong></li>
</ol>
<p><span class="math display">\[
\mu + \tau_i = \bar{Y}_{i \cdot} - \beta (\bar{X}_{i \cdot}  - \bar{X}_{\cdot\cdot})
\]</span></p>
<p>This equation represents the adjusted treatment mean, accounting for differences in the covariate.</p>
<p><strong>Reference:</strong> Montgomery (2019) and Scheffé (1959) provide detailed derivations of adjusted means in ANCOVA.</p>
</section>
<section id="f-test-for-homogeneity-of-slopes" class="level2">
<h2 class="anchored" data-anchor-id="f-test-for-homogeneity-of-slopes">F-Test for Homogeneity of Slopes</h2>
<p>To test the assumption of homogeneity of regression slopes (i.e., that <span class="math inline">\(\beta\)</span> is consistent across treatments), an F-test can be conducted by comparing two models:</p>
<ol type="1">
<li><strong>Model Without Interaction (Assuming Homogeneous Slopes):</strong></li>
</ol>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta X_{ij} + \epsilon_{ij}
\]</span></p>
<ol type="1">
<li><strong>Model With Interaction (Allowing Slopes to Vary):</strong></li>
</ol>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta_i X_{ij} + \epsilon_{ij}
\]</span></p>
<p>Where <span class="math inline">\(\beta_i = \beta + (\alpha\beta)_i\)</span> allows for different slopes across treatments.</p>
<p><strong>Test Procedure:</strong></p>
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> Homogeneity of slopes (<span class="math inline">\(\beta_i = \beta\)</span> for all <span class="math inline">\(i\)</span>).</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> Slopes vary across treatments (<span class="math inline">\(\beta_i \neq \beta\)</span> for at least one <span class="math inline">\(i\)</span>).</li>
</ul>
<p><strong>F-Statistic Calculation:</strong></p>
<p><span class="math display">\[
F = \frac{\text{SSR}_{\text{Interaction}} / \text{DF}_{\text{Interaction}}}{\text{SSE} / \text{DF}_{\text{Error}}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{SSR}_{\text{Interaction}}\)</span>: Sum of squares for the interaction term.</li>
<li><span class="math inline">\(\text{DF}_{\text{Interaction}}\)</span>: Degrees of freedom for the interaction.</li>
<li><span class="math inline">\(\text{SSE}\)</span>: Sum of squares for error.</li>
<li><span class="math inline">\(\text{DF}_{\text{Error}}\)</span>: Degrees of freedom for error.</li>
</ul>
<p><strong>Decision Rule:</strong></p>
<ul>
<li>Compare the calculated F-statistic to the critical value from the F-distribution.</li>
<li>Reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(F\)</span> exceeds the critical value, indicating heterogeneous slopes.</li>
</ul>
<p><strong>Reference:</strong> Scheffé (1959) elaborates on hypothesis testing for interaction terms in ANCOVA.</p>
</section>
<section id="confidence-intervals-for-higher-order-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals-for-higher-order-contrasts">Confidence Intervals for Higher-Order Contrasts</h2>
<p>For higher-order interactions involving multiple factors, confidence intervals for contrasts can provide insights into the magnitude and significance of these interactions.</p>
<section id="formula" class="level3">
<h3 class="anchored" data-anchor-id="formula">Formula</h3>
<p><span class="math display">\[
\text{CI} = \hat{L} \pm t_{\alpha/2, df} \sqrt{\text{Var}(\hat{L})}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\hat{L}\)</span>: Estimated contrast.</li>
<li><span class="math inline">\(t_{\alpha/2, df}\)</span>: Critical value from the t-distribution.</li>
<li><span class="math inline">\(\text{Var}(\hat{L})\)</span>: Variance of the contrast estimate.</li>
</ul>
</section>
<section id="steps-in-r" class="level3">
<h3 class="anchored" data-anchor-id="steps-in-r">Steps in R</h3>
<ol type="1">
<li><p><strong>Estimate the Contrast:</strong></p>
<p>Using the <code>emmeans</code> package to define and estimate contrasts.</p></li>
<li><p><strong>Calculate the Confidence Interval:</strong></p>
<p>The <code>emmeans</code> package automatically provides confidence intervals when performing contrasts.</p></li>
</ol>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the ANCOVA model</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">+</span> X, <span class="at">data =</span> data_sim)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define estimated marginal means</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> Treatment)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a contrast (e.g., Treatment B vs. Treatment A)</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>contrast_AB <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_AB, <span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretation:</strong> The output provides the estimated difference, standard error, t-value, and confidence interval for the contrast. If the confidence interval does not include zero, the contrast is statistically significant.</p>
<!-- **Reference:**
Christensen (2018) discusses confidence intervals for contrasts in *Analysis of Variance, Design, and Regression*. -->
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p><strong>Analysis of Covariance (ANCOVA)</strong> is a versatile statistical technique that enhances the power and precision of experiments by adjusting for covariates. By combining the strengths of ANOVA and regression, ANCOVA controls for extraneous variability, enabling more accurate assessment of treatment effects. Mastery of ANCOVA empowers graduate students to conduct robust experimental analyses, interpret complex interactions, and draw meaningful causal inferences.</p>
<p><strong>Key Takeaways:</strong></p>
<ul>
<li><strong>Purpose of ANCOVA:</strong> Adjusts for covariates to isolate treatment effects.</li>
<li><strong>Assumptions:</strong> Linearity, homogeneity of regression slopes, independence of covariate and treatment, normality, and homoscedasticity.</li>
<li><strong>Model Fitting:</strong> Involves testing treatment effects while accounting for covariates.</li>
<li><strong>Extensions:</strong> ANCOVA can handle unbalanced designs, multiple covariates, and nonlinear relationships.</li>
<li><strong>Practical Implementation:</strong> R provides comprehensive tools for performing ANCOVA and diagnostic assessments.</li>
<li><strong>Advanced Topics:</strong> Understanding higher-order interactions and mathematical derivations enhances analytical rigor.</li>
</ul>
<p><strong>Future Directions:</strong> Further exploration into advanced experimental designs, mixed-effects models, and nonparametric ANCOVA methods will provide a deeper understanding of complex data structures and enhance analytical capabilities.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<!-- 1. Dean, A., Voss, D., & Draguljić, D. (2017). *Design and Analysis of Experiments*. Springer.
2. Montgomery, D. C., & Runger, G. C. (2010). *Applied Statistics and Probability for Engineers*. Wiley.
3. Christensen, R. (2018). *Analysis of Variance, Design, and Regression*. Chapman and Hall/CRC.
4. Kempthorne, O. (1977). *Design and Analysis of Experiments*. Robert E. Krieger Publishing Company.
5. Scheffé, H. (1959). *The Analysis of Variance*. Wiley. -->


</section>
</section>

</main> <!-- /main -->
<!-- filepath: /Users/dt/Library/CloudStorage/Dropbox/Teaching/DOE/assets/includes/footer.html -->
<footer class="site-footer">
    <div class="container text-center">
        <hr> 
        © <span id="current-year"></span> Dr. Davood Tofighi |
        <a href="https://canvasinfo.unm.edu/">UNM Canvas</a> |
        <a href="https://data-wise.github.io/doe">Course GitHub Page</a> |
    </div>
    <script>
        document.getElementById("current-year").textContent = new Date().getFullYear();
    </script>
</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Data-Wise\.github\.io\/doe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>