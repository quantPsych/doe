<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Davood Tofighi, Ph.D.">

<title>Higher-Order Designs – STAT 454/545 - Analysis of Variance and Experimental Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4f17641596142cbde708c01b3a465e62.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-68b729f92b170261f1b1556cc4834a67.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Montserrat:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Higher-Order Designs – STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:description" content="Factorial Designs and Interaction Effects">
<meta property="og:image" content="https://Data-Wise.github.io/doe/lectures/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="STAT 454/545 - Analysis of Variance and Experimental Design">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 545</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/syllabus-final.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_lectures.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_help.html"> 
<span class="menu-text">R Help</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_appendix.html"> 
<span class="menu-text">Appendix</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contents.html"> 
<span class="menu-text">Contents</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Higher-Order Designs</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Higher-Order Designs</h1>
            <p class="subtitle lead">Factorial Designs and Interaction Effects</p>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://Data-Wise.github.io/doe">Davood Tofighi, Ph.D.</a> <a href="mailto:dtofighi@unm.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-8523-7776" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Mathematics and Statistics, University of New Mexico
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">02-Mar-2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus-final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R Code and Datasets</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r_help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Help</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r-code-data-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Code and Datasets from the Book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data-files-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets from the Book</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages">R Packages</a></li>
  </ul></li>
  <li><a href="#basics-of-higher-order-factorial-designs" id="toc-basics-of-higher-order-factorial-designs" class="nav-link" data-scroll-target="#basics-of-higher-order-factorial-designs">Basics of Higher-Order Factorial Designs</a>
  <ul class="collapse">
  <li><a href="#factorial-design-notation" id="toc-factorial-design-notation" class="nav-link" data-scroll-target="#factorial-design-notation">Factorial Design Notation</a></li>
  <li><a href="#experimental-objectives" id="toc-experimental-objectives" class="nav-link" data-scroll-target="#experimental-objectives">Experimental Objectives</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul></li>
  <li><a href="#model-formulation-and-analysis" id="toc-model-formulation-and-analysis" class="nav-link" data-scroll-target="#model-formulation-and-analysis">Model Formulation and Analysis</a>
  <ul class="collapse">
  <li><a href="#general-model-for-three-way-complete-model" id="toc-general-model-for-three-way-complete-model" class="nav-link" data-scroll-target="#general-model-for-three-way-complete-model">General Model for “Three-Way Complete” Model</a></li>
  <li><a href="#cell-means-model-formulation" id="toc-cell-means-model-formulation" class="nav-link" data-scroll-target="#cell-means-model-formulation">Cell Means Model Formulation</a></li>
  <li><a href="#key-concepts" id="toc-key-concepts" class="nav-link" data-scroll-target="#key-concepts">Key Concepts</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions</a>
  <ul class="collapse">
  <li><a href="#importance" id="toc-importance" class="nav-link" data-scroll-target="#importance">Importance</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#the-meaning-of-interaction-in-factorial-experiments" id="toc-the-meaning-of-interaction-in-factorial-experiments" class="nav-link" data-scroll-target="#the-meaning-of-interaction-in-factorial-experiments">The Meaning of Interaction in Factorial Experiments</a>
  <ul class="collapse">
  <li><a href="#introduction-1" id="toc-introduction-1" class="nav-link" data-scroll-target="#introduction-1">Introduction</a>
  <ul class="collapse">
  <li><a href="#two-factor-interactions" id="toc-two-factor-interactions" class="nav-link" data-scroll-target="#two-factor-interactions">Two-Factor Interactions</a></li>
  </ul></li>
  <li><a href="#example-a-hypothetical-3-times-2-times-2-experiment" id="toc-example-a-hypothetical-3-times-2-times-2-experiment" class="nav-link" data-scroll-target="#example-a-hypothetical-3-times-2-times-2-experiment">Example: A Hypothetical <span class="math inline">\(3 \times 2 \times 2\)</span> Experiment</a></li>
  <li><a href="#interpretation-of-an-interaction-plot" id="toc-interpretation-of-an-interaction-plot" class="nav-link" data-scroll-target="#interpretation-of-an-interaction-plot">Interpretation of an Interaction Plot</a></li>
  <li><a href="#three-factor-interactions" id="toc-three-factor-interactions" class="nav-link" data-scroll-target="#three-factor-interactions">Three-Factor Interactions</a></li>
  <li><a href="#graphical-representation" id="toc-graphical-representation" class="nav-link" data-scroll-target="#graphical-representation">Graphical Representation</a></li>
  <li><a href="#higher-order-interactions" id="toc-higher-order-interactions" class="nav-link" data-scroll-target="#higher-order-interactions">Higher-Order Interactions</a></li>
  </ul></li>
  <li><a href="#separability-of-factorial-effects" id="toc-separability-of-factorial-effects" class="nav-link" data-scroll-target="#separability-of-factorial-effects">Separability of Factorial Effects</a>
  <ul class="collapse">
  <li><a href="#what-is-separability-of-factorial-effects" id="toc-what-is-separability-of-factorial-effects" class="nav-link" data-scroll-target="#what-is-separability-of-factorial-effects">What Is Separability of Factorial Effects?</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  <li><a href="#why-is-it-useful" id="toc-why-is-it-useful" class="nav-link" data-scroll-target="#why-is-it-useful">Why Is It Useful?</a></li>
  </ul></li>
  <li><a href="#mathematical-foundations" id="toc-mathematical-foundations" class="nav-link" data-scroll-target="#mathematical-foundations">Mathematical Foundations</a>
  <ul class="collapse">
  <li><a href="#imposing-separability" id="toc-imposing-separability" class="nav-link" data-scroll-target="#imposing-separability">Imposing Separability</a></li>
  <li><a href="#derivation-outline" id="toc-derivation-outline" class="nav-link" data-scroll-target="#derivation-outline">Derivation Outline</a></li>
  </ul></li>
  <li><a href="#constructing-an-appropriate-model-using-interaction-graphs" id="toc-constructing-an-appropriate-model-using-interaction-graphs" class="nav-link" data-scroll-target="#constructing-an-appropriate-model-using-interaction-graphs">Constructing an Appropriate Model Using Interaction Graphs</a>
  <ul class="collapse">
  <li><a href="#what-are-interaction-graphs" id="toc-what-are-interaction-graphs" class="nav-link" data-scroll-target="#what-are-interaction-graphs">What Are Interaction Graphs?</a></li>
  <li><a href="#steps-for-constructing-an-interaction-graph" id="toc-steps-for-constructing-an-interaction-graph" class="nav-link" data-scroll-target="#steps-for-constructing-an-interaction-graph">Steps for Constructing an Interaction Graph</a></li>
  </ul></li>
  <li><a href="#analysis-with-equal-sample-sizes" id="toc-analysis-with-equal-sample-sizes" class="nav-link" data-scroll-target="#analysis-with-equal-sample-sizes">Analysis with Equal Sample Sizes</a>
  <ul class="collapse">
  <li><a href="#degrees-of-freedom-df" id="toc-degrees-of-freedom-df" class="nav-link" data-scroll-target="#degrees-of-freedom-df">Degrees of Freedom (DF)</a></li>
  <li><a href="#sum-of-squares-ss" id="toc-sum-of-squares-ss" class="nav-link" data-scroll-target="#sum-of-squares-ss">Sum of Squares (SS)</a>
  <ul class="collapse">
  <li><a href="#mean-squares-ms" id="toc-mean-squares-ms" class="nav-link" data-scroll-target="#mean-squares-ms">Mean Squares (MS)</a></li>
  <li><a href="#anova-table-example" id="toc-anova-table-example" class="nav-link" data-scroll-target="#anova-table-example">ANOVA Table Example</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#interaction-effects" id="toc-interaction-effects" class="nav-link" data-scroll-target="#interaction-effects">Interaction Effects</a>
  <ul class="collapse">
  <li><a href="#main-effects-vs.-interaction-effects" id="toc-main-effects-vs.-interaction-effects" class="nav-link" data-scroll-target="#main-effects-vs.-interaction-effects">Main Effects vs.&nbsp;Interaction Effects</a>
  <ul class="collapse">
  <li><a href="#visualizing-interactions" id="toc-visualizing-interactions" class="nav-link" data-scroll-target="#visualizing-interactions">Visualizing Interactions</a></li>
  </ul></li>
  <li><a href="#example-popcorn-microwave-experiment" id="toc-example-popcorn-microwave-experiment" class="nav-link" data-scroll-target="#example-popcorn-microwave-experiment">Example: Popcorn-Microwave Experiment</a></li>
  <li><a href="#interpreting-the-three-way-anova-results-with-consideration-of-interactions" id="toc-interpreting-the-three-way-anova-results-with-consideration-of-interactions" class="nav-link" data-scroll-target="#interpreting-the-three-way-anova-results-with-consideration-of-interactions">Interpreting the Three-Way ANOVA Results (With Consideration of Interactions)</a></li>
  <li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings"><strong>Key Findings</strong></a>
  <ul class="collapse">
  <li><a href="#three-way-interaction" id="toc-three-way-interaction" class="nav-link" data-scroll-target="#three-way-interaction"><strong>Three-Way Interaction</strong></a></li>
  <li><a href="#two-way-interactions" id="toc-two-way-interactions" class="nav-link" data-scroll-target="#two-way-interactions"><strong>Two-Way Interactions</strong></a></li>
  <li><a href="#main-effects" id="toc-main-effects" class="nav-link" data-scroll-target="#main-effects"><strong>Main Effects</strong></a></li>
  </ul></li>
  <li><a href="#interaction-plot-1-for-three-way-interaction--popcorn-microwave-experiment" id="toc-interaction-plot-1-for-three-way-interaction--popcorn-microwave-experiment" class="nav-link" data-scroll-target="#interaction-plot-1-for-three-way-interaction--popcorn-microwave-experiment">Interaction Plot 1 for Three-Way Interaction- Popcorn-Microwave Experiment</a></li>
  <li><a href="#interaction-plot-2-for-three-way-interaction--popcorn-microwave-experiment" id="toc-interaction-plot-2-for-three-way-interaction--popcorn-microwave-experiment" class="nav-link" data-scroll-target="#interaction-plot-2-for-three-way-interaction--popcorn-microwave-experiment">Interaction Plot 2 for Three-Way Interaction- Popcorn-Microwave Experiment</a></li>
  <li><a href="#model-without-non-significant-interactions" id="toc-model-without-non-significant-interactions" class="nav-link" data-scroll-target="#model-without-non-significant-interactions">Model without Non-Significant Interactions</a></li>
  <li><a href="#post-hoc-comparisons-for-the-two-way-interaction-brandtime-simple-effects" id="toc-post-hoc-comparisons-for-the-two-way-interaction-brandtime-simple-effects" class="nav-link" data-scroll-target="#post-hoc-comparisons-for-the-two-way-interaction-brandtime-simple-effects">Post-Hoc Comparisons for the Two-Way Interaction (Brand:Time) Simple Effects</a></li>
  <li><a href="#post-hoc-comparisons-for-brandtime-interaction" id="toc-post-hoc-comparisons-for-brandtime-interaction" class="nav-link" data-scroll-target="#post-hoc-comparisons-for-brandtime-interaction"><strong>Post Hoc Comparisons for Brand:Time Interaction</strong></a>
  <ul class="collapse">
  <li><a href="#time-short" id="toc-time-short" class="nav-link" data-scroll-target="#time-short"><strong>Time = Short</strong></a></li>
  <li><a href="#time-medium" id="toc-time-medium" class="nav-link" data-scroll-target="#time-medium"><strong>Time = Medium</strong></a></li>
  <li><a href="#time-long" id="toc-time-long" class="nav-link" data-scroll-target="#time-long"><strong>Time = Long</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#equal-sample-sizes-in-factorial-designs" id="toc-equal-sample-sizes-in-factorial-designs" class="nav-link" data-scroll-target="#equal-sample-sizes-in-factorial-designs">Equal Sample Sizes in Factorial Designs</a>
  <ul class="collapse">
  <li><a href="#equal-sample-sizes-the-setup" id="toc-equal-sample-sizes-the-setup" class="nav-link" data-scroll-target="#equal-sample-sizes-the-setup">Equal Sample Sizes: The Setup</a></li>
  <li><a href="#model-description-and-terminology" id="toc-model-description-and-terminology" class="nav-link" data-scroll-target="#model-description-and-terminology">Model Description and Terminology</a></li>
  <li><a href="#model-equation" id="toc-model-equation" class="nav-link" data-scroll-target="#model-equation">Model Equation</a></li>
  <li><a href="#degrees-of-freedom-for-factorial-effects" id="toc-degrees-of-freedom-for-factorial-effects" class="nav-link" data-scroll-target="#degrees-of-freedom-for-factorial-effects">Degrees of Freedom for Factorial Effects</a></li>
  <li><a href="#sums-of-squares-in-factorial-models" id="toc-sums-of-squares-in-factorial-models" class="nav-link" data-scroll-target="#sums-of-squares-in-factorial-models">Sums of Squares in Factorial Models</a></li>
  <li><a href="#total-sum-of-squares-and-error" id="toc-total-sum-of-squares-and-error" class="nav-link" data-scroll-target="#total-sum-of-squares-and-error">Total Sum of Squares and Error</a></li>
  <li><a href="#mean-squares-and-f-statistics" id="toc-mean-squares-and-f-statistics" class="nav-link" data-scroll-target="#mean-squares-and-f-statistics">Mean Squares and F-Statistics</a></li>
  <li><a href="#contrasts-estimable-functions-and-confidence-intervals" id="toc-contrasts-estimable-functions-and-confidence-intervals" class="nav-link" data-scroll-target="#contrasts-estimable-functions-and-confidence-intervals">Contrasts, Estimable Functions, and Confidence Intervals</a></li>
  <li><a href="#numerical-example-in-r" id="toc-numerical-example-in-r" class="nav-link" data-scroll-target="#numerical-example-in-r">Numerical Example in R</a>
  <ul class="collapse">
  <li><a href="#explanation" id="toc-explanation" class="nav-link" data-scroll-target="#explanation">Explanation:</a></li>
  </ul></li>
  <li><a href="#anova-results-for-the-24-factorial-design" id="toc-anova-results-for-the-24-factorial-design" class="nav-link" data-scroll-target="#anova-results-for-the-24-factorial-design">ANOVA Results for the 2^4 Factorial Design</a>
  <ul class="collapse">
  <li><a href="#explanation-1" id="toc-explanation-1" class="nav-link" data-scroll-target="#explanation-1">Explanation:</a></li>
  </ul></li>
  <li><a href="#guidelines-for-analysis-and-interpretation" id="toc-guidelines-for-analysis-and-interpretation" class="nav-link" data-scroll-target="#guidelines-for-analysis-and-interpretation">Guidelines for Analysis and Interpretation</a></li>
  <li><a href="#advanced-section-higher-order-interactions-and-orthogonal-decompositions" id="toc-advanced-section-higher-order-interactions-and-orthogonal-decompositions" class="nav-link" data-scroll-target="#advanced-section-higher-order-interactions-and-orthogonal-decompositions">Advanced Section: Higher-Order Interactions and Orthogonal Decompositions</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul></li>
  <li><a href="#handling-unequal-sample-sizes" id="toc-handling-unequal-sample-sizes" class="nav-link" data-scroll-target="#handling-unequal-sample-sizes">Handling Unequal Sample Sizes</a>
  <ul class="collapse">
  <li><a href="#types-of-sums-of-squares" id="toc-types-of-sums-of-squares" class="nav-link" data-scroll-target="#types-of-sums-of-squares">Types of Sums of Squares</a></li>
  </ul></li>
  <li><a href="#real-world-application-in-r" id="toc-real-world-application-in-r" class="nav-link" data-scroll-target="#real-world-application-in-r">Real-World Application in R</a>
  <ul class="collapse">
  <li><a href="#three-way-anova-example" id="toc-three-way-anova-example" class="nav-link" data-scroll-target="#three-way-anova-example">Three-Way ANOVA Example</a></li>
  <li><a href="#r-code-for-three-way-anova" id="toc-r-code-for-three-way-anova" class="nav-link" data-scroll-target="#r-code-for-three-way-anova">R Code for Three-Way ANOVA</a></li>
  </ul></li>
  <li><a href="#probling-three-way-interaction-illustrative" id="toc-probling-three-way-interaction-illustrative" class="nav-link" data-scroll-target="#probling-three-way-interaction-illustrative">Probling Three-Way Interaction (Illustrative)</a>
  <ul class="collapse">
  <li><a href="#three-way-interaction-interpretation" id="toc-three-way-interaction-interpretation" class="nav-link" data-scroll-target="#three-way-interaction-interpretation">Three Way Interaction Interpretation</a></li>
  <li><a href="#simple-effects-analysis" id="toc-simple-effects-analysis" class="nav-link" data-scroll-target="#simple-effects-analysis">Simple Effects Analysis</a></li>
  <li><a href="#ls-means-for-material-and-feedback-by-age-group" id="toc-ls-means-for-material-and-feedback-by-age-group" class="nav-link" data-scroll-target="#ls-means-for-material-and-feedback-by-age-group">LS Means for Material and Feedback by Age Group</a></li>
  <li><a href="#r-code-for-simple-effects-of-material-and-feedback-by-age-group" id="toc-r-code-for-simple-effects-of-material-and-feedback-by-age-group" class="nav-link" data-scroll-target="#r-code-for-simple-effects-of-material-and-feedback-by-age-group">R Code for Simple Effects of Material and Feedback by Age Group</a></li>
  <li><a href="#interpreting-the-simple-effects-analysis" id="toc-interpreting-the-simple-effects-analysis" class="nav-link" data-scroll-target="#interpreting-the-simple-effects-analysis">Interpreting the Simple Effects Analysis</a>
  <ul class="collapse">
  <li><a href="#fifth-graders" id="toc-fifth-graders" class="nav-link" data-scroll-target="#fifth-graders">Fifth Graders:</a></li>
  <li><a href="#high-school-seniors" id="toc-high-school-seniors" class="nav-link" data-scroll-target="#high-school-seniors">High School Seniors:</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary:</a></li>
  </ul></li>
  <li><a href="#probing-simple-effects-of-material-and-feedback-for-fifth-graders" id="toc-probing-simple-effects-of-material-and-feedback-for-fifth-graders" class="nav-link" data-scroll-target="#probing-simple-effects-of-material-and-feedback-for-fifth-graders">Probing Simple Effects of Material and Feedback for Fifth Graders</a>
  <ul class="collapse">
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">Summary:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#probling-two-way-interactions" id="toc-probling-two-way-interactions" class="nav-link" data-scroll-target="#probling-two-way-interactions">Probling Two-Way Interactions</a>
  <ul class="collapse">
  <li><a href="#interpreting-the-two-way-anova-results" id="toc-interpreting-the-two-way-anova-results" class="nav-link" data-scroll-target="#interpreting-the-two-way-anova-results">Interpreting the Two-Way ANOVA Results</a></li>
  <li><a href="#reduced-model-for-two-way-interaction-material-age" id="toc-reduced-model-for-two-way-interaction-material-age" class="nav-link" data-scroll-target="#reduced-model-for-two-way-interaction-material-age">Reduced Model for Two-Way Interaction (Material × Age)</a></li>
  <li><a href="#simple-effects-analysis-for-material-age-interaction" id="toc-simple-effects-analysis-for-material-age-interaction" class="nav-link" data-scroll-target="#simple-effects-analysis-for-material-age-interaction">Simple Effects Analysis for Material × Age Interaction</a></li>
  <li><a href="#probing-simple-effects-of-material-by-age" id="toc-probing-simple-effects-of-material-by-age" class="nav-link" data-scroll-target="#probing-simple-effects-of-material-by-age">Probing Simple Effects of Material by Age</a></li>
  <li><a href="#summary-2" id="toc-summary-2" class="nav-link" data-scroll-target="#summary-2">Summary</a></li>
  </ul></li>
  <li><a href="#advanced-analysis-techniques" id="toc-advanced-analysis-techniques" class="nav-link" data-scroll-target="#advanced-analysis-techniques">Advanced Analysis Techniques</a>
  <ul class="collapse">
  <li><a href="#addressing-complex-interactions" id="toc-addressing-complex-interactions" class="nav-link" data-scroll-target="#addressing-complex-interactions">Addressing Complex Interactions</a>
  <ul class="collapse">
  <li><a href="#higher-order-interactions-1" id="toc-higher-order-interactions-1" class="nav-link" data-scroll-target="#higher-order-interactions-1">Higher-Order Interactions</a></li>
  <li><a href="#simplifying-the-model" id="toc-simplifying-the-model" class="nav-link" data-scroll-target="#simplifying-the-model">Simplifying the Model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#diagnostic-tools-and-assumptions-checking" id="toc-diagnostic-tools-and-assumptions-checking" class="nav-link" data-scroll-target="#diagnostic-tools-and-assumptions-checking">Diagnostic Tools and Assumptions Checking</a>
  <ul class="collapse">
  <li><a href="#residual-analysis" id="toc-residual-analysis" class="nav-link" data-scroll-target="#residual-analysis">Residual Analysis</a>
  <ul class="collapse">
  <li><a href="#residual-plots" id="toc-residual-plots" class="nav-link" data-scroll-target="#residual-plots">Residual Plots</a></li>
  </ul></li>
  <li><a href="#r-implementation" id="toc-r-implementation" class="nav-link" data-scroll-target="#r-implementation">R Implementation</a></li>
  <li><a href="#remedies-for-assumption-violations" id="toc-remedies-for-assumption-violations" class="nav-link" data-scroll-target="#remedies-for-assumption-violations">Remedies for Assumption Violations</a></li>
  </ul></li>
  <li><a href="#appendix-advanced-mathematical-details" id="toc-appendix-advanced-mathematical-details" class="nav-link" data-scroll-target="#appendix-advanced-mathematical-details">Appendix: Advanced Mathematical Details</a>
  <ul class="collapse">
  <li><a href="#confidence-intervals-for-higher-order-contrasts" id="toc-confidence-intervals-for-higher-order-contrasts" class="nav-link" data-scroll-target="#confidence-intervals-for-higher-order-contrasts">Confidence Intervals for Higher-Order Contrasts</a></li>
  <li><a href="#box-cox-transformation" id="toc-box-cox-transformation" class="nav-link" data-scroll-target="#box-cox-transformation">Box-Cox Transformation</a></li>
  <li><a href="#mathematical-proof-of-interaction-contrasts" id="toc-mathematical-proof-of-interaction-contrasts" class="nav-link" data-scroll-target="#mathematical-proof-of-interaction-contrasts">Mathematical Proof of Interaction Contrasts</a>
  <ul class="collapse">
  <li><a href="#interaction-contrasts-measure-deviations-from-additivity" id="toc-interaction-contrasts-measure-deviations-from-additivity" class="nav-link" data-scroll-target="#interaction-contrasts-measure-deviations-from-additivity">Interaction Contrasts Measure Deviations from Additivity</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#orthogonality-and-balance-in-factorial-experiments" id="toc-orthogonality-and-balance-in-factorial-experiments" class="nav-link" data-scroll-target="#orthogonality-and-balance-in-factorial-experiments">Orthogonality and Balance in factorial experiments</a>
  <ul class="collapse">
  <li><a href="#key-points" id="toc-key-points" class="nav-link" data-scroll-target="#key-points">Key Points</a></li>
  <li><a href="#relationship-between-the-two" id="toc-relationship-between-the-two" class="nav-link" data-scroll-target="#relationship-between-the-two">Relationship Between the Two</a></li>
  <li><a href="#orthogonality-without-balance-a-caveat" id="toc-orthogonality-without-balance-a-caveat" class="nav-link" data-scroll-target="#orthogonality-without-balance-a-caveat">Orthogonality Without Balance: A Caveat</a></li>
  <li><a href="#summary-3" id="toc-summary-3" class="nav-link" data-scroll-target="#summary-3">Summary</a></li>
  </ul></li>
  <li><a href="#proof-of-orthogonality-in-balanced-designs" id="toc-proof-of-orthogonality-in-balanced-designs" class="nav-link" data-scroll-target="#proof-of-orthogonality-in-balanced-designs">Proof of Orthogonality in Balanced Designs</a>
  <ul class="collapse">
  <li><a href="#the-concept-of-orthogonality" id="toc-the-concept-of-orthogonality" class="nav-link" data-scroll-target="#the-concept-of-orthogonality">The Concept of Orthogonality</a></li>
  <li><a href="#the-role-of-balance" id="toc-the-role-of-balance" class="nav-link" data-scroll-target="#the-role-of-balance">The Role of Balance</a></li>
  <li><a href="#matrix-proof-of-orthogonality" id="toc-matrix-proof-of-orthogonality" class="nav-link" data-scroll-target="#matrix-proof-of-orthogonality">Matrix Proof of Orthogonality</a>
  <ul class="collapse">
  <li><a href="#detailed-steps" id="toc-detailed-steps" class="nav-link" data-scroll-target="#detailed-steps">Detailed Steps</a></li>
  </ul></li>
  <li><a href="#intuitive-explanation" id="toc-intuitive-explanation" class="nav-link" data-scroll-target="#intuitive-explanation">Intuitive Explanation</a></li>
  <li><a href="#summary-4" id="toc-summary-4" class="nav-link" data-scroll-target="#summary-4">Summary</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In experimental research, understanding the effects of multiple factors and their interactions is crucial for optimizing outcomes and making informed decisions. <strong>Factorial designs</strong> allow researchers to evaluate not only the individual (main) effects of factors but also how factors interact with each other to influence a response variable. <strong>Higher-order factorial designs</strong>, involving three or more factors, extend these principles, enabling the exploration of complex relationships within data.</p>
<p>This lecture delves into the structure, analysis, and interpretation of higher-order factorial designs, with a focus on two-way ANOVA models. We’ll explore main effects, interaction effects, handling unequal sample sizes, and practical implementation using R.</p>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>Imagine you’re a chef experimenting with different ingredients to perfect a recipe. Factor A could be the type of flour (whole wheat, all-purpose), Factor B the type of sugar (granulated, brown), and Factor C the baking temperature (350°F, 375°F, 400°F). Each factor influences the final product’s taste and texture. However, the optimal combination might not be obvious because the effect of sugar type could depend on the type of flour and the baking temperature. Higher-order factorial designs help uncover these intricate interactions systematically.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li><strong>Understand</strong> the structure and applications of higher-order factorial designs.</li>
<li><strong>Differentiate</strong> between main effects and interaction effects.</li>
<li><strong>Perform</strong> two-way ANOVA and interpret its results.</li>
<li><strong>Address</strong> challenges posed by unequal replication in factorial experiments.</li>
<li><strong>Visualize</strong> interactions and understand their implications.</li>
<li><strong>Apply</strong> advanced statistical techniques using R for complex datasets.</li>
<li><strong>Engage</strong> with exercises to reinforce understanding and application of concepts.</li>
</ol>
</section>
<section id="r-packages" class="level2">
<h2 class="anchored" data-anchor-id="r-packages">R Packages</h2>
<p>To run the R code examples in these notes, we recommend installing the following packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Required R Packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, emmeans, here, readr, ggpubr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"hecedsm"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    pacman<span class="sc">::</span><span class="fu">p_install_gh</span>(<span class="st">"lbelzile/hecedsm"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_pubr</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><code>dplyr</code></strong>: Data manipulation and summarization.</li>
<li><strong><code>ggplot2</code></strong>: Data visualization.</li>
<li><strong><code>lsmeans</code></strong> and <strong><code>emmeans</code></strong>: Post hoc comparisons and multiple comparisons.</li>
<li><strong><code>pacman</code></strong>: Package management.</li>
<li><strong><code>here</code></strong>: File path management.</li>
<li><strong><code>readr</code></strong>: Reading data files.</li>
</ul>
</section>
</section>
<section id="basics-of-higher-order-factorial-designs" class="level1">
<h1>Basics of Higher-Order Factorial Designs</h1>
<section id="factorial-design-notation" class="level2">
<h2 class="anchored" data-anchor-id="factorial-design-notation">Factorial Design Notation</h2>
<p>A factorial experiment involves multiple factors, each with different levels. The notation <span class="math inline">\(a \times b \times c \times \dots\)</span> denotes the number of levels for each factor. For example:</p>
<ul>
<li><strong>2 × 3 × 4 Design:</strong>
<ul>
<li>Factor A: 2 levels</li>
<li>Factor B: 3 levels</li>
<li>Factor C: 4 levels</li>
<li><strong>Total Treatment Combinations:</strong> <span class="math inline">\(2 \times 3 \times 4 = 24\)</span></li>
</ul></li>
</ul>
</section>
<section id="experimental-objectives" class="level2">
<h2 class="anchored" data-anchor-id="experimental-objectives">Experimental Objectives</h2>
<ul>
<li><strong>Estimate Main Effects:</strong> Determine the independent influence of each factor on the response.</li>
<li><strong>Quantify Two-Factor Interactions:</strong> Assess how pairs of factors jointly affect the response.</li>
<li><strong>Investigate Higher-Order Interactions:</strong> Explore interactions involving three or more factors.</li>
</ul>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<p>In a manufacturing process, factors could include machine speed (fast, medium, slow), material type (A, B), and temperature (high, low). Understanding not only how each factor affects product quality but also how combinations (e.g., fast speed with high temperature) influence outcomes is essential for process optimization.</p>
</section>
</section>
<section id="model-formulation-and-analysis" class="level1">
<h1>Model Formulation and Analysis</h1>
<section id="general-model-for-three-way-complete-model" class="level2">
<h2 class="anchored" data-anchor-id="general-model-for-three-way-complete-model">General Model for “Three-Way Complete” Model</h2>
<p>For three-way complete model with three factors, the general linear model is:</p>
<p><span id="eq-three-way-effect-model"><span class="math display">\[
Y_{ijkt} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk} + (\alpha\beta\gamma)_{ijk} + \epsilon_{ijkt}
\qquad(1)\]</span></span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{ijkt}\)</span>: Observed response.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\alpha_i, \beta_j, \gamma_k\)</span>: Main effects of factors <span class="math inline">\(A, B, C\)</span>.</li>
<li><span class="math inline">\((\alpha\beta)_{ij}\)</span>: Two-factor interaction between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</li>
<li><span class="math inline">\((\alpha\beta\gamma)_{ijk}\)</span>: Three-factor interaction.</li>
<li><span class="math inline">\(\epsilon_{ijkt} \sim N(0, \sigma^2)\)</span>: Random error term.</li>
</ul>
</section>
<section id="cell-means-model-formulation" class="level2">
<h2 class="anchored" data-anchor-id="cell-means-model-formulation">Cell Means Model Formulation</h2>
<p>The cell means model expresses the response as a sum of cell means and deviations from these means:</p>
<p><span class="math display">\[
Y_{ijkt} = \mu + \tau_{ijk} + \epsilon_{ijkt}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\tau_{ijk}\)</span>: Cell mean for the <span class="math inline">\(ijk\)</span> treatment combination.</li>
<li><span class="math inline">\(\epsilon_{ijkt}\)</span>: Random error term.</li>
<li><strong>Note:</strong> The cell means model is a simplified version of the general linear model.</li>
<li><strong>Objective:</strong> Estimate cell means and deviations to understand factor effects and interactions.</li>
</ul>
</section>
<section id="key-concepts" class="level2">
<h2 class="anchored" data-anchor-id="key-concepts">Key Concepts</h2>
<ul>
<li><p>Model Simplification: If interaction effects are negligible, they can be removed from the model to create a submodel. This simplification aids in interpretation and model fitting. -For instance, if the factors A and B are known to be non-interacting in a three-factor experiment, then the AB and ABC interaction effects are negligible, necessitating the exclusion of the terms <span class="math inline">\((αβ)_{ij}\)</span> and <span class="math inline">\((αβγ)_{i jk}\)</span> from model in <a href="#eq-three-way-effect-model" class="quarto-xref">Equation&nbsp;1</a>. In the most extreme scenario, if no factors are anticipated to interact, a <strong>main-effects model</strong> (which incorporates no interaction terms) can be employed.</p></li>
<li><p>Interaction Model Inclusion: When a model includes an interaction between a specific set of factors, all interaction terms involving subsets of those factors should be included.</p></li>
<li><p>Submodel Advantages: Simpler submodels generally yield tighter confidence intervals and more powerful hypothesis tests.</p></li>
</ul>
</section>
<section id="assumptions" class="level2">
<h2 class="anchored" data-anchor-id="assumptions">Assumptions</h2>
<ol type="1">
<li><strong>Independence:</strong> Observations are independent.</li>
<li><strong>Homoscedasticity:</strong> Constant variance across all treatment combinations.</li>
<li><strong>Normality:</strong> Errors are normally distributed.</li>
</ol>
<section id="importance" class="level3">
<h3 class="anchored" data-anchor-id="importance">Importance</h3>
<p>These assumptions underpin the validity of ANOVA results. Violations can lead to incorrect inferences, necessitating diagnostic checks and potential corrective measures.</p>
</section>
</section>
</section>
<section id="the-meaning-of-interaction-in-factorial-experiments" class="level1">
<h1>The Meaning of Interaction in Factorial Experiments</h1>
<section id="introduction-1" class="level2">
<h2 class="anchored" data-anchor-id="introduction-1">Introduction</h2>
<p>In factorial experiments, interactions occur when the effect of one factor depends on the level of another factor. These interactions provide valuable insights into complex relationships between factors. Understanding interactions is crucial for accurately interpreting experimental results and making informed decisions in practical applications.</p>
<section id="two-factor-interactions" class="level3">
<h3 class="anchored" data-anchor-id="two-factor-interactions">Two-Factor Interactions</h3>
<p>An interaction between two factors, say <em>A</em> and <em>B</em>, occurs when the effect of <em>A</em> on the response variable depends on the level of <em>B</em>, or vice versa. A common method for detecting interactions is through <strong>interaction plots</strong>, where the response variable is plotted against one factor at different levels of another factor.</p>
</section>
</section>
<section id="example-a-hypothetical-3-times-2-times-2-experiment" class="level2">
<h2 class="anchored" data-anchor-id="example-a-hypothetical-3-times-2-times-2-experiment">Example: A Hypothetical <span class="math inline">\(3 \times 2 \times 2\)</span> Experiment</h2>
<p>Consider a factorial experiment with three factors:</p>
<ul>
<li><em>A</em> (3 levels)</li>
<li><em>B</em> (2 levels)</li>
<li><em>C</em> (2 levels)</li>
</ul>
<p>The sample means for each treatment combination provide insight into possible interactions. A two-factor interaction plot (<em>AB</em>-interaction) can be examined by averaging over the levels of <em>C</em>. If the interaction plot reveals non-parallel lines, an interaction is likely present.</p>
</section>
<section id="interpretation-of-an-interaction-plot" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-of-an-interaction-plot">Interpretation of an Interaction Plot</h2>
<ul>
<li><strong>Parallel lines</strong>: No interaction, meaning the effect of one factor is consistent across the levels of the other.</li>
<li><strong>Non-parallel lines</strong>: Possible interaction, indicating that the effect of one factor changes depending on the level of the other.</li>
</ul>
<p>However, interpreting an interaction plot should be done cautiously since it does not account for experimental error.</p>
</section>
<section id="three-factor-interactions" class="level2">
<h2 class="anchored" data-anchor-id="three-factor-interactions">Three-Factor Interactions</h2>
<p>A <strong>three-factor interaction</strong> (<span class="math inline">\(ABC\)</span>) is present if the interaction between <em>A</em> and <em>B</em> changes depending on the level of <em>C</em>. This can be evaluated using separate interaction plots at different levels of <em>C</em>.</p>
<ul>
<li><strong>No three-factor interaction</strong>: The patterns in <em>AB</em>-interaction plots remain consistent across levels of <em>C</em>.</li>
<li><strong>Significant three-factor interaction</strong>: The <em>AB</em>-interaction patterns change across levels of <em>C</em>, meaning the combined effect of <em>A</em> and <em>B</em> depends on <em>C</em>.</li>
</ul>
</section>
<section id="graphical-representation" class="level2">
<h2 class="anchored" data-anchor-id="graphical-representation">Graphical Representation</h2>
<ul>
<li><strong>Two-factor interaction plots at each level of <em>C</em></strong>: If the interaction pattern remains the same, <em>C</em> does not influence the <em>AB</em>-interaction.</li>
<li><strong>Differences in interaction patterns across <em>C</em></strong>: Suggests an <em>ABC</em>-interaction, indicating that the effect of <em>A</em> and <em>B</em> together depends on <em>C</em>.</li>
</ul>
</section>
<section id="higher-order-interactions" class="level2">
<h2 class="anchored" data-anchor-id="higher-order-interactions">Higher-Order Interactions</h2>
<p>Interactions involving four or more factors become increasingly difficult to interpret. While graphical methods are useful for two and three-factor interactions, analysis of variance (ANOVA) tables become essential for evaluating higher-order interactions. In practice:</p>
<ul>
<li><strong>Higher-order interactions tend to be small</strong> and may be ignored unless evidence suggests otherwise.</li>
<li><strong>Lower-order interactions (twoand three-factor interactions) are prioritized</strong> in interpretation.</li>
</ul>
</section>
</section>
<section id="separability-of-factorial-effects" class="level1">
<h1>Separability of Factorial Effects</h1>
<!-- ## Separability of Factorial Effects

In some experiments, it is known in advance that certain interactions are negligible. For example, if factor *C* does not interact with factors *A* or *B*, then the *AC*, *BC*, and *ABC* interactions can be excluded from the model. This simplifies the interpretation of main effects and two-factor interactions.

## Advantages of Separability

- **Reduces complexity**: Ignoring negligible interactions simplifies analysis.
- **Facilitates independent decision-making**: The best levels of *A* and *B* can be determined separately from the best level of *C*.

However, experimenters should avoid **separate experiments** for different factors unless interactions are definitively absent. A single factorial experiment provides more information with the same number of observations. -->
<section id="what-is-separability-of-factorial-effects" class="level2">
<h2 class="anchored" data-anchor-id="what-is-separability-of-factorial-effects">What Is Separability of Factorial Effects?</h2>
<p>In a factorial experiment, several factors are varied simultaneously to study their effects on a response variable. <strong>Separability</strong> refers to the idea that if some interactions among factors are known or assumed to be negligible, then the effects of these factors can be analyzed separately (i.e., “separately” or “independently”) from the others.</p>
</section>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">Example</h2>
<ul>
<li>Suppose you have three factors—<em>A</em>, <em>B</em>, and <em>C</em>.</li>
<li>If prior knowledge or experimental evidence suggests that factor <em>C</em> does not interact with factors <em>A</em> or <em>B</em>, then the interactions <em>AC</em>, <em>BC</em>, and the three-factor interaction <em>ABC</em> can be removed from the model.</li>
<li>In practical terms, this means you can determine the optimal levels of <em>A</em> and <em>B</em> independently of <em>C</em> and vice versa, greatly simplifying both the design and interpretation of the experiment.</li>
</ul>
</section>
<section id="why-is-it-useful" class="level2">
<h2 class="anchored" data-anchor-id="why-is-it-useful">Why Is It Useful?</h2>
<ul>
<li><strong>Reduced Complexity:</strong> With fewer interaction terms, the model has fewer parameters to estimate, which can improve precision and make the analysis more straightforward.</li>
<li><strong>Independent Decision-Making:</strong> When interactions are negligible, the optimal settings for one subset of factors can be determined without worrying about their influence on other factors.</li>
<li><strong>Efficient Use of Data:</strong> A single, well-designed factorial experiment usually provides more comprehensive information than several smaller experiments done separately.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The assumption of separability must be justified by prior knowledge or preliminary analysis. Otherwise, omitting important interactions might lead to biased conclusions.</p>
</div>
</div>
</section>
</section>
<section id="mathematical-foundations" class="level1">
<h1>Mathematical Foundations</h1>
<section id="imposing-separability" class="level2">
<h2 class="anchored" data-anchor-id="imposing-separability">Imposing Separability</h2>
<p>Consider a three-factor experiment with factors <em>A</em>, <em>B</em>, and <em>C</em>:</p>
<p><span class="math display">\[
Y_{ijkt} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk} + (\alpha\beta\gamma)_{ijk} + \epsilon_{ijkt},
\]</span></p>
<p>If prior knowledge tells us that factor <em>C</em> does not interact with factors <em>A</em> or <em>B</em>, then the following interaction terms are assumed to be zero:</p>
<p><span class="math display">\[
(\alpha\gamma)_{ik} = 0,\quad (\beta\gamma)_{jk} = 0,\quad (\alpha\beta\gamma)_{ijk} = 0.
\]</span></p>
<p>Thus, the model simplifies to:</p>
<p><span id="eq-separable-model"><span class="math display">\[
Y_{ijkt} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + \epsilon_{ijkt}.
\qquad(2)\]</span></span></p>
</section>
<section id="derivation-outline" class="level2">
<h2 class="anchored" data-anchor-id="derivation-outline">Derivation Outline</h2>
<ol type="1">
<li><p><strong>Full Model Setup:</strong> Start with the full model including all interactions.</p></li>
<li><p><strong>Hypothesis of Negligible Interactions:</strong> Hypothesize that <span class="math inline">\((\alpha\gamma)_{ik} = 0\)</span>, <span class="math inline">\((\beta\gamma)_{jk} = 0\)</span>, and <span class="math inline">\((\alpha\beta\gamma)_{ijk} = 0\)</span>. This assumption is based on prior experiments or domain knowledge (see <span class="citation" data-cites="montgomery2020a">Montgomery (<a href="#ref-montgomery2020a" role="doc-biblioref">2020</a>)</span>).</p></li>
<li><p><strong>Simplification of the Model:</strong> Substitute the zero interaction terms into the full model to yield the simplified form:</p></li>
</ol>
<p><span class="math display">\[
Y_{ijkt} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + \epsilon_{ijkt}.
\]</span></p>
<ol start="4" type="1">
<li><strong>Parameter Estimation and Orthogonality:</strong> In a balanced (orthogonal) design, the estimates of the main effects and the remaining interaction (<span class="math inline">\(\alpha\beta\)</span>) are independent of the omitted interaction terms. This follows from the <strong>Gauss-Markov theorem</strong>, which assures that the least squares estimators are the Best Linear Unbiased Estimators (BLUE) under the classical linear model assumptions <span class="citation" data-cites="box2005">(<a href="#ref-box2005" role="doc-biblioref">Box et al., 2005</a>)</span>
<ul>
<li><strong>Orthogonality Condition:</strong> The design matrix is constructed so that the columns corresponding to main effects and the <span class="math inline">\(AB\)</span> interaction are orthogonal to those corresponding to the omitted interactions. This ensures that the parameter estimates remain unbiased when the negligible interactions are excluded.</li>
</ul></li>
<li><strong>Degrees of Freedom:</strong> With fewer parameters to estimate, more degrees of freedom are available for estimating the error variance, leading to increased precision in hypothesis tests regarding the main effects and the <span class="math inline">\(AB\)</span> interaction.</li>
</ol>
<p><em>Summary:</em> The mathematical derivation shows that by assuming certain interactions are zero, the model simplifies and the estimation of the remaining effects becomes more robust due to increased orthogonality and degrees of freedom.</p>
</section>
</section>
<section id="constructing-an-appropriate-model-using-interaction-graphs" class="level1">
<h1>Constructing an Appropriate Model Using Interaction Graphs</h1>
<section id="what-are-interaction-graphs" class="level2">
<h2 class="anchored" data-anchor-id="what-are-interaction-graphs">What Are Interaction Graphs?</h2>
<p>Interaction graphs provide a visual tool to decide which interactions to include in your model:</p>
<ul>
<li><strong>Nodes:</strong> Represent the factors (e.g., <em>A</em>, <em>B</em>, <em>C</em>, etc.).</li>
<li><strong>Edges:</strong> Drawn between nodes that are suspected to interact.</li>
<li><strong>Higher-Order Interactions:</strong> Triangular or complete connections among three or more nodes indicate the possibility of higher-order interactions.</li>
</ul>
</section>
<section id="steps-for-constructing-an-interaction-graph" class="level2">
<h2 class="anchored" data-anchor-id="steps-for-constructing-an-interaction-graph">Steps for Constructing an Interaction Graph</h2>
<ol type="1">
<li><p><strong>Plot the Factors:</strong> Draw points (nodes) for each factor in your experiment.</p></li>
<li><p><strong>Connect Suspected Interacting Factors:</strong> Draw a line between two nodes if you suspect a two-factor interaction.</p>
<ul>
<li>In our example, if factors <em>A</em> and <em>B</em> interact, connect them.</li>
</ul></li>
<li><p><strong>Indicate Higher-Order Interactions:</strong> If a three-factor interaction is possible, form a triangle among the three factors.</p>
<ul>
<li>If factor <em>C</em> does not interact with <em>A</em> or <em>B</em>, leave <em>C</em> disconnected from <em>A</em> and <em>B</em>.</li>
</ul></li>
<li><p><strong>Complexity for More Factors:</strong> For experiments with more than three factors, complete graphs (all nodes interconnected) suggest potential four-factor or higher interactions.</p></li>
</ol>
<p><em>Practical Implication:</em> The interaction graph visually reinforces the decision to exclude certain interactions. For instance, in our example, if <em>C</em> is not connected to <em>A</em> or <em>B</em>, it supports the assumption that the interactions involving <em>C</em> (i.e., <em>AC</em>, <em>BC</em>, and <em>ABC</em>) can be dropped from the model.</p>
<!-- ## Constructing an Appropriate Model

To determine which interactions should be included in the model, **interaction graphs** can be used:

1. **Draw points representing factors**.
2. **Connect factors that may interact** with a line.
3. **Triangular connections indicate three-factor interactions**.
4. **Complete connections suggest four-factor interactions**.

This approach helps determine the complexity of the model required for analysis. -->
</section>
</section>
<section id="analysis-with-equal-sample-sizes" class="level1">
<h1>Analysis with Equal Sample Sizes</h1>
<p>When each treatment combination has the same number of replicates (<span class="math inline">\(n\)</span>), the analysis simplifies due to balanced design properties.</p>
<section id="degrees-of-freedom-df" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom-df">Degrees of Freedom (DF)</h2>
<ul>
<li><strong>Factor A:</strong> <span class="math inline">\(a - 1\)</span></li>
<li><strong>Factor B:</strong> <span class="math inline">\(b - 1\)</span></li>
<li><strong>Interaction AB:</strong> <span class="math inline">\((a - 1)(b - 1)\)</span></li>
<li><strong>Error:</strong> <span class="math inline">\(N - ab\)</span></li>
<li><strong>Total:</strong> <span class="math inline">\(N - 1\)</span></li>
</ul>
<p>Where <span class="math inline">\(N = abn\)</span> is the total number of observations.</p>
</section>
<section id="sum-of-squares-ss" class="level2">
<h2 class="anchored" data-anchor-id="sum-of-squares-ss">Sum of Squares (SS)</h2>
<ul>
<li><strong>Total SS (<span class="math inline">\(SS_{Total}\)</span>)</strong>: Total variability in responses.</li>
<li><strong>Factor SS (<span class="math inline">\(SS_A, SS_B\)</span>)</strong>: Variability due to main effects.</li>
<li><strong>Interaction SS (<span class="math inline">\(SS_{AB}\)</span>)</strong>: Variability due to interactions.</li>
<li><strong>Error SS (<span class="math inline">\(SS_{Error}\)</span>)</strong>: Unexplained variability.</li>
</ul>
<p><span class="math display">\[
SS_{Total} = \sum (Y - \bar{Y})^2
\]</span></p>
<p><span class="math display">\[
SS_A = \sum n_i (\bar{Y}_{i..} - \bar{Y})^2
\]</span></p>
<p><span class="math display">\[
SS_{AB} = \sum n_{ij} (\bar{Y}_{ij.} - \bar{Y}_{i..} - \bar{Y}_{.j.} + \bar{Y})^2
\]</span></p>
<p><span class="math display">\[
SS_{Error} = SS_{Total} - SS_A - SS_B - SS_{AB}
\]</span></p>
<section id="mean-squares-ms" class="level3">
<h3 class="anchored" data-anchor-id="mean-squares-ms">Mean Squares (MS)</h3>
<p><span class="math display">\[
MS = \frac{SS}{DF}
\]</span></p>
</section>
<section id="anova-table-example" class="level3">
<h3 class="anchored" data-anchor-id="anova-table-example">ANOVA Table Example</h3>
<table class="table">
<colgroup>
<col style="width: 23%">
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th>F-statistic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Factor A</td>
<td><span class="math inline">\(a-1\)</span></td>
<td><span class="math inline">\(SS_A\)</span></td>
<td><span class="math inline">\(MS_A\)</span></td>
<td><span class="math inline">\(MS_A / MS_E\)</span></td>
</tr>
<tr class="even">
<td>Factor B</td>
<td><span class="math inline">\(b-1\)</span></td>
<td><span class="math inline">\(SS_B\)</span></td>
<td><span class="math inline">\(MS_B\)</span></td>
<td><span class="math inline">\(MS_B / MS_E\)</span></td>
</tr>
<tr class="odd">
<td>Interaction AB</td>
<td><span class="math inline">\((a-1)(b-1)\)</span></td>
<td><span class="math inline">\(SS_{AB}\)</span></td>
<td><span class="math inline">\(MS_{AB}\)</span></td>
<td><span class="math inline">\(MS_{AB} / MS_E\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(N - ab\)</span></td>
<td><span class="math inline">\(SS_E\)</span></td>
<td><span class="math inline">\(MS_E\)</span></td>
<td>-</td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(N - 1\)</span></td>
<td><span class="math inline">\(SS_T\)</span></td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> In unbalanced designs, Type I, II, and III sums of squares may be used to handle unequal sample sizes.</p>
</section>
</section>
</section>
<section id="interaction-effects" class="level1 page-columns page-full">
<h1>Interaction Effects</h1>
<section id="main-effects-vs.-interaction-effects" class="level2">
<h2 class="anchored" data-anchor-id="main-effects-vs.-interaction-effects">Main Effects vs.&nbsp;Interaction Effects</h2>
<ul>
<li><strong>Main Effect:</strong> The independent effect of a single factor on the response.</li>
<li><strong>Interaction Effect:</strong> Occurs when the effect of one factor depends on the level of another factor.</li>
</ul>
<section id="visualizing-interactions" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-interactions">Visualizing Interactions</h3>
<p><strong>Interaction Plots:</strong> Graphical representations where lines represent one factor’s levels across another factor’s levels.</p>
<ul>
<li><strong>Parallel Lines:</strong> Indicate no interaction; main effects are additive.</li>
<li><strong>Non-Parallel Lines:</strong> Indicate interaction; effects are dependent.</li>
</ul>
<p><strong>Example in R:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(data<span class="sc">$</span>FactorA, data<span class="sc">$</span>FactorB, data<span class="sc">$</span>Response, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretation:</strong> If lines cross or are not parallel, there is an interaction effect, meaning the impact of one factor varies with the level of the other factor.</p>
</section>
</section>
<section id="example-popcorn-microwave-experiment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="example-popcorn-microwave-experiment">Example: Popcorn-Microwave Experiment</h2>
<p><strong>Scenario:</strong> Three factors—brand (3 levels), power (2 levels), and time (3 levels)—are tested to maximize popcorn popping percentage.</p>
<p><strong>Objective:</strong> Identify the optimal combination of brand, power, and time for best popping performance.</p>
<p><strong>R Code Example:</strong></p>
<div id="tbl-popcorn-data" class="cell anchored">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"dean2017"</span>, <span class="st">"popcorn.microwave.txt"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">brand =</span> <span class="fu">factor</span>(brand, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>)),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">power =</span> <span class="fu">factor</span>(power, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"High"</span>)),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Short"</span>, <span class="st">"Medium"</span>, <span class="st">"Long"</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">PoppingRate =</span> y)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">brand</th>
<th style="text-align: left;">power</th>
<th style="text-align: left;">time</th>
<th style="text-align: right;">PoppingRate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A1</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">Short</td>
<td style="text-align: right;">73.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">A1</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">Short</td>
<td style="text-align: right;">65.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A1</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: right;">70.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">A1</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: right;">91.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A1</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">Long</td>
<td style="text-align: right;">72.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">A1</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">Long</td>
<td style="text-align: right;">81.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tbl-popcorn-anova" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-popcorn-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit three-way ANOVA model</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(PoppingRate <span class="sc">~</span> brand <span class="sc">*</span> power <span class="sc">*</span> time, <span class="at">data =</span> data)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of ANOVA</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Df Sum Sq Mean Sq F value  Pr(&gt;F)   
brand             2  331.1   165.6   1.889 0.18007   
power             1  455.1   455.1   5.192 0.03512 * 
time              2 1554.6   777.3   8.867 0.00209 **
brand:power       2  196.0    98.0   1.118 0.34854   
brand:time        4 1433.9   358.5   4.089 0.01572 * 
power:time        2   47.7    23.9   0.272 0.76484   
brand:power:time  4   47.3    11.8   0.135 0.96732   
Residuals        18 1577.9    87.7                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl quarto-uncaptioned margin-caption" id="tbl-popcorn-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1
</figcaption>
</figure>
</div>
</section>
<section id="interpreting-the-three-way-anova-results-with-consideration-of-interactions" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-three-way-anova-results-with-consideration-of-interactions">Interpreting the Three-Way ANOVA Results (With Consideration of Interactions)</h2>
<p>The ANOVA table summarizes the effects of <strong>brand, power, and time</strong> on the response variable, along with their interactions. Below is a detailed interpretation:</p>
</section>
<section id="key-findings" class="level2">
<h2 class="anchored" data-anchor-id="key-findings"><strong>Key Findings</strong></h2>
<section id="three-way-interaction" class="level3">
<h3 class="anchored" data-anchor-id="three-way-interaction"><strong>Three-Way Interaction</strong></h3>
<ul>
<li><strong><code>brand:power:time</code> (p = 0.967)</strong> → Not significant.
<ul>
<li>The combined effect of brand, power, and time does not show significant interaction.</li>
</ul></li>
</ul>
</section>
<section id="two-way-interactions" class="level3">
<h3 class="anchored" data-anchor-id="two-way-interactions"><strong>Two-Way Interactions</strong></h3>
<ul>
<li><strong><code>brand:power</code> (p = 0.349)</strong> → Not significant.
<ul>
<li>The effect of power does not change depending on the brand.</li>
</ul></li>
<li><strong><code>brand:time</code> (p = 0.016)</strong> → <strong>Significant</strong> (<em>p &lt; 0.05</em>).
<ul>
<li>The effect of brand varies across different time levels.</li>
</ul></li>
<li><strong><code>power:time</code> (p = 0.765)</strong> → Not significant.
<ul>
<li>The effect of power does not change over time.</li>
</ul></li>
</ul>
</section>
<section id="main-effects" class="level3">
<h3 class="anchored" data-anchor-id="main-effects"><strong>Main Effects</strong></h3>
<ul>
<li><strong><code>power</code> (p = 0.035)</strong> → <strong>Significant</strong> (<em>p &lt; 0.05</em>).
<ul>
<li>The level of power has a significant effect on the response.</li>
</ul></li>
</ul>
</section>
</section>
<section id="interaction-plot-1-for-three-way-interaction--popcorn-microwave-experiment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="interaction-plot-1-for-three-way-interaction--popcorn-microwave-experiment">Interaction Plot 1 for Three-Way Interaction- Popcorn-Microwave Experiment</h2>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2 interaction plot for A and B at each level of C</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> brand, <span class="at">y =</span> PoppingRate, <span class="at">color =</span> power, <span class="at">group =</span> power)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>time) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Interaction Plot for Popcorn-Microwave Experiment"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Brand"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Popping Rate"</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-popcorn-interaction-plot-1" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-popcorn-interaction-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-06_higher-order_files/figure-html/fig-popcorn-interaction-plot-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Interaction Plot for Popcorn-Microwave Experiment"><img src="week-06_higher-order_files/figure-html/fig-popcorn-interaction-plot-1-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-popcorn-interaction-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Interaction Plot for Popcorn-Microwave Experiment
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="interaction-plot-2-for-three-way-interaction--popcorn-microwave-experiment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="interaction-plot-2-for-three-way-interaction--popcorn-microwave-experiment">Interaction Plot 2 for Three-Way Interaction- Popcorn-Microwave Experiment</h2>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2 interaction plot for A and B at each level of C</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emmip</span>(fit1, time <span class="sc">~</span> brand <span class="sc">|</span> power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-popcorn-interaction-plot-2" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-popcorn-interaction-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-06_higher-order_files/figure-html/fig-popcorn-interaction-plot-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Interaction Plot for Popcorn-Microwave Experiment"><img src="week-06_higher-order_files/figure-html/fig-popcorn-interaction-plot-2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-popcorn-interaction-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Interaction Plot for Popcorn-Microwave Experiment
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model-without-non-significant-interactions" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="model-without-non-significant-interactions">Model without Non-Significant Interactions</h2>
<div id="tbl-popcorn-anova-2" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-popcorn-anova-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit three-way ANOVA model without non-significant interactions</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(PoppingRate <span class="sc">~</span> brand <span class="sc">+</span> power <span class="sc">+</span> time <span class="sc">+</span> brand<span class="sc">:</span>time, <span class="at">data =</span> data)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of ANOVA</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
brand        2  331.1   165.6   2.303 0.119991    
power        1  455.1   455.1   6.331 0.018370 *  
time         2 1554.6   777.3  10.813 0.000382 ***
brand:time   4 1433.9   358.5   4.987 0.004052 ** 
Residuals   26 1869.0    71.9                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl quarto-uncaptioned margin-caption" id="tbl-popcorn-anova-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2
</figcaption>
</figure>
</div>
</section>
<section id="post-hoc-comparisons-for-the-two-way-interaction-brandtime-simple-effects" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="post-hoc-comparisons-for-the-two-way-interaction-brandtime-simple-effects">Post-Hoc Comparisons for the Two-Way Interaction (Brand:Time) Simple Effects</h2>
<div id="tbl-popcorn-posthoc-simple" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-output-location="slide">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-popcorn-posthoc-simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>emm1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fit2, <span class="sc">~</span> brand <span class="sc">|</span> time)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(emm1, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>time = Short:
 contrast estimate SE df t.ratio p.value
 A1 - A2    -4.975  6 26  -0.830  0.6882
 A1 - A3     0.325  6 26   0.054  0.9984
 A2 - A3     5.300  6 26   0.884  0.6550

time = Medium:
 contrast estimate SE df t.ratio p.value
 A1 - A2    -4.475  6 26  -0.746  0.7384
 A1 - A3    11.400  6 26   1.902  0.1584
 A2 - A3    15.875  6 26   2.648  0.0351

time = Long:
 contrast estimate SE df t.ratio p.value
 A1 - A2    23.975  6 26   3.999  0.0013
 A1 - A3    10.175  6 26   1.697  0.2253
 A2 - A3   -13.800  6 26  -2.302  0.0733

Results are averaged over the levels of: power 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-popcorn-posthoc-simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Post Hoc Comparisons for Brand:Time Interaction
</figcaption>
</figure>
</div>
</section>
<section id="post-hoc-comparisons-for-brandtime-interaction" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-comparisons-for-brandtime-interaction"><strong>Post Hoc Comparisons for Brand:Time Interaction</strong></h2>
<section id="time-short" class="level3">
<h3 class="anchored" data-anchor-id="time-short"><strong>Time = Short</strong></h3>
<ul>
<li><strong><code>A1 - A2</code></strong>: Difference not significant (<em>p = 0.6882</em>).</li>
<li><strong><code>A1 - A3</code></strong>: Difference not significant (<em>p = 0.9984</em>).</li>
<li><strong><code>A2 - A3</code></strong>: Difference not significant (<em>p = 0.6550</em>).</li>
<li><strong>Conclusion</strong>: No significant differences in popping rate between brands at the short time level.</li>
</ul>
</section>
<section id="time-medium" class="level3">
<h3 class="anchored" data-anchor-id="time-medium"><strong>Time = Medium</strong></h3>
<ul>
<li><strong><code>A1 - A2</code></strong>: Difference not significant (<em>p = 0.7384</em>).</li>
<li><strong><code>A1 - A3</code></strong>: Difference not significant (<em>p = 0.1584</em>).</li>
<li><strong><code>A2 - A3</code></strong>: Difference significant (<em>p = 0.0351</em>).</li>
<li><strong>Conclusion</strong>: Brand A2 has a significantly higher popping rate than A1 at the medium time level.</li>
</ul>
</section>
<section id="time-long" class="level3">
<h3 class="anchored" data-anchor-id="time-long"><strong>Time = Long</strong></h3>
<ul>
<li><strong><code>A1 - A2</code></strong>: Difference significant (<em>p = 0.0013</em>).</li>
<li><strong><code>A1 - A3</code></strong>: Difference not significant (<em>p = 0.2253</em>).</li>
<li><strong><code>A2 - A3</code></strong>: Difference not significant (<em>p = 0.0733</em>).</li>
<li><strong>Conclusion</strong>: Brand A1 has a significantly higher popping rate than A2 at the long time level.</li>
</ul>
</section>
</section>
</section>
<section id="equal-sample-sizes-in-factorial-designs" class="level1 page-columns page-full">
<h1>Equal Sample Sizes in Factorial Designs</h1>
<section id="equal-sample-sizes-the-setup" class="level2">
<h2 class="anchored" data-anchor-id="equal-sample-sizes-the-setup">Equal Sample Sizes: The Setup</h2>
<p>Suppose we have an experiment with <span class="math inline">\(p\)</span> crossed factors (e.g., factors <span class="math inline">\(A, B, C, \ldots\)</span>), each having levels <span class="math inline">\(a, b, c, \ldots\)</span>. We focus on a <strong>complete model</strong> or any chosen submodel. Let the total number of replicates in each treatment combination be <span class="math inline">\(r\)</span>. Thus, each combination of factor levels has exactly <span class="math inline">\(r\)</span> observations.</p>
<p><strong>Key advantages</strong> of equal sample sizes:</p>
<ol type="1">
<li>Formulas for sums of squares and degrees of freedom are simpler.</li>
<li>Estimation of main effects and interactions via least squares takes a simpler form.</li>
<li>Sums of squares decompose additively among factors and interactions in many factorial designs.</li>
</ol>
<p>We will illustrate with a four-factor design <span class="math inline">\(A, B, C, D\)</span> (each with <span class="math inline">\(a, b, c, d\)</span> levels respectively), though the concepts generalize to any number of factors.</p>
</section>
<section id="model-description-and-terminology" class="level2">
<h2 class="anchored" data-anchor-id="model-description-and-terminology">Model Description and Terminology</h2>
<p>Consider a four-way complete model with crossed factors <span class="math inline">\(A, B, C, D\)</span>. Denote:</p>
<ul>
<li><span class="math inline">\(\mu\)</span>: overall mean</li>
<li><span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta_j\)</span>, <span class="math inline">\(\gamma_k\)</span>, <span class="math inline">\(\delta_l\)</span>: main effects for each factor, where <span class="math inline">\(i = 1,\ldots,a\)</span>, <span class="math inline">\(j = 1,\ldots,b\)</span>, <span class="math inline">\(k = 1,\ldots,c\)</span>, and <span class="math inline">\(l = 1,\ldots,d\)</span>.</li>
<li><span class="math inline">\(\alpha \beta_{ij}\)</span>, <span class="math inline">\(\alpha \gamma_{ik}\)</span>, <span class="math inline">\(\beta \gamma_{jk}\)</span>, <span class="math inline">\(\ldots\)</span>: two-way interactions</li>
<li><span class="math inline">\(\alpha \beta \gamma_{ijk}\)</span>, <span class="math inline">\(\ldots\)</span>: three-way interactions</li>
<li><span class="math inline">\(\alpha \beta \gamma \delta_{ijkl}\)</span>: four-way interaction</li>
<li><span class="math inline">\(\varepsilon_{ijklt}\)</span>: random error for observation <span class="math inline">\(t\)</span> in the <span class="math inline">\((i, j, k, l)\)</span>-th combination, where <span class="math inline">\(t = 1, \ldots, r\)</span>.</li>
</ul>
</section>
<section id="model-equation" class="level2">
<h2 class="anchored" data-anchor-id="model-equation">Model Equation</h2>
<p><span class="math display">\[
y_{ijklt}
= \mu
+ \alpha_i + \beta_j + \gamma_k + \delta_l
+ (\alpha\beta)_{ij} + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk} + \ldots
+ (\alpha\beta\gamma\delta)_{ijkl}
+ \varepsilon_{ijklt}.
\]</span></p>
<p>When sample sizes are equal <span class="math inline">\((= r)\)</span>, standard formulas for the sums of squares become more direct. If a submodel omits certain higher-order interactions (assuming they are negligible), the same patterns of degrees of freedom and sums of squares still apply, but excluding those omitted terms.</p>
</section>
<section id="degrees-of-freedom-for-factorial-effects" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom-for-factorial-effects">Degrees of Freedom for Factorial Effects</h2>
<p>For any factorial effect, the degrees of freedom (<span class="math inline">\(\nu\)</span>) is the product of “levels minus 1” across all factors included in that effect. For example, an <span class="math inline">\(A\)</span>-by-<span class="math inline">\(B\)</span>-by-<span class="math inline">\(D\)</span> interaction with factors <span class="math inline">\(A, B, D\)</span> having <span class="math inline">\(a, b, d\)</span> levels respectively yields:</p>
<p><span class="math display">\[
\nu_{ABD} = (a - 1)(b - 1)(d - 1).
\]</span></p>
<p>Similarly, a main effect <span class="math inline">\(A\)</span> alone has <span class="math inline">\(\nu_A = a - 1\)</span> degrees of freedom. This pattern continues for interactions of any order.</p>
</section>
<section id="sums-of-squares-in-factorial-models" class="level2">
<h2 class="anchored" data-anchor-id="sums-of-squares-in-factorial-models">Sums of Squares in Factorial Models</h2>
<p>If each cell (treatment combination) has <span class="math inline">\(r\)</span> observations, the sums of squares for a main effect or interaction follow a specific pattern: we take (1) the cell means averaged over subscript indices, (2) keep certain signs and expansions, and (3) sum of squares. One can write the sum of squares for an interaction, say <span class="math inline">\(ABD\)</span>, using bracketed averages:</p>
<p><span class="math display">\[
\text{SS}(ABD)
=
r \sum_{i,j,l}
\Big[
\bar{y}_{ij\cdot l\cdot} \;-\; \bar{y}_{ij\cdot\cdot\cdot}
\;-\; \bar{y}_{i\cdot\cdot l\cdot\cdot}
\;-\; \bar{y}_{\cdot j\cdot l\cdot\cdot}
\;+\; \bar{y}_{i\cdot\cdot\cdot\cdot\cdot}
\;+\; \bar{y}_{\cdot j\cdot\cdot\cdot\cdot}
\;+\; \bar{y}_{\cdot\cdot\cdot l\cdot\cdot}
\;-\; \bar{y}_{\cdot\cdot\cdot\cdot\cdot\cdot}
\Big]^2
\]</span></p>
<p>where <span class="math inline">\(\bar{y}_{ij.l\cdot}\)</span> is the average over all observations with factor <span class="math inline">\(A\)</span> at level <span class="math inline">\(i\)</span>, <span class="math inline">\(B\)</span> at level <span class="math inline">\(j\)</span>, <span class="math inline">\(D\)</span> at level <span class="math inline">\(l\)</span>, and “<span class="math inline">\(\cdot\)</span>” means averaging over all other subscripts (like factor <span class="math inline">\(C\)</span> and replicate index <span class="math inline">\(t\)</span>). Each bracketed difference is then squared and summed over all relevant combinations <span class="math inline">\(i, j, l\)</span>.</p>
<p>For a main effect or any other interaction, the same principle applies: we expand the parentheses with the correct pattern of plus and minus signs, average out the indices that do not appear, square the bracket, and multiply by <span class="math inline">\(r\)</span> (or by some factor depending on the number of levels omitted).</p>
</section>
<section id="total-sum-of-squares-and-error" class="level2">
<h2 class="anchored" data-anchor-id="total-sum-of-squares-and-error">Total Sum of Squares and Error</h2>
<p>The total sum of squares,</p>
<p><span class="math display">\[
\text{SS}_{\text{Total}}
= \sum_{i,j,k,l,t}
\bigl(y_{ijklt} - \bar{y}_{\cdot\cdot\cdot\cdot\cdot}\bigr)^2,
\]</span></p>
<p>splits into sums of squares for factors and interactions plus the residual (or error) sum of squares,</p>
<p><span class="math display">\[
\text{SS}_E
= \text{SS}_{\text{tot}}
-
\bigl[\text{SS}_A + \text{SS}_B + \cdots + \text{SS}(\text{AB}) + \cdots + \text{SS}(\text{ABCD})\bigr].
\]</span></p>
<p>With equal sample sizes, each effect sum of squares has an interpretation corresponding to “how much variability that effect and its sub-interactions explain,” and the remainder is attributed to the residual error.</p>
</section>
<section id="mean-squares-and-f-statistics" class="level2">
<h2 class="anchored" data-anchor-id="mean-squares-and-f-statistics">Mean Squares and F-Statistics</h2>
<p>For an effect <span class="math inline">\(E\)</span> (e.g.&nbsp;a main effect or an interaction), the mean square is:</p>
<p><span class="math display">\[
\text{MS}(E)
=
\frac{\text{SS}(E)}{\nu_E},
\]</span></p>
<p>where <span class="math inline">\(\nu_E\)</span> is the degrees of freedom for that effect. Similarly, the error mean square is:</p>
<p><span class="math display">\[
\text{MS}(E) = \frac{\text{SS}(E)}{\nu_E},
\]</span></p>
<p>where <span class="math inline">\(\nu_E\)</span> is the error degrees of freedom.</p>
<p>To test whether a factorial effect is negligible, we form an F-ratio:</p>
<p><span class="math display">\[
F = \frac{\text{MS}(E)}{\text{MS}_E},
\]</span></p>
<p>and compare with an <span class="math inline">\(F\)</span>-distribution with <span class="math inline">\(\nu_E\)</span> (effect) and <span class="math inline">\(\nu_E\)</span> (error) degrees of freedom at a chosen significance level <span class="math inline">\(\alpha\)</span>.</p>
</section>
<section id="contrasts-estimable-functions-and-confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="contrasts-estimable-functions-and-confidence-intervals">Contrasts, Estimable Functions, and Confidence Intervals</h2>
<p>An <strong>estimable contrast</strong> for a factorial effect is a linear combination of relevant parameters whose coefficients sum to zero across each subscript index. Under equal sample sizes, the least squares estimate is obtained by substituting cell means for each parameter term. The sum of squares associated to testing that a specific contrast is zero is the square of the normalized contrast estimate.</p>
<p>Simultaneous confidence intervals for main effects, interactions, or contrasts can be constructed using methods such as Bonferroni, Scheffé, Tukey, or Dunnett, adjusting critical values as appropriate.</p>
</section>
<section id="numerical-example-in-r" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="numerical-example-in-r">Numerical Example in R</h2>
<p>We will illustrate the analysis of a four-way factorial design with equal sample sizes. Suppose each factor <span class="math inline">\(A, B, C, D\)</span> has 2 levels, resulting in <span class="math inline">\(2^4 = 16\)</span> cells, each with <span class="math inline">\(r = 3\)</span> observations. Let us simulate the data in R and perform the standard ANOVA.</p>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data for a 2^4 factorial with equal sample size r = 3</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># True means to illustrate a possible scenario</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">16</span> <span class="sc">*</span> <span class="dv">3</span> <span class="co"># total observations</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose factors A, B, C, D each with 2 levels: coded as 0,1 for simplicity</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll generate a design matrix with 16 unique rows</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">8</span>), <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">4</span>, <span class="at">times =</span> <span class="dv">2</span>), <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">2</span>, <span class="at">times =</span> <span class="dv">4</span>), <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">times =</span> <span class="dv">8</span>), <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's set up a plausible model</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># y = grand mean + A + B + ... + AB + AD + ... + noise</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>grand_mean <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>a_eff <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>b_eff <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>c_eff <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>d_eff <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>ab_eff <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>ac_eff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>bc_eff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>ad_eff <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.8</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>bd_eff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>cd_eff <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>abcd_eff <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate response</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>y_mean <span class="ot">&lt;-</span> grand_mean <span class="sc">+</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    a_eff <span class="sc">*</span> A <span class="sc">+</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    b_eff <span class="sc">*</span> B <span class="sc">+</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    c_eff <span class="sc">*</span> C <span class="sc">+</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    d_eff <span class="sc">*</span> D <span class="sc">+</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    ab_eff <span class="sc">*</span> A <span class="sc">*</span> B <span class="sc">+</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    ac_eff <span class="sc">*</span> A <span class="sc">*</span> C <span class="sc">+</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    bc_eff <span class="sc">*</span> B <span class="sc">*</span> C <span class="sc">+</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    ad_eff <span class="sc">*</span> A <span class="sc">*</span> D <span class="sc">+</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    bd_eff <span class="sc">*</span> B <span class="sc">*</span> D <span class="sc">+</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    cd_eff <span class="sc">*</span> C <span class="sc">*</span> D <span class="sc">+</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    abcd_eff <span class="sc">*</span> A <span class="sc">*</span> B <span class="sc">*</span> C <span class="sc">*</span> D</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Add random error</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> y_mean <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="fu">factor</span>(A),</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">B =</span> <span class="fu">factor</span>(B),</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">C =</span> <span class="fu">factor</span>(C),</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">D =</span> <span class="fu">factor</span>(D),</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-factorial-example-data" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-output-location="slide">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-factorial-example-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">A</th>
<th style="text-align: left;">B</th>
<th style="text-align: left;">C</th>
<th style="text-align: left;">D</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">8.189401</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">10.916144</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">14.626662</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">10.681453</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">9.643687</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">10.259084</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-factorial-example-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Simulated Data for a 2^4 Factorial Design
</figcaption>
</figure>
</div>
</div>
<section id="explanation" class="level3">
<h3 class="anchored" data-anchor-id="explanation">Explanation:</h3>
<ol type="1">
<li>We coded the factors as 0 or 1 for simulation, though in practice we can name them “A1, A2” etc.</li>
<li>We assigned main effects to A, B, C, D, plus certain interactions. We then added random noise with standard deviation 1.5.</li>
</ol>
</section>
</section>
<section id="anova-results-for-the-24-factorial-design" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="anova-results-for-the-24-factorial-design">ANOVA Results for the 2^4 Factorial Design</h2>
<div id="tbl-factorial-anova-results-2" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-output-location="slide">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-factorial-anova-results-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fit_full_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> A <span class="sc">*</span> B <span class="sc">*</span> C <span class="sc">*</span> D, <span class="at">data =</span> my_data)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_full_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
A            1  67.91   67.91  29.178 6.17e-06 ***
B            1   0.02    0.02   0.007   0.9331    
C            1 163.51  163.51  70.255 1.41e-09 ***
D            1   0.23    0.23   0.101   0.7532    
A:B          1   7.84    7.84   3.367   0.0758 .  
A:C          1   0.06    0.06   0.026   0.8731    
B:C          1   0.42    0.42   0.179   0.6748    
A:D          1  12.94   12.94   5.560   0.0247 *  
B:D          1   0.22    0.22   0.095   0.7604    
C:D          1   1.07    1.07   0.459   0.5031    
A:B:C        1   0.42    0.42   0.180   0.6741    
A:B:D        1   0.49    0.49   0.210   0.6502    
A:C:D        1   0.00    0.00   0.001   0.9710    
B:C:D        1   0.40    0.40   0.171   0.6816    
A:B:C:D      1   1.61    1.61   0.693   0.4114    
Residuals   32  74.47    2.33                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-factorial-anova-results-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: ANOVA Results for the 2^4 Factorial Design
</figcaption>
</figure>
</div>
<section id="explanation-1" class="level3">
<h3 class="anchored" data-anchor-id="explanation-1">Explanation:</h3>
<ol type="1">
<li>We fit the <strong>complete</strong> 4-way factorial model in R: <code>lm(y ~ A * B * C * D)</code>.</li>
<li>The ANOVA table from <code>anova(fit_full)</code> partitions the total sum of squares into main effects (A, B, C, D), two-way interactions (A:B, A:C, B:C, etc.), up to the 4-way interaction (A:B:C:D), plus the residual or error.</li>
</ol>
<p>Running this snippet in R yields sums of squares for each effect, degrees of freedom, mean squares, <span class="math inline">\(F\)</span>-statistics, and p-values. We can easily see which effects are significant and draw conclusions accordingly.</p>
</section>
</section>
<section id="guidelines-for-analysis-and-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="guidelines-for-analysis-and-interpretation">Guidelines for Analysis and Interpretation</h2>
<ol type="1">
<li><strong>Check Interactions</strong>: Always examine higher-order interactions first. If they are negligible, remove them from the model for simplicity and improved precision on lower-order terms.</li>
<li><strong>Check Residual Diagnostics</strong>: Plot residuals versus fitted values, check normal Q–Q plots, etc., to verify that assumptions are not severely violated.</li>
<li><strong>Conduct F-tests</strong>: Evaluate significance of main effects and interactions via the standard ANOVA approach.</li>
<li><strong>Multiple Comparisons</strong>: If needed, build simultaneous confidence intervals for main effects or factor level means, using Tukey, Bonferroni, Scheffé, or Dunnett methods to maintain appropriate error rates.</li>
<li><strong>Factor Collapse</strong>: If factor interactions are not present, you can “collapse” factor levels to a simpler design or analysis. Equal cell sizes make these collapses straightforward.</li>
<li><strong>Practical Significance</strong>: Consider not just p-values but effect sizes to determine whether a factor or interaction is meaningful in practice.</li>
</ol>
</section>
<section id="advanced-section-higher-order-interactions-and-orthogonal-decompositions" class="level2">
<h2 class="anchored" data-anchor-id="advanced-section-higher-order-interactions-and-orthogonal-decompositions">Advanced Section: Higher-Order Interactions and Orthogonal Decompositions</h2>
<p>When the design is balanced (equal <span class="math inline">\(r\)</span>), the sums of squares due to main effects and interactions are <strong>orthogonal</strong> decompositions of the total variability. This orthogonality simplifies the structure of the F-tests. In advanced problems:</p>
<ul>
<li>One can form a partial or incomplete model if some interactions are considered negligible.</li>
<li>One can compute sums of squares for a submodel easily by dropping negligible effects from the complete model.</li>
<li>In unbalanced settings, computations become more complex, often requiring specialized regression-based formulas or computational software to obtain Type I, II, or III sums of squares (Montgomery 2020, Christensen 2018).</li>
</ul>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<ol type="1">
<li><strong>Concept Check</strong> Suppose you have a 3-factor design <span class="math inline">\(A, B, C\)</span> with levels <span class="math inline">\(a=3, b=2, c=2\)</span> and each cell has <span class="math inline">\(r=4\)</span> observations.
<ol type="a">
<li>What is the total number of observations?</li>
<li>Write the degrees of freedom for each main effect and each interaction.</li>
<li>Show how you would write the sum of squares formula for <span class="math inline">\(ABC\)</span>.</li>
</ol></li>
<li><strong>Manual Computation</strong> Consider a 2-factor design <span class="math inline">\(A, B\)</span> each with 2 levels (<span class="math inline">\(a=2, b=2\)</span>) and <span class="math inline">\(r=3\)</span> observations per cell. The four cell means are:</li>
</ol>
<p><span class="math display">\[
\bar{y}_{11.} = 12,\quad \bar{y}_{12.} = 15,\quad \bar{y}_{21.} = 14,\quad \bar{y}_{22.} = 20.
\]</span></p>
<ol type="a">
<li>Compute the sums of squares for <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(AB\)</span> using the “plus-minus” expansions.<br>
</li>
<li>Verify that their sum plus ss(error) equals the total sum of squares.</li>
</ol>
<ol start="3" type="1">
<li><strong>R Analysis</strong><br>
Simulate a 3-factor balanced design with factors <span class="math inline">\(A, B, C\)</span> each at 3 levels, with <span class="math inline">\(r=2\)</span> observations in each cell. Introduce known main effects and interactions in your data-generating code. Then
<ol type="a">
<li>Fit the full factorial model.<br>
</li>
<li>Examine the significance of each main effect and interaction.<br>
</li>
<li>Provide conclusions and interpret in context.</li>
</ol></li>
<li><strong>Interaction Plots</strong><br>
Suppose in a 3-factor design <span class="math inline">\(A, B, C\)</span> with equal sample sizes, you suspect a strong <span class="math inline">\(AB\)</span> interaction but negligible <span class="math inline">\(BC\)</span> and <span class="math inline">\(AC\)</span> interactions. Write the “rules” for the degrees of freedom and the sum of squares for <span class="math inline">\((AB)\)</span>. Provide a short explanation of how you would confirm or refute the presence of <span class="math inline">\(AB\)</span> interaction in the data.</li>
</ol>
</section>
</section>
<section id="handling-unequal-sample-sizes" class="level1">
<h1>Handling Unequal Sample Sizes</h1>
<p>Unequal replication across treatment combinations complicates the analysis, as it introduces imbalance in data. Proper handling ensures accurate estimation and inference.</p>
<section id="types-of-sums-of-squares" class="level2">
<h2 class="anchored" data-anchor-id="types-of-sums-of-squares">Types of Sums of Squares</h2>
<ul>
<li><strong>Type I (Sequential):</strong> Tests factors sequentially, dependent on the order of entry.</li>
<li><strong>Type II (Marginal):</strong> Tests main effects after accounting for other main effects but ignoring interactions.</li>
<li><strong>Type III (Conditional):</strong> Tests main effects after accounting for all other factors, including interactions.</li>
</ul>
<p><strong>R Implementation with <code>car</code> Package:</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANOVA model</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC, <span class="at">data =</span> data)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Type II Sums of Squares</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit, <span class="at">type=</span><span class="st">"II"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Type III Sums of Squares</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit, <span class="at">type=</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Considerations:</strong></p>
<ul>
<li><strong>Type III</strong> is commonly used in software like SAS and SPSS, especially when interactions are present.</li>
<li><strong>Type II</strong> is suitable when interactions are not of primary interest.</li>
</ul>
<p><strong>References:</strong> Christensen (2018) provides an in-depth discussion on handling unbalanced designs and choosing appropriate sums of squares.</p>
</section>
</section>
<section id="real-world-application-in-r" class="level1 page-columns page-full">
<h1>Real-World Application in R</h1>
<section id="three-way-anova-example" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="three-way-anova-example">Three-Way ANOVA Example</h2>
<p>To illustrate these concepts, let’s walk through a three-way ANOVA example and use R’s <strong><code>emmeans</code></strong> package to conduct simple effects analysis and probe interactions. We will use a dataset from a (fictional but realistic) experiment on memory retention (<a href="https://edsm.rbind.io/example/threewayanova#:~:text=There%20are%20three%20factors%3A%20the,to%20study%20both%20age%20groups">Three-way analysis of variance – Experimental Designs and Statistical Methods</a>). In this study, researchers manipulated:</p>
<ul>
<li><strong>Feedback</strong> given during learning (Factor A with levels: <em>none</em>, <em>positive</em>, <em>negative</em>),</li>
<li><strong>Type of learning material</strong> (Factor B with levels: <em>low freq/low emotion words</em>, <em>high freq/low emotion</em>, <em>high freq/high emotion</em>),</li>
<li><strong>Age group</strong> of participants (Factor C with levels: <em>fifth graders</em> vs.&nbsp;<em>high school seniors</em>).</li>
</ul>
<p>The outcome is the number of words recalled one week later. There are <span class="math inline">\(3 \times 3 \times 2 = 18\)</span> experimental conditions (cells), with a balanced design of <span class="math inline">\(n=5\)</span> participants per cell (90 observations total) (<a href="https://edsm.rbind.io/example/threewayanova#:~:text=%2C%20%2C%20material%20%3D%20high,freq%2Fhigh%20emotion">Three-way analysis of variance – Experimental Designs and Statistical Methods</a>). We fit a three-way ANOVA to this data and then examine simple effects.</p>
<div id="tbl-code-words-example" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-code-words-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(words, <span class="at">package =</span> <span class="st">"hecedsm"</span>) <span class="co"># hypothetical dataset from Keppel &amp; Wickens (2004)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(words <span class="sc">~</span> feedback <span class="sc">+</span> material <span class="sc">+</span> age, <span class="at">data =</span> words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , age = fifth grade

          material
feedback   low freq/low emotion high freq/low emotion high freq/high emotion
  none                       42                    44                     40
  positive                   39                    40                     22
  negative                   40                    38                     19

, , age = senior

          material
feedback   low freq/low emotion high freq/low emotion high freq/high emotion
  none                       42                    44                     39
  positive                   40                    41                     37
  negative                   42                    40                     35</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-code-words-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Hypothetical Dataset from Keppel &amp; Wickens (2004)
</figcaption>
</figure>
</div>
</section>
<section id="r-code-for-three-way-anova" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="r-code-for-three-way-anova">R Code for Three-Way ANOVA</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data and fit three-way ANOVA model</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(words <span class="sc">~</span> feedback <span class="sc">*</span> material <span class="sc">*</span> age, <span class="at">data =</span> words)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-code-threeway-anova-example" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-code-threeway-anova-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">feedback</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">26.86667</td>
<td style="text-align: right;">13.433333</td>
<td style="text-align: right;">7.111765</td>
<td style="text-align: right;">0.0015186</td>
</tr>
<tr class="even">
<td style="text-align: left;">material</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">64.86667</td>
<td style="text-align: right;">32.433333</td>
<td style="text-align: right;">17.170588</td>
<td style="text-align: right;">0.0000008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14.40000</td>
<td style="text-align: right;">14.400000</td>
<td style="text-align: right;">7.623529</td>
<td style="text-align: right;">0.0073041</td>
</tr>
<tr class="even">
<td style="text-align: left;">feedback:material</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.66667</td>
<td style="text-align: right;">3.666667</td>
<td style="text-align: right;">1.941177</td>
<td style="text-align: right;">0.1128292</td>
</tr>
<tr class="odd">
<td style="text-align: left;">feedback:age</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8.60000</td>
<td style="text-align: right;">4.300000</td>
<td style="text-align: right;">2.276471</td>
<td style="text-align: right;">0.1099872</td>
</tr>
<tr class="even">
<td style="text-align: left;">material:age</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">16.20000</td>
<td style="text-align: right;">8.100000</td>
<td style="text-align: right;">4.288235</td>
<td style="text-align: right;">0.0173970</td>
</tr>
<tr class="odd">
<td style="text-align: left;">feedback:material:age</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10.00000</td>
<td style="text-align: right;">2.500000</td>
<td style="text-align: right;">1.323529</td>
<td style="text-align: right;">0.2694608</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">136.00000</td>
<td style="text-align: right;">1.888889</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-code-threeway-anova-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: R Code for Three-Way ANOVA Example
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="probling-three-way-interaction-illustrative" class="level1 page-columns page-full">
<h1>Probling Three-Way Interaction (Illustrative)</h1>
<section id="three-way-interaction-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="three-way-interaction-interpretation">Three Way Interaction Interpretation</h2>
<p>For padagogial purposes, we examine the three-way interaction between material type, feedback, and age group. We will use the <code>emmeans</code> package to probe the interaction.</p>
</section>
<section id="simple-effects-analysis" class="level2">
<h2 class="anchored" data-anchor-id="simple-effects-analysis">Simple Effects Analysis</h2>
<p><strong>Simple Two-Way Interactions at Each Level of C:</strong> The significant material×age interaction means the difference in recall between material types is different for fifth graders versus seniors. We can explore this by testing the <strong>simple two-way effect of material × feedback within each age group</strong>. Essentially, we split the analysis by age to see how the other factors behave for each subgroup (<a href="https://www.ou.edu/faculty/M/Jorge.L.Mendoza-1/psy5013/Three-way%20ANOVAr.pdf#:~:text=%E2%80%A2%20ABC%20is%20NOT%20significant%2C,hoc%20%28or%20planned%29%20comparisons">Microsoft PowerPoint - Three-way ANOVAr.ppt</a>).</p>
<p>We will use the <code>emmeans</code> package to probe the interaction.</p>
</section>
<section id="ls-means-for-material-and-feedback-by-age-group" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="ls-means-for-material-and-feedback-by-age-group">LS Means for Material and Feedback by Age Group</h2>
<div id="tbl-ls-means-by-age" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-ls-means-by-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>emm_material_feedback_by_age <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> material <span class="sc">*</span> feedback <span class="sc">|</span> age)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>emm_material_feedback_by_age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>age = fifth grade:
 material               feedback emmean    SE df lower.CL upper.CL
 low freq/low emotion   none        8.4 0.615 72     7.17     9.63
 high freq/low emotion  none        8.8 0.615 72     7.57    10.03
 high freq/high emotion none        8.0 0.615 72     6.77     9.23
 low freq/low emotion   positive    7.8 0.615 72     6.57     9.03
 high freq/low emotion  positive    8.0 0.615 72     6.77     9.23
 high freq/high emotion positive    4.4 0.615 72     3.17     5.63
 low freq/low emotion   negative    8.0 0.615 72     6.77     9.23
 high freq/low emotion  negative    7.6 0.615 72     6.37     8.83
 high freq/high emotion negative    3.8 0.615 72     2.57     5.03

age = senior:
 material               feedback emmean    SE df lower.CL upper.CL
 low freq/low emotion   none        8.4 0.615 72     7.17     9.63
 high freq/low emotion  none        8.8 0.615 72     7.57    10.03
 high freq/high emotion none        7.8 0.615 72     6.57     9.03
 low freq/low emotion   positive    8.0 0.615 72     6.77     9.23
 high freq/low emotion  positive    8.2 0.615 72     6.97     9.43
 high freq/high emotion positive    7.4 0.615 72     6.17     8.63
 low freq/low emotion   negative    8.4 0.615 72     7.17     9.63
 high freq/low emotion  negative    8.0 0.615 72     6.77     9.23
 high freq/high emotion negative    7.0 0.615 72     5.77     8.23

Confidence level used: 0.95 </code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-ls-means-by-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Least-Squares Means by Age Group
</figcaption>
</figure>
</div>
</section>
<section id="r-code-for-simple-effects-of-material-and-feedback-by-age-group" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="r-code-for-simple-effects-of-material-and-feedback-by-age-group">R Code for Simple Effects of Material and Feedback by Age Group</h2>
<p>In R, the <code>emmeans::joint_tests()</code> function conveniently provides tests analogous to an ANOVA for specified slices of the data. We use the <code>by</code> argument to get separate tests for each age level. This produces two separate ANOVA summaries, one for each age group.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>emm_material_feedback_by_age <span class="sc">|&gt;</span> <span class="fu">joint_tests</span>(<span class="at">by =</span> <span class="st">"age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-simple-effects-material-age" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-simple-effects-material-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">model term</th>
<th style="text-align: left;">age</th>
<th style="text-align: right;">df1</th>
<th style="text-align: right;">df2</th>
<th style="text-align: right;">F.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">material</td>
<td style="text-align: left;">fifth grade</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">19.306</td>
<td style="text-align: right;">0.0000002</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">material</td>
<td style="text-align: left;">senior</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">2.153</td>
<td style="text-align: right;">0.1235609</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: left;">feedback</td>
<td style="text-align: left;">fifth grade</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">8.718</td>
<td style="text-align: right;">0.0004071</td>
</tr>
<tr class="even">
<td style="text-align: left;">31</td>
<td style="text-align: left;">feedback</td>
<td style="text-align: left;">senior</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">0.5145724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">material:feedback</td>
<td style="text-align: left;">fifth grade</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">3.088</td>
<td style="text-align: right;">0.0209781</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">material:feedback</td>
<td style="text-align: left;">senior</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right;">0.9498252</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-simple-effects-material-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Simple Effects of Material by Age Group
</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The degrees of freedom for error (df2) remain 72 for each slice because we are using the pooled residual from the full model as the error term.</p>
</div>
</div>
<p>Let’s interpret these results.</p>
</section>
<section id="interpreting-the-simple-effects-analysis" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-simple-effects-analysis">Interpreting the Simple Effects Analysis</h2>
<section id="fifth-graders" class="level3">
<h3 class="anchored" data-anchor-id="fifth-graders">Fifth Graders:</h3>
<ul>
<li><strong>Feedback × Material:</strong> Significant interaction (p ≈ 0.021).</li>
<li><strong>Interpretation:</strong> Both feedback and material type significantly affect recall in fifth graders, with a possible interaction between the two.</li>
<li><strong>Follow-Up:</strong> We will probe the material effect further.</li>
</ul>
</section>
<section id="high-school-seniors" class="level3">
<h3 class="anchored" data-anchor-id="high-school-seniors">High School Seniors:</h3>
<ul>
<li><strong>Note:</strong> The feedback × material interaction is not significant in seniors.</li>
</ul>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary:</h3>
<ul>
<li>In fifth graders, both feedback and material significantly affect recall, with a possible interaction.</li>
<li>In high school seniors, neither feedback nor material significantly affects recall.</li>
</ul>
</section>
</section>
<section id="probing-simple-effects-of-material-and-feedback-for-fifth-graders" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="probing-simple-effects-of-material-and-feedback-for-fifth-graders">Probing Simple Effects of Material and Feedback for Fifth Graders</h2>
<p>The code below is more elegant and efficient than running multiple pairwise comparisons. It provides a comprehensive summary of the pairwise differences between material types for fifth graders.</p>
<div id="tbl-simple-effects-material-age-pairs-fifth" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-simple-effects-material-age-pairs-fifth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>emm_material_feedback_by_age_fifth <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    model,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> material <span class="sc">|</span> feedback <span class="sc">*</span> age,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">at =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="st">"fifth grade"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_material_feedback_by_age_fifth, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>feedback = none, age = fifth grade:
 contrast                                           estimate    SE df t.ratio
 (low freq/low emotion) - (high freq/low emotion)       -0.4 0.869 72  -0.460
 (low freq/low emotion) - (high freq/high emotion)       0.4 0.869 72   0.460
 (high freq/low emotion) - (high freq/high emotion)      0.8 0.869 72   0.920
 p.value
  0.8900
  0.8900
  0.6293

feedback = positive, age = fifth grade:
 contrast                                           estimate    SE df t.ratio
 (low freq/low emotion) - (high freq/low emotion)       -0.2 0.869 72  -0.230
 (low freq/low emotion) - (high freq/high emotion)       3.4 0.869 72   3.912
 (high freq/low emotion) - (high freq/high emotion)      3.6 0.869 72   4.142
 p.value
  0.9712
  0.0006
  0.0003

feedback = negative, age = fifth grade:
 contrast                                           estimate    SE df t.ratio
 (low freq/low emotion) - (high freq/low emotion)        0.4 0.869 72   0.460
 (low freq/low emotion) - (high freq/high emotion)       4.2 0.869 72   4.832
 (high freq/low emotion) - (high freq/high emotion)      3.8 0.869 72   4.372
 p.value
  0.8900
  &lt;.0001
  0.0001

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-simple-effects-material-age-pairs-fifth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: Simple Effects of Material by Age Group
</figcaption>
</figure>
</div>
<section id="summary-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-1">Summary:</h3>
<ul>
<li><strong>Fifth Graders:</strong> Recall significantly differs between low/low and high/low, and between low/low and high/high materials. The high/high material yields the highest recall.</li>
<li><strong>High School Seniors:</strong> Recall does not significantly differ between material types.</li>
<li><strong>Interpretation:</strong> The material type significantly affects recall in fifth graders, with the high/high material showing the highest recall. In contrast, material type does not significantly affect high school seniors’ recall.</li>
</ul>
</section>
</section>
</section>
<section id="probling-two-way-interactions" class="level1 page-columns page-full">
<h1>Probling Two-Way Interactions</h1>
<section id="interpreting-the-two-way-anova-results" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-two-way-anova-results">Interpreting the Two-Way ANOVA Results</h2>
<p>According to the principles discussed, since the three-way interaction is not significant, we do not necessarily have to probe a three-way pattern. However, we <em>do</em> have a significant two-way interaction (material × age). This suggests the effect of material type on memory depends on age group (or vice versa). We will demonstrate simple effects for that two-way interaction. This will show the workflow for probing interactions using <code>emmeans</code>.</p>
</section>
<section id="reduced-model-for-two-way-interaction-material-age" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="reduced-model-for-two-way-interaction-material-age">Reduced Model for Two-Way Interaction (Material × Age)</h2>
<p>We will demonstrate simple effects for that two-way interaction.</p>
<div id="tbl-two-way-interaction-material-age-model" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-two-way-interaction-material-age-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit two-way interaction model for material × age</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>model_material_age <span class="ot">&lt;-</span> <span class="fu">aov</span>(words <span class="sc">~</span> feedback <span class="sc">+</span> material <span class="sc">*</span> age, <span class="at">data =</span> words)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_material_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
feedback      2  26.87   13.43   6.508  0.00238 ** 
material      2  64.87   32.43  15.712 1.67e-06 ***
age           1  14.40   14.40   6.976  0.00989 ** 
material:age  2  16.20    8.10   3.924  0.02358 *  
Residuals    82 169.27    2.06                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-two-way-interaction-material-age-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Two-Way Interaction Model for Material × Age
</figcaption>
</figure>
</div>
</section>
<section id="simple-effects-analysis-for-material-age-interaction" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="simple-effects-analysis-for-material-age-interaction">Simple Effects Analysis for Material × Age Interaction</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>emm_material_by_age <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> material <span class="sc">|</span> age)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>emm_material_by_age <span class="sc">|&gt;</span> <span class="fu">joint_tests</span>(<span class="at">by =</span> <span class="st">"age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-simple-effects-material-age-" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-simple-effects-material-age--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">model term</th>
<th style="text-align: left;">age</th>
<th style="text-align: right;">df1</th>
<th style="text-align: right;">df2</th>
<th style="text-align: right;">F.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">material</td>
<td style="text-align: left;">fifth grade</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">19.306</td>
<td style="text-align: right;">0.0000002</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">material</td>
<td style="text-align: left;">senior</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">2.153</td>
<td style="text-align: right;">0.1235609</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-simple-effects-material-age--caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: Simple Effects of Material by Age Group
</figcaption>
</figure>
</div>
</div>
<p>The results suggest that the difference in recall between material types is different for fifth graders versus seniors. For the fifth graders, material appears to have an effect on recall, whereas for seniors, material appears to have no significant effect on recall.</p>
</section>
<section id="probing-simple-effects-of-material-by-age" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="probing-simple-effects-of-material-by-age">Probing Simple Effects of Material by Age</h2>
<div id="tbl-simple-effects-material-age-pairs" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-simple-effects-material-age-pairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_material_by_age, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>age = fifth grade:
 contrast                                           estimate    SE df t.ratio
 (low freq/low emotion) - (high freq/low emotion)    -0.0667 0.502 72  -0.133
 (low freq/low emotion) - (high freq/high emotion)    2.6667 0.502 72   5.314
 (high freq/low emotion) - (high freq/high emotion)   2.7333 0.502 72   5.447
 p.value
  0.9903
  &lt;.0001
  &lt;.0001

age = senior:
 contrast                                           estimate    SE df t.ratio
 (low freq/low emotion) - (high freq/low emotion)    -0.0667 0.502 72  -0.133
 (low freq/low emotion) - (high freq/high emotion)    0.8667 0.502 72   1.727
 (high freq/low emotion) - (high freq/high emotion)   0.9333 0.502 72   1.860
 p.value
  0.9903
  0.2022
  0.1579

Results are averaged over the levels of: feedback 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-simple-effects-material-age-pairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13: Simple Effects of Material by Age Group
</figcaption>
</figure>
</div>
<p>Upon further probing of the interaction, we see that the effect of material type on recall differs between the two age groups. For the fifth graders, the high-frequency/high-emotion material (let’s call it the “difficult material”) yields the highest recall, whereas for seniors, material type does not have a significant effect on recall.</p>
</section>
<section id="summary-2" class="level2">
<h2 class="anchored" data-anchor-id="summary-2">Summary</h2>
<ul>
<li><strong>Fifth Graders:</strong> Recall significantly differs between low/low and high/low, and between low/low and high/high materials. The high/high material yields the highest recall.</li>
<li><strong>High School Seniors:</strong> Recall does not significantly differ between material types.</li>
</ul>
<p>The results of the simple effects analysis show that the material type significantly affects recall in fifth graders, with the high-frequency/high-emotion material (let’s call it the “difficult material”) yielding the highest recall. In contrast, material type does not significantly affect high school seniors’ recall. The significant interaction between material and age suggests that the effect of material type on memory retention differs between the two age groups. Specifically, the high-frequency/high-emotion material has a more pronounced impact on recall for fifth graders compared to high school seniors. This finding highlights the importance of considering age-specific factors when designing educational interventions or memory enhancement strategies.</p>
</section>
</section>
<section id="advanced-analysis-techniques" class="level1">
<h1>Advanced Analysis Techniques</h1>
<!-- ## Handling Three-Factor Interactions

In higher-order designs, interactions can involve three or more factors, complicating interpretation.

### Three-Factor Interaction

Occurs when the two-factor interaction between two factors depends on the level of a third factor.

**Interpretation:**
If the two-factor interaction between Factors A and B changes across levels of Factor C, a three-factor interaction is present.

### Example in R

```r
# Fit three-way ANOVA model
fit <- aov(Response ~ FactorA * FactorB * FactorC, data = data)

# Summary of ANOVA
summary(fit)

# Three-factor interaction plot
library(ggplot2)
ggplot(data, aes(x=FactorA, y=Response, color=FactorB, linetype=FactorC)) +
geom_point() +
geom_line() +
labs(title="Three-Factor Interaction Plot")
```

**Interpretation:**
Assess if the lines representing different levels of Factor B change across Factor C levels, indicating an interaction. -->
<section id="addressing-complex-interactions" class="level2">
<h2 class="anchored" data-anchor-id="addressing-complex-interactions">Addressing Complex Interactions</h2>
<section id="higher-order-interactions-1" class="level3">
<h3 class="anchored" data-anchor-id="higher-order-interactions-1">Higher-Order Interactions</h3>
<p>Beyond three factors, interactions become increasingly complex and harder to interpret. It’s essential to focus on interactions that make theoretical sense and are supported by the data.</p>
</section>
<section id="simplifying-the-model" class="level3">
<h3 class="anchored" data-anchor-id="simplifying-the-model">Simplifying the Model</h3>
<ul>
<li><p><strong>Model Selection:</strong> Start with a full model including all interactions. If higher-order interactions are not significant, consider removing them for simpler interpretation.</p></li>
<li><p><strong>Hierarchical Models:</strong> Retain lower-order interactions when higher-order interactions are present, but omit higher-order interactions if lower-order ones are not significant.</p></li>
</ul>
<p><strong>Example in R:</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>full_fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC, <span class="at">data =</span> data)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduced model without three-way interaction</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>reduced_fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">+</span> FactorA <span class="sc">*</span> FactorC <span class="sc">+</span> FactorB <span class="sc">*</span> FactorC, <span class="at">data =</span> data)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(reduced_fit, full_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="diagnostic-tools-and-assumptions-checking" class="level1">
<h1>Diagnostic Tools and Assumptions Checking</h1>
<p>Ensuring the validity of ANOVA results requires checking model assumptions.</p>
<section id="residual-analysis" class="level2">
<h2 class="anchored" data-anchor-id="residual-analysis">Residual Analysis</h2>
<p>Residuals (<span class="math inline">\(e_{ijkt}\)</span>) are the differences between observed and predicted values. Analyzing residuals helps detect violations of model assumptions.</p>
<section id="residual-plots" class="level3">
<h3 class="anchored" data-anchor-id="residual-plots">Residual Plots</h3>
<ol type="1">
<li><strong>Residuals vs.&nbsp;Fitted Values:</strong>
<ul>
<li><strong>Purpose:</strong> Check for homoscedasticity and model fit.</li>
<li><strong>Interpretation:</strong>
<ul>
<li><strong>Random Scatter:</strong> Assumptions hold.</li>
<li><strong>Patterns (e.g., funnel shape):</strong> Indicate heteroscedasticity.</li>
</ul></li>
</ul></li>
<li><strong>Normal Q-Q Plot:</strong>
<ul>
<li><strong>Purpose:</strong> Assess normality of residuals.</li>
<li><strong>Interpretation:</strong>
<ul>
<li><strong>Points near the line:</strong> Normality holds.</li>
<li><strong>Deviations:</strong> Non-normality present.</li>
</ul></li>
</ul></li>
<li><strong>Residuals vs.&nbsp;Order of Data:</strong>
<ul>
<li><strong>Purpose:</strong> Detect non-independence or autocorrelation.</li>
<li><strong>Interpretation:</strong>
<ul>
<li><strong>Random Scatter:</strong> Independence holds.</li>
<li><strong>Patterns or Trends:</strong> Violation of independence.</li>
</ul></li>
</ul></li>
</ol>
</section>
</section>
<section id="r-implementation" class="level2">
<h2 class="anchored" data-anchor-id="r-implementation">R Implementation</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC, <span class="at">data =</span> data)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">which=</span><span class="dv">1</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal Q-Q Plot</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">which=</span><span class="dv">2</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Order</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Order <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>Order, <span class="fu">resid</span>(fit), <span class="at">main=</span><span class="st">"Residuals vs. Order"</span>, <span class="at">xlab=</span><span class="st">"Order"</span>, <span class="at">ylab=</span><span class="st">"Residuals"</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretation:</strong> Examine each plot for signs of assumption violations and consider corrective actions if needed.</p>
</section>
<section id="remedies-for-assumption-violations" class="level2">
<h2 class="anchored" data-anchor-id="remedies-for-assumption-violations">Remedies for Assumption Violations</h2>
<ol type="1">
<li><strong>Transformations:</strong>
<ul>
<li><strong>Log Transformation:</strong> Useful for stabilizing variance when it increases with the mean.</li>
<li><strong>Square-Root Transformation:</strong> Often used for count data.</li>
<li><strong>Box-Cox Transformation:</strong> Systematic method to find the best power transformation.</li>
</ul>
<strong>R Implementation:</strong></li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Box-Cox Transformation</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>boxcox_fit <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(fit, <span class="at">lambda=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify optimal lambda</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> boxcox_fit<span class="sc">$</span>x[<span class="fu">which.max</span>(boxcox_fit<span class="sc">$</span>y)]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform Response</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Response_transformed <span class="ot">&lt;-</span> (data<span class="sc">$</span>Response<span class="sc">^</span>optimal_lambda <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> optimal_lambda</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-fit the model with transformed data</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>fit_transformed <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response_transformed <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC, <span class="at">data =</span> data)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_transformed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li><strong>Alternative Models:</strong>
<ul>
<li><strong>Mixed-Effects Models:</strong> Address non-independence by incorporating random effects.</li>
<li><strong>Nonparametric Methods:</strong> Utilize methods like the Kruskal-Wallis test when assumptions are severely violated.</li>
</ul>
<strong>R Implementation:</strong></li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed-Effects Model Example</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>mixed_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Response <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>RandomFactor), <span class="at">data =</span> data)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mixed_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- 
# Exercises

## Medium Difficulty

1. **Two-Way ANOVA with Interaction:**
   - **Dataset:** Simulate data for a $3 \times 2$ factorial design with factors A (3 levels) and B (2 levels), each with 5 replicates.
   - **Tasks:**
     - Fit a two-way ANOVA model with interaction.
     - Generate interaction plots.
     - Interpret the ANOVA table and interaction plots.

   **Hints:**

```r
set.seed(123)
FactorA <- factor(rep(c("A1", "A2", "A3"), each=10))
FactorB <- factor(rep(c("B1", "B2"), each=5, times=3))
Response <- c(rnorm(5, 10, 2), rnorm(5, 12, 2),
               rnorm(5, 14, 2), rnorm(5, 16, 2),
               rnorm(5, 18, 2), rnorm(5, 20, 2))
data_sim <- data.frame(FactorA, FactorB, Response)

fit_sim <- aov(Response ~ FactorA * FactorB, data = data_sim)
summary(fit_sim)

interaction.plot(data_sim$FactorA, data_sim$FactorB, data_sim$Response, col=c("blue", "red"))
```

1. **Contrast Construction:**
   - **Scenario:** In a three-factor experiment (A, B, C), construct a contrast to compare the average effect of Factor A at high levels of Factors B and C versus low levels.
   - **Tasks:**
     - Define the contrast coefficients.
     - Calculate the contrast estimate and its variance.
     - Test the significance of the contrast.

   **Hints:**
   - Use `emmeans` or `multcomp` packages for contrast testing.

## Challenging Problems

1. **Unbalanced Two-Factor Design Analysis:**
   - **Dataset:** Use an unbalanced dataset with unequal replicates across treatment combinations.
   - **Tasks:**
     - Fit a two-way ANOVA model.
     - Perform Type II and Type III sum of squares analysis.
     - Compare results and discuss how imbalance affects the interpretation of main and interaction effects.

   **Hints:**

```r
library(car)
# Assume 'data_unbalanced' is loaded with unequal replicates
fit_unbalanced <- aov(Response ~ FactorA * FactorB, data = data_unbalanced)

# Type II SS
Anova(fit_unbalanced, type="II")

# Type III SS
Anova(fit_unbalanced, type="III")
```

1. **Three-Factor Interaction Interpretation:**
   - **Dataset:** Simulate or use a real dataset with three factors exhibiting a significant three-way interaction.
   - **Tasks:**
     - Fit a three-way ANOVA model.
     - Visualize the three-way interaction.
     - Use `emmeans` to explore and interpret the interaction.
     - Discuss how the three-way interaction affects the interpretation of main and two-way interactions.

   **Hints:**

```r
library(emmeans)

# Simulate data with three-way interaction
set.seed(456)
FactorA <- factor(rep(c("A1", "A2", "A3"), each=12))
FactorB <- factor(rep(c("B1", "B2"), each=6, times=3))
FactorC <- factor(rep(c("C1", "C2", "C3"), times=6))
Response <- rnorm(36, mean=10 + as.numeric(FactorA)*2 + as.numeric(FactorB)*3 +
                  as.numeric(FactorC)*1.5 + 
                  as.numeric(FactorA)*as.numeric(FactorB) +
                  as.numeric(FactorA)*as.numeric(FactorC) +
                  as.numeric(FactorB)*as.numeric(FactorC) +
                  as.numeric(FactorA)*as.numeric(FactorB)*as.numeric(FactorC), 2)
data_three <- data.frame(FactorA, FactorB, FactorC, Response)

fit_three <- aov(Response ~ FactorA * FactorB * FactorC, data = data_three)
summary(fit_three)

# Interaction plot
ggplot(data_three, aes(x=FactorA, y=Response, color=FactorB)) +
   geom_point() +
   geom_line(aes(group=FactorB)) +
   facet_wrap(~ FactorC) +
   labs(title="Three-Way Interaction Plot")

# Using emmeans
emm <- emmeans(fit_three, ~ FactorA * FactorB * FactorC)
contrast(emm, interaction = "trt.vs.ctrl", adjust = "none")
```

1. **Mathematical Proof of Interaction Contrasts:**
   - **Task:** Derive the formulas for interaction contrasts in a three-factor design and prove that they measure deviations from additivity.
   - **Requirements:**
     - Show how to construct interaction contrasts.
     - Prove that if all interaction contrasts are zero, the model is additive.

   **Hints:**
   - Use the definition of main effects and interaction terms.
   - Utilize properties of linear algebra to demonstrate additivity.
 -->
</section>
</section>
<section id="appendix-advanced-mathematical-details" class="level1">
<h1>Appendix: Advanced Mathematical Details</h1>
<section id="confidence-intervals-for-higher-order-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals-for-higher-order-contrasts">Confidence Intervals for Higher-Order Contrasts</h2>
<p>For a <span class="math inline">\(k\)</span>-factor interaction, the confidence interval for a contrast <span class="math inline">\(L\)</span> is given by:</p>
<p><span class="math display">\[
\text{CI} = \hat{L} \pm t_{\alpha/2, df} \sqrt{\text{Var}(\hat{L})}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\hat{L}\)</span>: Estimated contrast.</li>
<li><span class="math inline">\(t_{\alpha/2, df}\)</span>: Critical value from the t-distribution.</li>
<li><span class="math inline">\(\text{Var}(\hat{L})\)</span>: Variance of the contrast estimate.</li>
</ul>
<p><strong>Derivation:</strong></p>
<ol type="1">
<li><p><strong>Estimator:</strong> <span class="math inline">\(\hat{L} = \sum c_i \hat{\mu}_i\)</span></p></li>
<li><p><strong>Variance:</strong> <span class="math inline">\(\text{Var}(\hat{L}) = \sigma^2 \sum \frac{c_i^2}{n_i}\)</span> (Assuming equal sample sizes and independence)</p></li>
<li><p><strong>Confidence Interval:</strong> Using the properties of the normal distribution for large sample sizes or exact t-distribution for smaller samples.</p></li>
</ol>
</section>
<section id="box-cox-transformation" class="level2">
<h2 class="anchored" data-anchor-id="box-cox-transformation">Box-Cox Transformation</h2>
<p>The Box-Cox transformation seeks an optimal power transformation to stabilize variance and normalize residuals.</p>
<p><span class="math display">\[
Y'(\lambda) =
\begin{cases}
\frac{Y^\lambda - 1}{\lambda} &amp; \text{if } \lambda \neq 0, \\
\ln(Y) &amp; \text{if } \lambda = 0.
\end{cases}
\]</span></p>
<p><strong>Steps in R:</strong></p>
<ol type="1">
<li><strong>Fit the ANOVA model:</strong></li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC, <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li><strong>Apply Box-Cox:</strong></li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>boxcox_fit <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(fit, <span class="at">lambda=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>, <span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> boxcox_fit<span class="sc">$</span>x[<span class="fu">which.max</span>(boxcox_fit<span class="sc">$</span>y)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li><strong>Transform the Response:</strong></li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Response_transformed <span class="ot">&lt;-</span> (data<span class="sc">$</span>Response<span class="sc">^</span>optimal_lambda <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> optimal_lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li><strong>Re-fit the Model with Transformed Data:</strong></li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fit_transformed <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response_transformed <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC, <span class="at">data =</span> data)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_transformed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretation:</strong> The optimal <span class="math inline">\(\lambda\)</span> indicates the best power transformation to achieve homoscedasticity and normality. Re-fitting the model on transformed data should show improved diagnostic plots.</p>
</section>
<section id="mathematical-proof-of-interaction-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-proof-of-interaction-contrasts">Mathematical Proof of Interaction Contrasts</h2>
<section id="interaction-contrasts-measure-deviations-from-additivity" class="level3">
<h3 class="anchored" data-anchor-id="interaction-contrasts-measure-deviations-from-additivity">Interaction Contrasts Measure Deviations from Additivity</h3>
<p><strong>Definition:</strong> In a three-factor design, the interaction contrast measures how the combined effect of three factors deviates from the sum of their individual and two-factor interaction effects.</p>
<p><strong>Proof Steps:</strong></p>
<ol type="1">
<li><strong>Model Setup:</strong></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk} + (\alpha\beta\gamma)_{ijk} + \epsilon_{ijk}
\]</span></p>
<ol type="1">
<li><strong>Additivity Condition:</strong> If <span class="math inline">\((\alpha\beta\gamma)_{ijk} = 0\)</span> for all <span class="math inline">\(i,j,k\)</span>, then:</li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk} + \epsilon_{ijk}
\]</span></p>
<p>This represents an additive model where the combined effects of factors are purely additive without higher-order interactions.</p>
<ol type="1">
<li><strong>Interaction Contrast:</strong> Define the three-way interaction contrast as:</li>
</ol>
<p><span class="math display">\[
L = (\alpha\beta\gamma)_{ijk}
\]</span></p>
<ol type="1">
<li><strong>Zero Interaction Contrasts Imply Additivity:</strong> If <span class="math inline">\(L = 0\)</span> for all combinations, then:</li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + (\alpha\gamma)_{ik} + (\beta\gamma)_{jk} + \epsilon_{ijk}
\]</span></p>
<p>Hence, the absence of three-way interactions leads to an additive relationship among factors.</p>
<ol type="1">
<li><strong>Conclusion:</strong> The interaction contrasts <span class="math inline">\(L\)</span> quantify the extent to which the actual response deviates from what would be expected under additivity. Non-zero contrasts indicate the presence of higher-order interactions.</li>
</ol>
</section>
</section>
</section>
<section id="orthogonality-and-balance-in-factorial-experiments" class="level1">
<h1>Orthogonality and Balance in factorial experiments</h1>
<p>Orthogonality and balance are closely related concepts in factorial experiments, yet they are not identical, and one does not automatically imply the other.</p>
<section id="key-points" class="level2">
<h2 class="anchored" data-anchor-id="key-points">Key Points</h2>
<ul>
<li><p><strong>Balanced Design:</strong><br>
A balanced design means that each treatment combination (or cell) has the same number of observations. This equality of replications helps in achieving uniform precision across estimates.</p></li>
<li><p><strong>Orthogonality:</strong><br>
Orthogonality refers to the statistical property where the columns of the design matrix (which correspond to different effects, such as main effects or interactions) are uncorrelated. When the columns are orthogonal, the least squares estimates of the effects are independent of one another.</p></li>
</ul>
</section>
<section id="relationship-between-the-two" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-the-two">Relationship Between the Two</h2>
<ul>
<li><p><strong>Balanced → Often Orthogonal (in Full Factorials):</strong><br>
In a full factorial experiment with equal replication (a balanced design) and proper coding (such as using orthogonal contrasts), the main effects and interaction effects tend to be orthogonal. This means that the estimates for one effect do not “borrow” information from another, simplifying both interpretation and hypothesis testing. For example, in the model<br>
<span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)_{ij} + \epsilon_{ijk},
\]</span> the main effects <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta_j\)</span>, and <span class="math inline">\(\gamma_k\)</span> are orthogonal to each other, as are the interaction effects <span class="math inline">\((\alpha\beta)_{ij}\)</span> with the main effects.</p>
<p>A balanced design will typically ensure that the estimates for <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta_j\)</span>, and <span class="math inline">\((\alpha\beta)_{ij}\)</span> are independent—provided that the design matrix is constructed with orthogonal contrasts. This is one of the reasons why balanced designs are highly valued—they help satisfy the conditions required for the Gauss-Markov theorem, ensuring that the least squares estimators are BLUE <span class="citation" data-cites="box2005">(<a href="#ref-box2005" role="doc-biblioref">Box et al., 2005</a>)</span>.</p></li>
</ul>
</section>
<section id="orthogonality-without-balance-a-caveat" class="level2">
<h2 class="anchored" data-anchor-id="orthogonality-without-balance-a-caveat">Orthogonality Without Balance: A Caveat</h2>
<p>It is possible, in some cases, to have orthogonal contrasts even if the design is not perfectly balanced. However, achieving this often requires careful design construction (for instance, through specific contrast coding) that compensates for unequal sample sizes. In general, though, balance makes it much easier to achieve and verify orthogonality.</p>
<ul>
<li><strong>Balanced Does Not Always Imply Complete Orthogonality:</strong><br>
Not every balanced design will automatically produce orthogonal estimates for all effects. For instance:
<ul>
<li>In fractional factorial designs or designs with certain constraints, balance in the number of observations per cell does not guarantee that the factor levels or contrasts are arranged in an orthogonal fashion.</li>
<li>If the design involves aliasing or confounding (even in a balanced structure), some effects may not be independently estimated.</li>
</ul></li>
</ul>
</section>
<section id="summary-3" class="level2">
<h2 class="anchored" data-anchor-id="summary-3">Summary</h2>
<ul>
<li><strong>Balance is a favorable condition for orthogonality,</strong> especially in full factorial experiments with equal replication and proper contrast coding.</li>
<li><strong>However, balance alone does not guarantee orthogonality</strong> for every effect, particularly in more complex or constrained designs.</li>
<li><strong>Orthogonality ensures independent estimation</strong> of the effects (including interactions), which is essential for clear interpretation and efficient testing of hypotheses. Yet, to achieve orthogonality, the design must be both balanced and appropriately structured.</li>
</ul>
<p>Thus, while a balanced design is a key step toward orthogonal estimation of effects, it is not a blanket guarantee—additional considerations in the design (such as the structure of contrasts and the absence of confounding) are necessary to ensure that all effects, including interactions, are estimated orthogonally.</p>
</section>
</section>
<section id="proof-of-orthogonality-in-balanced-designs" class="level1">
<h1>Proof of Orthogonality in Balanced Designs</h1>
<p>In balanced designs, each treatment level (or combination in factorial designs) appears the same number of times. This balanced replication leads to important orthogonality properties that simplify the analysis of variance (ANOVA) and the interpretation of contrasts.</p>
<section id="the-concept-of-orthogonality" class="level2">
<h2 class="anchored" data-anchor-id="the-concept-of-orthogonality">The Concept of Orthogonality</h2>
<p>Two vectors (or columns in a design matrix) are said to be <strong>orthogonal</strong> if their inner product is zero. In the context of experimental design, consider two contrast vectors <span class="math inline">\(\mathbf{c}_1\)</span> and <span class="math inline">\(\mathbf{c}_2\)</span> corresponding to two treatment contrasts. They are orthogonal if</p>
<p><span class="math display">\[
\mathbf{c}_1^\top \mathbf{c}_2 = 0.
\]</span></p>
<p>Orthogonality implies that the information contained in one contrast is independent of the information in the other.</p>
</section>
<section id="the-role-of-balance" class="level2">
<h2 class="anchored" data-anchor-id="the-role-of-balance">The Role of Balance</h2>
<p>For a one-way ANOVA with <span class="math inline">\(t\)</span> treatments and a common replication number <span class="math inline">\(n\)</span> for each treatment, the design matrix <span class="math inline">\(\mathbf{X}\)</span> can be structured so that the sum of the indicator variables for each treatment is equal. In such a design, the sum of squares associated with the treatments is completely independent of the error sum of squares.</p>
</section>
<section id="matrix-proof-of-orthogonality" class="level2">
<h2 class="anchored" data-anchor-id="matrix-proof-of-orthogonality">Matrix Proof of Orthogonality</h2>
<p>Consider the following model for a balanced one-way design:</p>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \epsilon_{ij}, \quad i = 1, 2, \dots, t,\quad j = 1, 2, \dots, n,
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\mu\)</span> is the overall mean,</li>
<li><span class="math inline">\(\tau_i\)</span> is the effect of the <span class="math inline">\(i\)</span>-th treatment (subject to the constraint <span class="math inline">\(\sum_{i=1}^{t} \tau_i = 0\)</span>),</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> are independent errors with <span class="math inline">\(E[\epsilon_{ij}] = 0\)</span> and <span class="math inline">\(\operatorname{Var}(\epsilon_{ij}) = \sigma^2\)</span>.</li>
</ul>
<p>Let the design matrix <span class="math inline">\(\mathbf{X}\)</span> be partitioned as</p>
<p><span class="math display">\[
\mathbf{X} = \begin{pmatrix}
\mathbf{1} &amp; \mathbf{X}_\tau
\end{pmatrix},
\]</span></p>
<p>where <span class="math inline">\(\mathbf{1}\)</span> is an <span class="math inline">\(N \times 1\)</span> vector of ones (with <span class="math inline">\(N = tn\)</span>), and <span class="math inline">\(\mathbf{X}_\tau\)</span> is the <span class="math inline">\(N \times (t-1)\)</span> matrix representing the treatment effects with an appropriate set of contrasts.</p>
<p>For a balanced design the structure of <span class="math inline">\(\mathbf{X}_\tau\)</span> ensures that</p>
<p><span class="math display">\[
\mathbf{X}_\tau^\top \mathbf{X}_\tau = k\, \mathbf{I}_{t-1},
\]</span></p>
<p>where <span class="math inline">\(k\)</span> is a constant proportional to the number of replications and <span class="math inline">\(\mathbf{I}_{t-1}\)</span> is the <span class="math inline">\((t-1)\times(t-1)\)</span> identity matrix. This result shows that the columns (i.e., the treatment contrasts) are orthogonal.</p>
<section id="detailed-steps" class="level3">
<h3 class="anchored" data-anchor-id="detailed-steps">Detailed Steps</h3>
<ol type="1">
<li><p><strong>Balanced Replication:</strong></p>
<p>Each treatment appears <span class="math inline">\(n\)</span> times so that the sum of the indicator for treatment <span class="math inline">\(i\)</span> is <span class="math inline">\(n\)</span>. For any two different treatments <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>:</p></li>
</ol>
<p><span class="math display">\[
\sum_{l=1}^{N} x_{l,i} \, x_{l,j} = 0,
\]</span></p>
<p>when the columns are centered (i.e., after imposing the constraint <span class="math inline">\(\sum_{i=1}^{t} \tau_i = 0\)</span>). This centering is key to orthogonality.</p>
<ol start="2" type="1">
<li><p><strong>Contrast Construction:</strong></p>
<p>When forming contrasts, one typically chooses contrast coefficients <span class="math inline">\(c_{i}\)</span> such that</p></li>
</ol>
<p><span class="math display">\[
\sum_{i=1}^{t} c_{i} = 0.
\]</span> For two contrasts <span class="math inline">\(\mathbf{c}^{(1)}\)</span> and <span class="math inline">\(\mathbf{c}^{(2)}\)</span>, the balance of the design implies</p>
<p><span class="math display">\[
\sum_{i=1}^{t} c^{(1)}_i \, c^{(2)}_i = 0.
\]</span> This follows because, with equal replication, each contrast is scaled by <span class="math inline">\(n\)</span> and the orthogonality condition is preserved.</p>
<ol start="3" type="1">
<li><p><strong>Projection Interpretation:</strong></p>
<p>The projection matrix onto the column space of <span class="math inline">\(\mathbf{X}_\tau\)</span> is given by</p></li>
</ol>
<p><span class="math display">\[
\mathbf{P} = \mathbf{X}_\tau \left(\mathbf{X}_\tau^\top \mathbf{X}_\tau\right)^{-1}\mathbf{X}_\tau^\top.
\]</span></p>
<p>When <span class="math inline">\(\mathbf{X}_\tau^\top \mathbf{X}_\tau\)</span> is diagonal (as in the balanced case), the off-diagonal elements of the projection matrix vanish, indicating that the treatment effects are estimated independently (i.e., orthogonally).</p>
</section>
</section>
<section id="intuitive-explanation" class="level2">
<h2 class="anchored" data-anchor-id="intuitive-explanation">Intuitive Explanation</h2>
<p>Imagine you have a set of equally weighted arrows (representing treatment contrasts) in a space. In a balanced design, these arrows point in mutually independent directions—none of the arrows “shadow” any other. As a result, any movement (or change) in one direction does not influence the measurement in any other direction. This geometrical interpretation is exactly what orthogonality means and why it simplifies the ANOVA table: the treatment sum of squares does not “contaminate” the error sum of squares.</p>
</section>
<section id="summary-4" class="level2">
<h2 class="anchored" data-anchor-id="summary-4">Summary</h2>
<p>The orthogonality in balanced designs stems from:</p>
<ul>
<li><strong>Equal replication:</strong> Each treatment is observed an equal number of times.</li>
<li><strong>Properly constructed contrasts:</strong> With the constraint <span class="math inline">\(\sum_{i=1}^{t} \tau_i = 0\)</span>, contrasts satisfy <span class="math inline">\(\sum c_i = 0\)</span> and, hence, their inner products are zero.</li>
<li><strong>Diagonal structure of <span class="math inline">\(\mathbf{X}_\tau^\top \mathbf{X}_\tau\)</span>:</strong> This ensures that the estimated effects are uncorrelated.</li>
</ul>
<p>This property is central in simplifying the statistical analysis, as it allows the decomposition of the total variability into independent components corresponding to treatments and error.</p>
</section>
<section id="references" class="level2">




</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-box2005" class="csl-entry" role="listitem">
Box, G. E. P., Hunter, J. S., &amp; Hunter, W. G. (2005). <em>Statistics for experimenters: <span>Design</span>, innovation and discovery</em> (2nd ed.). Wiley.
</div>
<div id="ref-christensen2018" class="csl-entry" role="listitem">
Christensen, R. (2018). <em>Analysis of variance, design, and regression: Linear modeling for unbalanced data</em> (2nd ed.). <span>Chapman and Hall/CRC</span>.
</div>
<div id="ref-dean2017" class="csl-entry" role="listitem">
Dean, A., Voss, D., &amp; Draguljić, D. (2017). <em>Design and analysis of experiments</em> (2nd ed.). Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-52250-0">https://doi.org/10.1007/978-3-319-52250-0</a>
</div>
<div id="ref-montgomery2020a" class="csl-entry" role="listitem">
Montgomery, D. C. (2020). <em>Design and analysis of experiments</em> (10th ed.). Wiley.
</div>
</div></section></div></main> <!-- /main -->
<!-- filepath: /Users/dt/Library/CloudStorage/Dropbox/Teaching/DOE/assets/includes/footer.html -->
<footer class="site-footer">
    <div class="container text-center">
        <hr> 
        © <span id="current-year"></span> Dr. Davood Tofighi |
        <a href="https://canvasinfo.unm.edu/">UNM Canvas</a> |
        <a href="https://data-wise.github.io/doe">Course GitHub Page</a> |
    </div>
    <script>
        document.getElementById("current-year").textContent = new Date().getFullYear();
    </script>
</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Data-Wise\.github\.io\/doe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>