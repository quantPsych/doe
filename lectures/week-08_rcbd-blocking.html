<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Davood Tofighi, Ph.D.">

<title>Randomized Complete Block Design (RCBD) with Blocking – STAT 454/545 - Analysis of Variance and Experimental Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-a185852c63625fd9ffbdc57047c9a77e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-68b729f92b170261f1b1556cc4834a67.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Montserrat:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Randomized Complete Block Design (RCBD) with Blocking – STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:description" content="Analysis of Variance and Experimental Design">
<meta property="og:image" content="https://Data-Wise.github.io/doe/lectures/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="STAT 454/545 - Analysis of Variance and Experimental Design">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 545</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/syllabus-final.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_lectures.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_help.html"> 
<span class="menu-text">R Help</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_appendix.html"> 
<span class="menu-text">Appendix</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contents.html"> 
<span class="menu-text">Contents</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Randomized Complete Block Design (RCBD) with Blocking</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Randomized Complete Block Design (RCBD) with Blocking</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://Data-Wise.github.io/doe">Davood Tofighi, Ph.D.</a> <a href="mailto:dtofighi@unm.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-8523-7776" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Mathematics and Statistics, University of New Mexico
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">14-Mar-2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus-final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R Code and Datasets</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r_help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Help</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r-code-data-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Code and Datasets from the Book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data-files-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets from the Book</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages">R Packages</a></li>
  <li><a href="#complete-block-designs-theory-and-structure" id="toc-complete-block-designs-theory-and-structure" class="nav-link" data-scroll-target="#complete-block-designs-theory-and-structure">Complete Block Designs: Theory and Structure</a>
  <ul class="collapse">
  <li><a href="#what-are-complete-block-designs" id="toc-what-are-complete-block-designs" class="nav-link" data-scroll-target="#what-are-complete-block-designs">What Are Complete Block Designs?</a>
  <ul class="collapse">
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul></li>
  <li><a href="#randomized-complete-block-designs-rcbds" id="toc-randomized-complete-block-designs-rcbds" class="nav-link" data-scroll-target="#randomized-complete-block-designs-rcbds">Randomized Complete Block Designs (RCBDs)</a></li>
  <li><a href="#general-complete-block-designs" id="toc-general-complete-block-designs" class="nav-link" data-scroll-target="#general-complete-block-designs">General Complete Block Designs</a></li>
  </ul></li>
  <li><a href="#analysis-of-rcbds" id="toc-analysis-of-rcbds" class="nav-link" data-scroll-target="#analysis-of-rcbds">Analysis of RCBDs</a>
  <ul class="collapse">
  <li><a href="#model-and-assumptions" id="toc-model-and-assumptions" class="nav-link" data-scroll-target="#model-and-assumptions">Model and Assumptions</a></li>
  <li><a href="#key-assumptions" id="toc-key-assumptions" class="nav-link" data-scroll-target="#key-assumptions">Key Assumptions</a></li>
  <li><a href="#anova-for-rcbds" id="toc-anova-for-rcbds" class="nav-link" data-scroll-target="#anova-for-rcbds">ANOVA for RCBDs</a>
  <ul class="collapse">
  <li><a href="#variance-decomposition" id="toc-variance-decomposition" class="nav-link" data-scroll-target="#variance-decomposition">Variance Decomposition</a></li>
  </ul></li>
  <li><a href="#anova-table" id="toc-anova-table" class="nav-link" data-scroll-target="#anova-table">ANOVA Table</a>
  <ul class="collapse">
  <li><a href="#f-ratio-and-hypothesis-testing" id="toc-f-ratio-and-hypothesis-testing" class="nav-link" data-scroll-target="#f-ratio-and-hypothesis-testing">F-Ratio and Hypothesis Testing</a></li>
  </ul></li>
  <li><a href="#multiple-comparisons" id="toc-multiple-comparisons" class="nav-link" data-scroll-target="#multiple-comparisons">Multiple Comparisons</a></li>
  </ul></li>
  <li><a href="#implementation-in-r" id="toc-implementation-in-r" class="nav-link" data-scroll-target="#implementation-in-r">Implementation in R</a>
  <ul class="collapse">
  <li><a href="#example-bread-baking-experiment" id="toc-example-bread-baking-experiment" class="nav-link" data-scroll-target="#example-bread-baking-experiment">Example: Bread-Baking Experiment</a>
  <ul class="collapse">
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  </ul></li>
  <li><a href="#load-data-and-prepare-factors" id="toc-load-data-and-prepare-factors" class="nav-link" data-scroll-target="#load-data-and-prepare-factors">1. Load Data and Prepare Factors</a></li>
  <li><a href="#fit-the-rcbd-model" id="toc-fit-the-rcbd-model" class="nav-link" data-scroll-target="#fit-the-rcbd-model">2. Fit the RCBD Model</a></li>
  <li><a href="#assess-blocking-efficiency" id="toc-assess-blocking-efficiency" class="nav-link" data-scroll-target="#assess-blocking-efficiency">3. Assess Blocking Efficiency</a></li>
  <li><a href="#diagnostic-plots" id="toc-diagnostic-plots" class="nav-link" data-scroll-target="#diagnostic-plots">4. Diagnostic Plots</a></li>
  <li><a href="#multiple-comparisons-post-hoc-analysis" id="toc-multiple-comparisons-post-hoc-analysis" class="nav-link" data-scroll-target="#multiple-comparisons-post-hoc-analysis">5. Multiple Comparisons (Post-Hoc Analysis)</a></li>
  <li><a href="#plot-of-multiple-comparisons" id="toc-plot-of-multiple-comparisons" class="nav-link" data-scroll-target="#plot-of-multiple-comparisons">Plot of Multiple Comparisons</a></li>
  </ul></li>
  <li><a href="#numerical-example-1-testing-fertilizers" id="toc-numerical-example-1-testing-fertilizers" class="nav-link" data-scroll-target="#numerical-example-1-testing-fertilizers">Numerical Example 1: Testing Fertilizers</a>
  <ul class="collapse">
  <li><a href="#scenario-1" id="toc-scenario-1" class="nav-link" data-scroll-target="#scenario-1">Scenario</a></li>
  <li><a href="#step-1-compute-means" id="toc-step-1-compute-means" class="nav-link" data-scroll-target="#step-1-compute-means">Step 1: Compute Means</a></li>
  <li><a href="#step-2-calculate-sums-of-squares" id="toc-step-2-calculate-sums-of-squares" class="nav-link" data-scroll-target="#step-2-calculate-sums-of-squares">Step 2: Calculate Sums of Squares</a></li>
  <li><a href="#step-3-construct-anova-table" id="toc-step-3-construct-anova-table" class="nav-link" data-scroll-target="#step-3-construct-anova-table">Step 3: Construct ANOVA Table</a></li>
  <li><a href="#step-4-interpret-results" id="toc-step-4-interpret-results" class="nav-link" data-scroll-target="#step-4-interpret-results">Step 4: Interpret Results</a></li>
  </ul></li>
  <li><a href="#real-world-example-2-testing-teaching-methods" id="toc-real-world-example-2-testing-teaching-methods" class="nav-link" data-scroll-target="#real-world-example-2-testing-teaching-methods">Real-World Example 2: Testing Teaching Methods</a>
  <ul class="collapse">
  <li><a href="#scenario-2" id="toc-scenario-2" class="nav-link" data-scroll-target="#scenario-2">Scenario</a></li>
  <li><a href="#step-1-compute-means-1" id="toc-step-1-compute-means-1" class="nav-link" data-scroll-target="#step-1-compute-means-1">Step 1: Compute Means</a></li>
  <li><a href="#step-2-sums-of-squares" id="toc-step-2-sums-of-squares" class="nav-link" data-scroll-target="#step-2-sums-of-squares">Step 2: Sums of Squares</a></li>
  <li><a href="#step-3-anova-table" id="toc-step-3-anova-table" class="nav-link" data-scroll-target="#step-3-anova-table">Step 3: ANOVA Table</a></li>
  <li><a href="#step-4-interpret-results-1" id="toc-step-4-interpret-results-1" class="nav-link" data-scroll-target="#step-4-interpret-results-1">Step 4: Interpret Results</a></li>
  <li><a href="#key-insights" id="toc-key-insights" class="nav-link" data-scroll-target="#key-insights">Key Insights</a></li>
  </ul></li>
  <li><a href="#contrasts-in-rcbd" id="toc-contrasts-in-rcbd" class="nav-link" data-scroll-target="#contrasts-in-rcbd">2. Contrasts in RCBD</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition">2.1 Definition</a></li>
  <li><a href="#examples-of-contrasts" id="toc-examples-of-contrasts" class="nav-link" data-scroll-target="#examples-of-contrasts">2.2 Examples of Contrasts</a></li>
  </ul></li>
  <li><a href="#numerical-example-with-contrasts" id="toc-numerical-example-with-contrasts" class="nav-link" data-scroll-target="#numerical-example-with-contrasts">3. Numerical Example with Contrasts</a>
  <ul class="collapse">
  <li><a href="#scenario-3" id="toc-scenario-3" class="nav-link" data-scroll-target="#scenario-3">3.1 Scenario</a></li>
  <li><a href="#anova-analysis" id="toc-anova-analysis" class="nav-link" data-scroll-target="#anova-analysis">3.2 ANOVA Analysis</a></li>
  <li><a href="#step-by-step-contrast-computations" id="toc-step-by-step-contrast-computations" class="nav-link" data-scroll-target="#step-by-step-contrast-computations">3.3 Step-by-Step Contrast Computations</a></li>
  <li><a href="#r-code-to-analyze-contrasts" id="toc-r-code-to-analyze-contrasts" class="nav-link" data-scroll-target="#r-code-to-analyze-contrasts">3.4 R Code to Analyze Contrasts</a></li>
  <li><a href="#explanation-of-r-output" id="toc-explanation-of-r-output" class="nav-link" data-scroll-target="#explanation-of-r-output">3.5 Explanation of R Output</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">3.6 Interpretation</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#general-complete-block-designs-1" id="toc-general-complete-block-designs-1" class="nav-link" data-scroll-target="#general-complete-block-designs-1">General Complete Block Designs</a>
  <ul class="collapse">
  <li><a href="#r-packages-used" id="toc-r-packages-used" class="nav-link" data-scroll-target="#r-packages-used">R Packages Used</a></li>
  </ul></li>
  <li><a href="#general-complete-block-designs-without-interaction" id="toc-general-complete-block-designs-without-interaction" class="nav-link" data-scroll-target="#general-complete-block-designs-without-interaction">General Complete Block Designs without Interaction</a>
  <ul class="collapse">
  <li><a href="#model-without-interaction" id="toc-model-without-interaction" class="nav-link" data-scroll-target="#model-without-interaction">Model without Interaction</a></li>
  <li><a href="#sums-of-squares-computation" id="toc-sums-of-squares-computation" class="nav-link" data-scroll-target="#sums-of-squares-computation">Sums of Squares Computation</a></li>
  <li><a href="#multiple-comparisons-1" id="toc-multiple-comparisons-1" class="nav-link" data-scroll-target="#multiple-comparisons-1">Multiple Comparisons</a></li>
  </ul></li>
  <li><a href="#analysis-of-the-banana-experiment-example-10.8.1" id="toc-analysis-of-the-banana-experiment-example-10.8.1" class="nav-link" data-scroll-target="#analysis-of-the-banana-experiment-example-10.8.1">Analysis of the Banana Experiment (Example 10.8.1)</a>
  <ul class="collapse">
  <li><a href="#experiment-context" id="toc-experiment-context" class="nav-link" data-scroll-target="#experiment-context">Experiment Context</a></li>
  <li><a href="#data-overview" id="toc-data-overview" class="nav-link" data-scroll-target="#data-overview">Data Overview</a></li>
  </ul></li>
  <li><a href="#detailed-computations" id="toc-detailed-computations" class="nav-link" data-scroll-target="#detailed-computations">Detailed Computations</a>
  <ul class="collapse">
  <li><a href="#computational-formulae" id="toc-computational-formulae" class="nav-link" data-scroll-target="#computational-formulae">“Computational” Formulae</a>
  <ul class="collapse">
  <li><a href="#treatment-sum-of-squares-blocks-ss_theta" id="toc-treatment-sum-of-squares-blocks-ss_theta" class="nav-link" data-scroll-target="#treatment-sum-of-squares-blocks-ss_theta">Treatment Sum of Squares (Blocks), <span class="math inline">\(SS_{\theta}\)</span></a></li>
  <li><a href="#total-sum-of-squares-ss_texttotal" id="toc-total-sum-of-squares-ss_texttotal" class="nav-link" data-scroll-target="#total-sum-of-squares-ss_texttotal">Total Sum of Squares, <span class="math inline">\(SS_{\text{Total}}\)</span></a></li>
  <li><a href="#treatment-sum-of-squares-ss_treatment" id="toc-treatment-sum-of-squares-ss_treatment" class="nav-link" data-scroll-target="#treatment-sum-of-squares-ss_treatment">Treatment Sum of Squares, <span class="math inline">\(SS_{Treatment}\)</span></a></li>
  <li><a href="#error-sum-of-squares-ss_error" id="toc-error-sum-of-squares-ss_error" class="nav-link" data-scroll-target="#error-sum-of-squares-ss_error">Error Sum of Squares, <span class="math inline">\(SS_{Error}\)</span></a></li>
  <li><a href="#definitions-of-means-used" id="toc-definitions-of-means-used" class="nav-link" data-scroll-target="#definitions-of-means-used">Definitions of Means Used</a></li>
  <li><a href="#error-sum-of-squares-ss_error-1" id="toc-error-sum-of-squares-ss_error-1" class="nav-link" data-scroll-target="#error-sum-of-squares-ss_error-1">Error Sum of Squares, <span class="math inline">\(SS_{Error}\)</span></a></li>
  <li><a href="#explanation-of-terms" id="toc-explanation-of-terms" class="nav-link" data-scroll-target="#explanation-of-terms">Explanation of Terms</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  </ul></li>
  <li><a href="#anova-decision-rule" id="toc-anova-decision-rule" class="nav-link" data-scroll-target="#anova-decision-rule">3. ANOVA Decision Rule</a></li>
  </ul></li>
  <li><a href="#r-implementation-for-the-banana-data" id="toc-r-implementation-for-the-banana-data" class="nav-link" data-scroll-target="#r-implementation-for-the-banana-data">R Implementation for the Banana Data</a>
  <ul class="collapse">
  <li><a href="#data-import-and-preparation" id="toc-data-import-and-preparation" class="nav-link" data-scroll-target="#data-import-and-preparation">Data Import and Preparation</a></li>
  <li><a href="#descriptive-statistics-and-treatment-means" id="toc-descriptive-statistics-and-treatment-means" class="nav-link" data-scroll-target="#descriptive-statistics-and-treatment-means">Descriptive Statistics and Treatment Means</a></li>
  <li><a href="#calculating-sums-of-squares" id="toc-calculating-sums-of-squares" class="nav-link" data-scroll-target="#calculating-sums-of-squares">Calculating Sums of Squares</a></li>
  <li><a href="#fitting-the-block-design-model" id="toc-fitting-the-block-design-model" class="nav-link" data-scroll-target="#fitting-the-block-design-model">Fitting the Block Design Model</a></li>
  <li><a href="#derivation-of-treatment-contrast-variance" id="toc-derivation-of-treatment-contrast-variance" class="nav-link" data-scroll-target="#derivation-of-treatment-contrast-variance">Derivation of Treatment Contrast Variance</a></li>
  </ul></li>
  <li><a href="#general-complete-block-designs-with-interaction" id="toc-general-complete-block-designs-with-interaction" class="nav-link" data-scroll-target="#general-complete-block-designs-with-interaction">General Complete Block Designs with Interaction</a>
  <ul class="collapse">
  <li><a href="#model-overview" id="toc-model-overview" class="nav-link" data-scroll-target="#model-overview">Model Overview</a></li>
  <li><a href="#component-explanation" id="toc-component-explanation" class="nav-link" data-scroll-target="#component-explanation">Component Explanation</a>
  <ul class="collapse">
  <li><a href="#overall-mean-and-block-effects" id="toc-overall-mean-and-block-effects" class="nav-link" data-scroll-target="#overall-mean-and-block-effects">1. Overall Mean and Block Effects</a></li>
  <li><a href="#treatment-effect-and-interaction" id="toc-treatment-effect-and-interaction" class="nav-link" data-scroll-target="#treatment-effect-and-interaction">2. Treatment Effect and Interaction</a></li>
  <li><a href="#random-error-epsilon_hit" id="toc-random-error-epsilon_hit" class="nav-link" data-scroll-target="#random-error-epsilon_hit">3. Random Error <span class="math inline">\(\epsilon_{hit}\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#numerical-example-using-banana-data" id="toc-numerical-example-using-banana-data" class="nav-link" data-scroll-target="#numerical-example-using-banana-data">Numerical Example Using Banana Data</a>
  <ul class="collapse">
  <li><a href="#data-overview-1" id="toc-data-overview-1" class="nav-link" data-scroll-target="#data-overview-1">Data Overview</a></li>
  </ul></li>
  <li><a href="#step-by-step-computation" id="toc-step-by-step-computation" class="nav-link" data-scroll-target="#step-by-step-computation">Step-by-Step Computation</a>
  <ul class="collapse">
  <li><a href="#step-1.-compute-means" id="toc-step-1.-compute-means" class="nav-link" data-scroll-target="#step-1.-compute-means">Step 1. Compute Means</a></li>
  <li><a href="#step-2.-sums-of-squares" id="toc-step-2.-sums-of-squares" class="nav-link" data-scroll-target="#step-2.-sums-of-squares">Step 2. Sums of Squares</a></li>
  </ul></li>
  <li><a href="#r-code-implementation-and-interpretation" id="toc-r-code-implementation-and-interpretation" class="nav-link" data-scroll-target="#r-code-implementation-and-interpretation">R Code Implementation and Interpretation</a>
  <ul class="collapse">
  <li><a href="#fitting-the-general-complete-block-design-model" id="toc-fitting-the-general-complete-block-design-model" class="nav-link" data-scroll-target="#fitting-the-general-complete-block-design-model">Fitting the General Complete Block Design Model</a></li>
  <li><a href="#detailed-interpretation-of-anova-results" id="toc-detailed-interpretation-of-anova-results" class="nav-link" data-scroll-target="#detailed-interpretation-of-anova-results">Detailed Interpretation of ANOVA Results</a></li>
  <li><a href="#deriving-a-contrast-for-storage-methods" id="toc-deriving-a-contrast-for-storage-methods" class="nav-link" data-scroll-target="#deriving-a-contrast-for-storage-methods">Deriving a Contrast for Storage Methods</a></li>
  <li><a href="#r-code-for-contrast-and-confidence-interval" id="toc-r-code-for-contrast-and-confidence-interval" class="nav-link" data-scroll-target="#r-code-for-contrast-and-confidence-interval">R Code for Contrast and Confidence Interval</a></li>
  <li><a href="#summary-and-takeaways" id="toc-summary-and-takeaways" class="nav-link" data-scroll-target="#summary-and-takeaways">Summary and Takeaways</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the realm of experimental design, <strong>Complete Block Designs (CBDs)</strong> play a pivotal role in controlling the effects of nuisance factors, thereby enhancing the precision of treatment comparisons. By organizing experimental units into blocks that share similar characteristics, CBDs effectively reduce variability stemming from these extraneous factors. This structured approach not only refines the efficiency of experiments but also ensures more accurate and reliable analyses.</p>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>Imagine you are testing different fertilizers on crops spread across a large farm. The farm has sections with varying soil types, sunlight exposure, and moisture levels. Without controlling for these variations, it would be challenging to discern the true effect of each fertilizer. By grouping plots with similar soil types into blocks, you can more precisely compare the performance of fertilizers within each homogeneous group, minimizing the confounding influence of soil variability.</p>
<p>This lecture delves into the structure, applications, and analysis of Complete Block Designs, with a focus on <strong>Randomized Complete Block Designs (RCBDs)</strong> and their generalizations. We will explore theoretical underpinnings, practical implementations using R, and advanced topics to provide a comprehensive understanding tailored for graduate statistics students.</p>
</section>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li><strong>Define and distinguish</strong> between complete and incomplete block designs.</li>
<li><strong>Explore</strong> the structure and application of Randomized Complete Block Designs (RCBDs).</li>
<li><strong>Perform</strong> Analysis of Variance (ANOVA) for RCBDs and assess the efficiency of blocking.</li>
<li><strong>Understand</strong> general complete block designs and their applications.</li>
<li><strong>Implement</strong> complete block designs in R and interpret the results.</li>
<li><strong>Reinforce</strong> concepts with exercises covering numerical examples, conceptual understanding, and mathematical proofs.</li>
<li><strong>Explore</strong> advanced mathematical derivations and proofs in the Appendix.</li>
</ol>
</section>
<section id="r-packages" class="level2">
<h2 class="anchored" data-anchor-id="r-packages">R Packages</h2>
<p>To facilitate the analysis of Randomized Complete Block Designs (RCBDs) and contrasts, we will utilize the following R packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Required R Packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, emmeans, ggpubr, here, readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><code>emmeans</code></strong>: For estimating marginal means and conducting pairwise comparisons.</li>
<li><strong><code>ggplot2</code></strong>: For creating visualizations and diagnostic plots.</li>
<li><strong><code>dplyr</code></strong>: For data manipulation and summarization.</li>
</ul>
<p>Ensure that these packages are installed in your R environment to follow along with the examples and exercises.</p>
</section>
<section id="complete-block-designs-theory-and-structure" class="level1">
<h1>Complete Block Designs: Theory and Structure</h1>
<section id="what-are-complete-block-designs" class="level2">
<h2 class="anchored" data-anchor-id="what-are-complete-block-designs">What Are Complete Block Designs?</h2>
<p><strong>Complete Block Designs (CBDs)</strong> are experimental designs where each block contains all the treatments being tested. This ensures that every treatment is applied in each block, allowing for direct comparisons under similar conditions.</p>
<ul>
<li><strong>Block:</strong> A group of experimental units that are similar in some aspect and expected to yield comparable responses.</li>
<li><strong>Complete Block:</strong> Each block includes every treatment exactly once.</li>
</ul>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>In a clinical trial comparing drug treatments across different hospitals, each hospital represents a block. By administering all treatments in each hospital, you account for hospital-specific factors, such as patient demographics and care protocols, ensuring that treatment effects are evaluated consistently.</p>
</section>
</section>
<section id="randomized-complete-block-designs-rcbds" class="level2">
<h2 class="anchored" data-anchor-id="randomized-complete-block-designs-rcbds">Randomized Complete Block Designs (RCBDs)</h2>
<p><strong>RCBDs</strong> are a specific type of CBD where treatments are randomly assigned within each block. This randomness ensures that the assignment of treatments is free from bias and that any differences observed are attributable to the treatments rather than systematic variations.</p>
<p><strong>Characteristics of RCBDs:</strong></p>
<ul>
<li>The number of experimental units in each block equals the number of treatments.</li>
<li>Each treatment appears exactly once per block.</li>
<li>Treatments are assigned randomly within each block.</li>
</ul>
<p><strong>Analogy:</strong> Think of RCBDs as seating arrangements in a classroom where each row (block) must contain one student from each house (treatments). By randomly assigning students to seats within rows, you ensure that no particular house has an advantage in any row.</p>
</section>
<section id="general-complete-block-designs" class="level2">
<h2 class="anchored" data-anchor-id="general-complete-block-designs">General Complete Block Designs</h2>
<p>Beyond RCBDs, <strong>General Complete Block Designs</strong> allow for multiple observations or replicates of treatments within each block. This is particularly useful when interaction effects between treatments and blocks are anticipated.</p>
<p><strong>Features:</strong></p>
<ul>
<li>A treatment is replicated <span class="math inline">\(s &gt; 1\)</span> times within a block.</li>
<li>Facilitates the detection of interactions between treatments and blocking factors.</li>
</ul>
<p><strong>Example:</strong> In a clinical trial, if a treatment needs to be administered multiple times within each hospital ward (block) to account for ward-specific factors, a general complete block design would be appropriate.</p>
</section>
</section>
<section id="analysis-of-rcbds" class="level1 page-columns page-full">
<h1>Analysis of RCBDs</h1>
<section id="model-and-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="model-and-assumptions">Model and Assumptions</h2>
<p>The statistical model for an RCBD can be expressed as:</p>
<p><span class="math display">\[
Y_{hi} = \mu + \theta_h + \tau_i + \epsilon_{hi}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{hi}\)</span>: Response variable for treatment <span class="math inline">\(i\)</span> in block <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\theta_h\)</span>: Effect of block <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\tau_i\)</span>: Effect of treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\epsilon_{hi} \sim N(0, \sigma^2)\)</span>: Random error term.</li>
</ul>
</section>
<section id="key-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="key-assumptions">Key Assumptions</h2>
<ol type="1">
<li><strong>Normality:</strong> The residuals (<span class="math inline">\(\epsilon_{hi}\)</span>) are normally distributed.</li>
<li><strong>Homogeneity of Variance (Homoscedasticity):</strong> The variance of residuals is constant across all treatments and blocks.</li>
<li><strong>Independence:</strong> Observations are independent of each other.</li>
<li><strong>No Interaction:</strong> There is no interaction between blocks and treatments, i.e., the effect of a treatment is consistent across all blocks.</li>
</ol>
<p><strong>Deeper Insight:</strong> Assumption of no interaction is critical. If this assumption is violated, the RCBD model may not adequately capture the variability, leading to biased estimates of treatment effects. In such cases, more complex designs that account for interactions, like general complete block designs, are necessary.</p>
</section>
<section id="anova-for-rcbds" class="level2">
<h2 class="anchored" data-anchor-id="anova-for-rcbds">ANOVA for RCBDs</h2>
<p>To analyze RCBDs, we employ <strong>Analysis of Variance (ANOVA)</strong>, which decomposes the total variability in the data into components attributable to blocks, treatments, and random error.</p>
<section id="variance-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="variance-decomposition">Variance Decomposition</h3>
<p><span class="math display">\[
\text{Total SS} = \text{Block SS} + \text{Treatment SS} + \text{Error SS}
\]</span></p>
</section>
</section>
<section id="anova-table" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="anova-table">ANOVA Table</h2>
<div id="tbl-anova-table-rcbd" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-anova-table-rcbd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>Degrees of Freedom (DF)</th>
<th>Sum of Squares (SS)</th>
<th>Mean Square (MS)</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Blocks</td>
<td><span class="math inline">\(b - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Block}\)</span></td>
<td><span class="math inline">\(MS_\text{Block} = SS_\text{Block} / (b-1)\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>Treatments</td>
<td><span class="math inline">\(\nu - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Treatment}\)</span></td>
<td><span class="math inline">\(MS_\text{Treatment} = SS_\text{Treatment} / (\nu-1)\)</span></td>
<td><span class="math inline">\(\frac{MS_\text{Treatment}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\((b-1)(\nu-1)\)</span></td>
<td><span class="math inline">\(SS_\text{Error}\)</span></td>
<td><span class="math inline">\(MS_\text{Error} = SS_\text{Error} / ((b-1)(\nu-1))\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td><span class="math inline">\(b\nu - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Total}\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-anova-table-rcbd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: ANOVA Table for Randomized Complete Block Designs
</figcaption>
</figure>
</div>
<section id="f-ratio-and-hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="f-ratio-and-hypothesis-testing">F-Ratio and Hypothesis Testing</h3>
<ul>
<li><strong>Hypothesis Testing:</strong>
<ul>
<li><strong>Null Hypothesis (</strong><span class="math inline">\(H_0\)</span>): All treatment means are equal (<span class="math inline">\(\tau_i = 0\)</span> for all <span class="math inline">\(i\)</span>).</li>
<li><strong>Alternative Hypothesis (</strong><span class="math inline">\(H_A\)</span>): At least one treatment mean is different.</li>
</ul></li>
<li><strong>Decision Rule:</strong> Reject <span class="math inline">\(H_0\)</span> if the F-ratio exceeds the critical value from the F-distribution with degrees of freedom <span class="math inline">\((\nu-1, (b-1)(\nu-1))\)</span> at the chosen significance level (<span class="math inline">\(\alpha\)</span>).</li>
</ul>
<p><strong>Intuitive Explanation:</strong> The F-ratio compares the variability due to treatments to the variability due to random error. A higher F-ratio indicates that treatments explain a significant portion of the variability in responses, suggesting that treatment effects are meaningful.</p>
</section>
</section>
<section id="multiple-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="multiple-comparisons">Multiple Comparisons</h2>
<p>After establishing the significance of treatment effects, we often conduct <strong>multiple comparisons</strong> to identify specific differences between treatments. This post-hoc analysis helps pinpoint which treatments significantly differ from each other.</p>
<p>Bonferroni, Scheffé, Tukey, and Dunnett tests are common methods for multiple comparisons in RCBDs for a contrast, <span class="math inline">\(C=\sum c_i \tau_i\)</span></p>
<p><span class="math display">\[
\sum c_i \hat\tau_i \pm w \; \sqrt{\frac{MSE}{b} \sum c_i^2}
\]</span></p>
<p>where <span class="math inline">\(w\)</span> is determined by the method used for multiple comparisons.</p>
<ol type="1">
<li><strong>Bonferroni Test</strong>: <span class="math inline">\(w_B = t_{\alpha/(2m);\, (\nu-1)(b-1)}\)</span>, where <span class="math inline">\(m\)</span> is the number of contrasts.</li>
<li><strong>Scheffé Test</strong>: <span class="math inline">\(w_S = \sqrt{(\nu-1) F_{\alpha;\, \nu-1, (b-1)(\nu-1)}}\)</span></li>
<li><strong>Tukey Test</strong>: <span class="math inline">\(w_T = q_{\alpha;\, \nu, (b-1)(\nu-1)}/\sqrt{2}\)</span>, where <span class="math inline">\(q_{\alpha;\, \nu, (b-1)(\nu-1)}\)</span> is the critical value from the <a href="../appendix/stat-topics/standardized-range-distribution.html">studentized range distribution</a>.</li>
</ol>
</section>
</section>
<section id="implementation-in-r" class="level1 page-columns page-full">
<h1>Implementation in R</h1>
<section id="example-bread-baking-experiment" class="level2">
<h2 class="anchored" data-anchor-id="example-bread-baking-experiment">Example: Bread-Baking Experiment</h2>
<section id="scenario" class="level3">
<h3 class="anchored" data-anchor-id="scenario">Scenario</h3>
<p>An experimenter aims to compare four bread recipes (treatments) across three oven shelves (blocks). Each shelf is expected to have similar conditions, making it an ideal blocking factor.</p>
<p>Here is step by step guide to analyze this Randomized Complete Block Design (RCBD) experiment in R.</p>
</section>
</section>
<section id="load-data-and-prepare-factors" class="level2">
<h2 class="anchored" data-anchor-id="load-data-and-prepare-factors">1. Load Data and Prepare Factors</h2>
<div class="cell" data-tbl-cap="Simulated Data for RCBD">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define blocks and treatments</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">4</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>treatments <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">times =</span> <span class="dv">3</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate response variable (e.g., loaf weight in grams)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">5</span>), <span class="co"># Block 1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="dv">508</span>, <span class="at">sd =</span> <span class="dv">5</span>), <span class="co"># Block 2</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="dv">515</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># Block 3</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add treatment-specific effects using case_when function</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> response <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        treatments <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        treatments <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        treatments <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        treatments <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">6</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(blocks, treatments, response)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># View the data</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   blocks treatments response
1       1          1 504.8548
2       1          2 497.1765
3       1          3 505.8156
4       1          4 509.1643
5       2          1 508.0213
6       2          2 507.4694
7       2          3 519.5576
8       2          4 513.5267
9       3          1 523.0921
10      3          2 514.6864
11      3          3 525.5243
12      3          4 532.4332</code></pre>
</div>
</div>
<p><strong>Output Interpretation:</strong> The dataset comprises three blocks, each containing all four treatments. The response variable represents the loaf weight, simulated with slight block-specific means to reflect potential block effects.</p>
</section>
<section id="fit-the-rcbd-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-rcbd-model">2. Fit the RCBD Model</h2>
<div class="cell" data-tbl-cap="ANOVA Model for RCBD">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the RCBD model using ANOVA</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(response <span class="sc">~</span> blocks <span class="sc">+</span> treatments, <span class="at">data =</span> data)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
blocks       2  784.8   392.4  33.528 0.000554 ***
treatments   3  263.5    87.8   7.504 0.018702 *  
Residuals    6   70.2    11.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Blocks:</strong> Capture the variability due to different oven shelves.</li>
<li><strong>Treatments:</strong> Assess the effect of different bread recipes after accounting for block effects.</li>
<li><strong>Error:</strong> Represents unexplained variability.</li>
</ul>
</section>
<section id="assess-blocking-efficiency" class="level2">
<h2 class="anchored" data-anchor-id="assess-blocking-efficiency">3. Assess Blocking Efficiency</h2>
<p>Compare the Mean Square for Blocks (<span class="math inline">\(MS_\text{Block}\)</span>) with Mean Square for Error (<span class="math inline">\(MS_\text{Error}\)</span>). A higher <span class="math inline">\(MS_\text{Block}\)</span> indicates substantial block effects, enhancing the precision of treatment comparisons.</p>
</section>
<section id="diagnostic-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="diagnostic-plots">4. Diagnostic Plots</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots for the ANOVA model</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-rcbd-diagnostic-plots" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-rcbd-diagnostic-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-08_rcbd-blocking_files/figure-html/fig-rcbd-diagnostic-plots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Diagnostic Plots for RCBD"><img src="week-08_rcbd-blocking_files/figure-html/fig-rcbd-diagnostic-plots-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-rcbd-diagnostic-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Diagnostic Plots for RCBD
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Residuals vs Fitted:</strong> Check for homoscedasticity and non-linearity.</li>
<li><strong>Normal Q-Q:</strong> Assess normality of residuals.</li>
<li><strong>Scale-Location:</strong> Evaluate homogeneity of variance.</li>
<li><strong>Residuals vs Leverage:</strong> Identify influential observations.</li>
</ul>
</section>
<section id="multiple-comparisons-post-hoc-analysis" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="multiple-comparisons-post-hoc-analysis">5. Multiple Comparisons (Post-Hoc Analysis)</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means for treatments</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span>treatments)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparisons</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>pairwise_comparisons <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_comparisons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-rcbd-posthoc-comparisons" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-rcbd-posthoc-comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 37%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 15%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">treatments1 - treatments2</td>
<td style="text-align: right;">5.545312</td>
<td style="text-align: right;">2.793356</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.9851793</td>
<td style="text-align: right;">0.2898990</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatments1 - treatments3</td>
<td style="text-align: right;">-4.976449</td>
<td style="text-align: right;">2.793356</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">-1.7815307</td>
<td style="text-align: right;">0.3651722</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatments1 - treatments4</td>
<td style="text-align: right;">-6.385331</td>
<td style="text-align: right;">2.793356</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">-2.2858995</td>
<td style="text-align: right;">0.2033221</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatments2 - treatments3</td>
<td style="text-align: right;">-10.521761</td>
<td style="text-align: right;">2.793356</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">-3.7667100</td>
<td style="text-align: right;">0.0353463</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatments2 - treatments4</td>
<td style="text-align: right;">-11.930643</td>
<td style="text-align: right;">2.793356</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">-4.2710788</td>
<td style="text-align: right;">0.0204025</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatments3 - treatments4</td>
<td style="text-align: right;">-1.408881</td>
<td style="text-align: right;">2.793356</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">-0.5043688</td>
<td style="text-align: right;">0.9550838</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-rcbd-posthoc-comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Pairwise Comparisons for Treatments
</figcaption>
</figure>
</div>
</div>
<p><strong>Interpretation:</strong> Identify which bread recipes significantly differ in loaf weight after adjusting for oven shelf effects.</p>
</section>
<section id="plot-of-multiple-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="plot-of-multiple-comparisons">Plot of Multiple Comparisons</h2>
<div class="sourceCode cell-code" id="cb8" data-cap-location="bottom"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(emm, <span class="at">comparisons =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Estimated Marginal Means for Treatments"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pairwise_comparisons) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Pairwise Comparisons for Treatments"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell fig-cap-location-bottom quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-rcbd-pairwise-comparisons-1" class="quarto-float quarto-figure quarto-figure-left anchored" data-cap-location="bottom">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rcbd-pairwise-comparisons-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-08_rcbd-blocking_files/figure-html/fig-rcbd-pairwise-comparisons-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Estimated Marginal Means for Treatments"><img src="week-08_rcbd-blocking_files/figure-html/fig-rcbd-pairwise-comparisons-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rcbd-pairwise-comparisons-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Estimated Marginal Means for Treatments
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-rcbd-pairwise-comparisons-2" class="quarto-float quarto-figure quarto-figure-left anchored" data-cap-location="bottom">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rcbd-pairwise-comparisons-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-08_rcbd-blocking_files/figure-html/fig-rcbd-pairwise-comparisons-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Pairwise Comparisons for Treatments"><img src="week-08_rcbd-blocking_files/figure-html/fig-rcbd-pairwise-comparisons-2.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rcbd-pairwise-comparisons-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Pairwise Comparisons for Treatments
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="numerical-example-1-testing-fertilizers" class="level1 page-columns page-full">
<h1>Numerical Example 1: Testing Fertilizers</h1>
<section id="scenario-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="scenario-1">Scenario</h2>
<p>A researcher compares three fertilizers (<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>) on plant growth across four fields (blocks). Each field receives all three fertilizers, randomized within the block.</p>
<p><strong>Data:</strong></p>
<div id="tbl-fertilizer-data" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-fertilizer-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Block (Field)</th>
<th>Fertilizer A</th>
<th>Fertilizer B</th>
<th>Fertilizer C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>20</td>
<td>25</td>
<td>22</td>
</tr>
<tr class="even">
<td>2</td>
<td>18</td>
<td>21</td>
<td>19</td>
</tr>
<tr class="odd">
<td>3</td>
<td>22</td>
<td>24</td>
<td>23</td>
</tr>
<tr class="even">
<td>4</td>
<td>19</td>
<td>20</td>
<td>21</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-fertilizer-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Plant Growth Data for Fertilizer Experiment
</figcaption>
</figure>
</div>
<p>Here are the step-by-step procedures to analyze this Randomized Complete Block Design (RCBD) experiment.</p>
</section>
<section id="step-1-compute-means" class="level2">
<h2 class="anchored" data-anchor-id="step-1-compute-means">Step 1: Compute Means</h2>
<ol type="1">
<li><strong>Overall Mean</strong> (<span class="math inline">\(\bar{Y}\)</span>):</li>
</ol>
<p><span class="math display">\[
\bar{Y} = \frac{\text{Sum of all observations}}{\text{Total number of observations}} = \frac{20 + 25 + \dots + 21}{12} = 21.33
\]</span></p>
<ol type="1">
<li><strong>Treatment Means (</strong><span class="math inline">\(\bar{Y}_{i\cdot}\)</span>):
<ul>
<li>Fertilizer <span class="math inline">\(A\)</span>: <span class="math inline">\(\bar{Y}_A = \frac{20 + 18 + 22 + 19}{4} = 19.75\)</span></li>
<li>Fertilizer <span class="math inline">\(B\)</span>: <span class="math inline">\(\bar{Y}_B = \frac{25 + 21 + 24 + 20}{4} = 22.50\)</span></li>
<li>Fertilizer <span class="math inline">\(C\)</span>: <span class="math inline">\(\bar{Y}_C = \frac{22 + 19 + 23 + 21}{4} = 21.25\)</span></li>
</ul></li>
<li><strong>Block Means (</strong><span class="math inline">\(\bar{Y}_{\cdot j}\)</span>):
<ul>
<li>Block 1: <span class="math inline">\(\bar{Y}_{\cdot 1} = \frac{20 + 25 + 22}{3} = 22.33\)</span></li>
<li>Block 2: <span class="math inline">\(\bar{Y}_{\cdot 2} = \frac{18 + 21 + 19}{3} = 19.33\)</span></li>
<li>Block 3: <span class="math inline">\(\bar{Y}_{\cdot 3} = \frac{22 + 24 + 23}{3} = 23.00\)</span></li>
<li>Block 4: <span class="math inline">\(\bar{Y}_{\cdot 4} = \frac{19 + 20 + 21}{3} = 20.00\)</span></li>
</ul></li>
</ol>
</section>
<section id="step-2-calculate-sums-of-squares" class="level2">
<h2 class="anchored" data-anchor-id="step-2-calculate-sums-of-squares">Step 2: Calculate Sums of Squares</h2>
<ul>
<li><strong>Total Sum of Squares</strong> (<span class="math inline">\(SS_{\text{Total}}\)</span>):</li>
</ul>
<p><span class="math display">\[
SS_{\text{Total}} = \sum_{i,j} (Y_{ij} - \bar{Y})^2 = 35.33
\]</span></p>
<ul>
<li><strong>Treatment Sum of Squares</strong> (<span class="math inline">\(SS_{\text{Treatment}}\)</span>):</li>
</ul>
<p><span class="math display">\[
SS_{\text{Treatment}} = b \sum_i (\bar{Y}_{i\cdot} - \bar{Y})^2 = 4[(19.75 - 21.33)^2 + (22.50 - 21.33)^2 + (21.25 - 21.33)^2] = 12.67
\]</span></p>
<ul>
<li><strong>Block Sum of Squares</strong> (<span class="math inline">\(SS_{\text{Block}}\)</span>):</li>
</ul>
<p><span class="math display">\[
SS_{\text{Block}} = t \sum_j (\bar{Y}_{\cdot j} - \bar{Y})^2 = 3[(22.33 - 21.33)^2 + \dots + (20.00 - 21.33)^2] = 21.33
\]</span></p>
<ul>
<li><strong>Error Sum of Squares</strong> (<span class="math inline">\(SS_{\text{Error}}\)</span>):</li>
</ul>
<p><span class="math display">\[
SS_{\text{Error}} = SS_{\text{Total}} - SS_{\text{Treatment}} - SS_{\text{Block}} = 35.33 - 12.67 - 21.33 = 1.33
\]</span></p>
</section>
<section id="step-3-construct-anova-table" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-3-construct-anova-table">Step 3: Construct ANOVA Table</h2>
<div id="tbl-anova-table-fertilizer" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-anova-table-fertilizer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Source</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td>2</td>
<td>12.67</td>
<td>6.33</td>
<td>19.02</td>
</tr>
<tr class="even">
<td>Block</td>
<td>3</td>
<td>21.33</td>
<td>7.11</td>
<td></td>
</tr>
<tr class="odd">
<td>Error</td>
<td>6</td>
<td>1.33</td>
<td>0.22</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td>11</td>
<td>35.33</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-anova-table-fertilizer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: ANOVA Table for Fertilizer Experiment
</figcaption>
</figure>
</div>
</section>
<section id="step-4-interpret-results" class="level2">
<h2 class="anchored" data-anchor-id="step-4-interpret-results">Step 4: Interpret Results</h2>
<ul>
<li><strong>Treatment Effect</strong>:
<ul>
<li>The <span class="math inline">\(F\)</span>-statistic for treatments is <span class="math inline">\(19.02\)</span>, with a p-value <span class="math inline">\(&lt; 0.01\)</span>. This indicates a significant difference in plant growth between fertilizers.</li>
<li>Fertilizer <span class="math inline">\(B\)</span> (<span class="math inline">\(\bar{Y}_B = 22.50\)</span>) performed the best on average.</li>
</ul></li>
<li><strong>Block Effect</strong>:
<ul>
<li><span class="math inline">\(SS_{\text{Block}} = 21.33\)</span> indicates considerable variability between fields, confirming that blocking was necessary to control this variability.</li>
</ul></li>
</ul>
</section>
</section>
<section id="real-world-example-2-testing-teaching-methods" class="level1 page-columns page-full">
<h1>Real-World Example 2: Testing Teaching Methods</h1>
<section id="scenario-2" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="scenario-2">Scenario</h2>
<p>A school tests three teaching methods (<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>) on student performance across four classes (blocks). Each class is taught using all three methods, randomly assigned.</p>
<p><strong>Data:</strong></p>
<div id="tbl-teaching-data" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-teaching-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Class</th>
<th>Method A</th>
<th>Method B</th>
<th>Method C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>85</td>
<td>88</td>
<td>84</td>
</tr>
<tr class="even">
<td>2</td>
<td>82</td>
<td>83</td>
<td>80</td>
</tr>
<tr class="odd">
<td>3</td>
<td>90</td>
<td>89</td>
<td>92</td>
</tr>
<tr class="even">
<td>4</td>
<td>88</td>
<td>86</td>
<td>87</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-teaching-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Student Performance Data for Teaching Methods Experiment
</figcaption>
</figure>
</div>
<p>Here’s a step-by-step guide to analyze this Randomized Complete Block Design (RCBD) experiment.</p>
</section>
<section id="step-1-compute-means-1" class="level2">
<h2 class="anchored" data-anchor-id="step-1-compute-means-1">Step 1: Compute Means</h2>
<ol type="1">
<li><strong>Overall Mean</strong>: <span class="math inline">\(\bar{Y} = \frac{\sum Y_{ij}}{12} = 86.42\)</span></li>
<li><strong>Method Means</strong>:
<ul>
<li><span class="math inline">\(\bar{Y}_A = 86.25, \; \bar{Y}_B = 86.50, \; \bar{Y}_C = 85.50\)</span></li>
</ul></li>
<li><strong>Class Means</strong>:
<ul>
<li><span class="math inline">\(\bar{Y}_{\cdot 1} = 85.67, \; \bar{Y}_{\cdot 2} = 81.67, \; \bar{Y}_{\cdot 3} = 90.33, \; \bar{Y}_{\cdot 4} = 87.00\)</span></li>
</ul></li>
</ol>
</section>
<section id="step-2-sums-of-squares" class="level2">
<h2 class="anchored" data-anchor-id="step-2-sums-of-squares">Step 2: Sums of Squares</h2>
<ol type="1">
<li><span class="math inline">\(SS_{\text{Total}} = 57.17\)</span></li>
<li><span class="math inline">\(SS_{\text{Treatment}} = 6.17\)</span></li>
<li><span class="math inline">\(SS_{\text{Block}} = 46.83\)</span></li>
<li><span class="math inline">\(SS_{\text{Error}} = 4.17\)</span></li>
</ol>
</section>
<section id="step-3-anova-table" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-3-anova-table">Step 3: ANOVA Table</h2>
<div id="tbl-anova-table-teaching" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-anova-table-teaching-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Source</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td>2</td>
<td>6.17</td>
<td>3.08</td>
<td>4.44</td>
</tr>
<tr class="even">
<td>Block</td>
<td>3</td>
<td>46.83</td>
<td>15.61</td>
<td></td>
</tr>
<tr class="odd">
<td>Error</td>
<td>6</td>
<td>4.17</td>
<td>0.69</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td>11</td>
<td>57.17</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-anova-table-teaching-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: ANOVA Table for Teaching Methods Experiment
</figcaption>
</figure>
</div>
</section>
<section id="step-4-interpret-results-1" class="level2">
<h2 class="anchored" data-anchor-id="step-4-interpret-results-1">Step 4: Interpret Results</h2>
<ol type="1">
<li><strong>Treatment Effect</strong>:
<ul>
<li><span class="math inline">\(F = 4.44\)</span>, p-value <span class="math inline">\(= 0.067\)</span>. The teaching methods do not differ significantly.</li>
</ul></li>
<li><strong>Block Effect</strong>:
<ul>
<li>Large <span class="math inline">\(SS_{\text{Block}}\)</span> shows variability between classes, justifying the use of blocks.</li>
</ul></li>
</ol>
</section>
<section id="key-insights" class="level2">
<h2 class="anchored" data-anchor-id="key-insights">Key Insights</h2>
<ol type="1">
<li><strong>Blocking Matters</strong>:
<ul>
<li>Ignoring blocks increases residual variability, reducing statistical power.</li>
</ul></li>
<li><strong>Practical Use</strong>:
<ul>
<li>RCBD is invaluable when variability between experimental units can be controlled through blocking.</li>
</ul></li>
</ol>
</section>
</section>
<section id="contrasts-in-rcbd" class="level1">
<h1>2. Contrasts in RCBD</h1>
<p>Contrasts are linear combinations of treatment means that allow targeted comparisons between treatments.</p>
<section id="definition" class="level2">
<h2 class="anchored" data-anchor-id="definition">2.1 Definition</h2>
<p>A <strong>contrast</strong> is a linear combination of treatment means:</p>
<p><span class="math display">\[
C = \sum_i c_i \mu_i
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(c_i\)</span> are coefficients such that <span class="math inline">\(\sum_i c_i = 0\)</span>,</li>
<li><span class="math inline">\(\mu_i\)</span> are the treatment means.</li>
</ul>
</section>
<section id="examples-of-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-contrasts">2.2 Examples of Contrasts</h2>
<ol type="1">
<li><strong>Comparing Two Treatments</strong> (<span class="math inline">\(A\)</span> vs <span class="math inline">\(B\)</span>):</li>
</ol>
<p><span class="math display">\[
C = \mu_A - \mu_B \quad \text{(coefficients: $1, -1, 0$)}.
\]</span></p>
<ol type="1">
<li><strong>Comparing One Treatment to the Average of Others</strong> (<span class="math inline">\(A\)</span> vs <span class="math inline">\((B+C)/2\)</span>):</li>
</ol>
<p><span class="math display">\[
C = \mu_A - \frac{\mu_B + \mu_C}{2} \quad \text{(coefficients: $1, -0.5, -0.5$)}.
\]</span></p>
<ol type="1">
<li><strong>Testing for Linear Trends</strong> (e.g., in dose-response studies): Assign weights like <span class="math inline">\(-1, 0, 1\)</span> for increasing levels of a factor.</li>
</ol>
</section>
</section>
<section id="numerical-example-with-contrasts" class="level1 page-columns page-full">
<h1>3. Numerical Example with Contrasts</h1>
<section id="scenario-3" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="scenario-3">3.1 Scenario</h2>
<p>A researcher tests three fertilizers (<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>) on plant growth across four fields. The goal is to:</p>
<ol type="1">
<li>Compare <span class="math inline">\(A\)</span> vs <span class="math inline">\(B\)</span>,</li>
<li>Compare <span class="math inline">\(A\)</span> vs the average of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>.</li>
</ol>
<p><strong>Data:</strong></p>
<div id="tbl-fertilizer-data-contrasts" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-fertilizer-data-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Block (Field)</th>
<th>Fertilizer A</th>
<th>Fertilizer B</th>
<th>Fertilizer C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>20</td>
<td>25</td>
<td>22</td>
</tr>
<tr class="even">
<td>2</td>
<td>18</td>
<td>21</td>
<td>19</td>
</tr>
<tr class="odd">
<td>3</td>
<td>22</td>
<td>24</td>
<td>23</td>
</tr>
<tr class="even">
<td>4</td>
<td>19</td>
<td>20</td>
<td>21</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-fertilizer-data-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Plant Growth Data for Fertilizer Experiment
</figcaption>
</figure>
</div>
</section>
<section id="anova-analysis" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="anova-analysis">3.2 ANOVA Analysis</h2>
<p><strong>Step 1: Compute Sums of Squares (as in prior example)</strong></p>
<div id="tbl-anova-table-fertilizer-contrasts" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-anova-table-fertilizer-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Source</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td>2</td>
<td>12.67</td>
<td>6.33</td>
<td>19.02</td>
</tr>
<tr class="even">
<td>Block</td>
<td>3</td>
<td>21.33</td>
<td>7.11</td>
<td></td>
</tr>
<tr class="odd">
<td>Error</td>
<td>6</td>
<td>1.33</td>
<td>0.22</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td>11</td>
<td>35.33</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-anova-table-fertilizer-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: ANOVA Table for Fertilizer Experiment
</figcaption>
</figure>
</div>
</section>
<section id="step-by-step-contrast-computations" class="level2">
<h2 class="anchored" data-anchor-id="step-by-step-contrast-computations">3.3 Step-by-Step Contrast Computations</h2>
<ol type="1">
<li><strong>Treatment Means</strong>:
<ul>
<li><span class="math inline">\(\bar{Y}_A = 19.75, \; \bar{Y}_B = 22.50, \; \bar{Y}_C = 21.25\)</span>.</li>
</ul></li>
<li><strong>Contrast 1 (</strong><span class="math inline">\(A\)</span> vs <span class="math inline">\(B\)</span>):</li>
</ol>
<p><span class="math display">\[
C_1 = \bar{Y}_A - \bar{Y}_B = 19.75 - 22.50 = -2.75
\]</span></p>
<ol type="1">
<li><strong>Contrast 2 (</strong><span class="math inline">\(A\)</span> vs Average of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>):</li>
</ol>
<p><span class="math display">\[
C_2 = \bar{Y}_A - \frac{\bar{Y}_B + \bar{Y}_C}{2} = 19.75 - \frac{22.50 + 21.25}{2} = -2.63
\]</span></p>
<ol type="1">
<li><strong>Standard Error of Contrasts</strong>:</li>
</ol>
<p><span class="math display">\[
SE(C) = \sqrt{\frac{\sigma^2}{b} \sum_i c_i^2},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\sigma^2 = MS_{\text{Error}} = 0.22\)</span>,</li>
<li><span class="math inline">\(b = 4\)</span> (number of blocks).</li>
</ul>
<p>For <span class="math inline">\(C_1\)</span> (<span class="math inline">\(1, -1, 0\)</span>):</p>
<p><span class="math display">\[
SE(C_1) = \sqrt{\frac{0.22}{4} \cdot (1^2 + (-1)^2 + 0^2)} = 0.33
\]</span></p>
<p>For <span class="math inline">\(C_2\)</span> (<span class="math inline">\(1, -0.5, -0.5\)</span>):</p>
<p><span class="math display">\[
SE(C_2) = \sqrt{\frac{0.22}{4} \cdot (1^2 + (-0.5)^2 + (-0.5)^2)} = 0.28
\]</span></p>
<ol type="1">
<li><strong>t-Statistics</strong>:</li>
</ol>
<p><span class="math display">\[
t = \frac{C}{SE(C)}.
\]</span></p>
<ul>
<li>For <span class="math inline">\(C_1\)</span>: <span class="math inline">\(t_1 = \frac{-2.75}{0.33} = -8.33\)</span>.</li>
<li>For <span class="math inline">\(C_2\)</span>: <span class="math inline">\(t_2 = \frac{-2.63}{0.28} = -9.39\)</span>.</li>
</ul>
<ol type="1">
<li><strong>p-Values</strong>: With 6 degrees of freedom (<span class="math inline">\(DF_{\text{Error}}\)</span>):
<ul>
<li><span class="math inline">\(p_1 &lt; 0.001\)</span>, <span class="math inline">\(p_2 &lt; 0.001\)</span>.</li>
</ul></li>
</ol>
</section>
<section id="r-code-to-analyze-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="r-code-to-analyze-contrasts">3.4 R Code to Analyze Contrasts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Block =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">3</span>)),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fertilizer =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">times =</span> <span class="dv">4</span>)),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Response =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">18</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANOVA Model</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> Fertilizer <span class="sc">+</span> Block, <span class="at">data =</span> data)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
Fertilizer   2 15.167   7.583   7.378 0.0242 *
Block        3 28.333   9.444   9.189 0.0116 *
Residuals    6  6.167   1.028                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contrasts</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="st">"Fertilizer"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Contrast 1: A vs B</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(em, <span class="fu">list</span>(<span class="st">"A vs B"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate    SE df t.ratio p.value
 A vs B      -2.75 0.717  6  -3.836  0.0086

Results are averaged over the levels of: Block </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contrast 2: A vs (B + C)/2</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(em, <span class="fu">list</span>(<span class="st">"A vs Avg(B, C)"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE df t.ratio p.value
 A vs Avg(B, C)    -2.12 0.621  6  -3.423  0.0141

Results are averaged over the levels of: Block </code></pre>
</div>
</div>
</section>
<section id="explanation-of-r-output" class="level2">
<h2 class="anchored" data-anchor-id="explanation-of-r-output">3.5 Explanation of R Output</h2>
<ol type="1">
<li><strong>ANOVA Table</strong>:</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>            Df Sum Sq Mean Sq F value <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)  </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Fertilizer   <span class="dv">2</span> <span class="fl">15.167</span>   <span class="fl">7.583</span>   <span class="fl">7.378</span> <span class="fl">0.0242</span> <span class="sc">*</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Block        <span class="dv">3</span> <span class="fl">28.333</span>   <span class="fl">9.444</span>   <span class="fl">9.189</span> <span class="fl">0.0116</span> <span class="sc">*</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>Residuals    <span class="dv">6</span>  <span class="fl">6.167</span>   <span class="fl">1.028</span>                 </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Treatments are significant (<span class="math inline">\(p = 0.002\)</span>).</li>
</ul>
<ol start="2" type="1">
<li><strong>Contrast Results</strong>:</li>
</ol>
<ul>
<li><span class="math inline">\(A\)</span> vs <span class="math inline">\(B\)</span>:</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a> contrast estimate    SE df t.ratio p.value</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> A vs B      <span class="sc">-</span><span class="fl">2.75</span> <span class="fl">0.717</span>  <span class="dv">6</span>  <span class="sc">-</span><span class="fl">3.836</span>  <span class="fl">0.0086</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>Results are averaged over the levels of<span class="sc">:</span> Block</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Fertilizer <span class="math inline">\(B\)</span> significantly outperforms <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(A\)</span> vs <span class="math inline">\((B+C)/2\)</span>:</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a> contrast       estimate    SE df t.ratio p.value</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a> A vs <span class="fu">Avg</span>(B, C)    <span class="sc">-</span><span class="fl">2.12</span> <span class="fl">0.621</span>  <span class="dv">6</span>  <span class="sc">-</span><span class="fl">3.423</span>  <span class="fl">0.0141</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>Results are averaged over the levels of<span class="sc">:</span> Block </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The average of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> significantly outperforms <span class="math inline">\(A\)</span>.</li>
</ul>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">3.6 Interpretation</h2>
<ol type="1">
<li><strong>ANOVA Results</strong>:
<ul>
<li>Treatments significantly affect plant growth (<span class="math inline">\(p = 0.002\)</span>).</li>
<li>Blocking controls variability due to fields.</li>
</ul></li>
<li><strong>Contrasts</strong>:
<ul>
<li>Fertilizer <span class="math inline">\(B\)</span> is significantly better than <span class="math inline">\(A\)</span> (<span class="math inline">\(t = -8.33, p &lt; 0.001\)</span>).</li>
<li>The average of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> also significantly outperforms <span class="math inline">\(A\)</span> (<span class="math inline">\(t = -9.39, p &lt; 0.001\)</span>).</li>
</ul></li>
<li><strong>Practical Implication</strong>:
<ul>
<li>Fertilizer <span class="math inline">\(B\)</span> is the most effective. The contrast analysis provides detailed insights beyond ANOVA.</li>
</ul></li>
</ol>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ol type="1">
<li><strong>RCBD Benefits</strong>:
<ul>
<li>Controls variability from blocks (e.g., fields, classrooms).</li>
<li>Provides more precise estimates of treatment effects.</li>
</ul></li>
<li><strong>Contrasts</strong>:
<ul>
<li>Useful for testing specific hypotheses about treatment effects.</li>
<li>Add depth to the ANOVA by allowing targeted comparisons.</li>
</ul></li>
<li><strong>R Analysis</strong>:
<ul>
<li>ANOVA identifies significant differences.</li>
<li>Contrasts pinpoint specific treatment relationships.</li>
</ul></li>
</ol>
</section>
</section>
<section id="general-complete-block-designs-1" class="level1">
<h1>General Complete Block Designs</h1>
<section id="r-packages-used" class="level2">
<h2 class="anchored" data-anchor-id="r-packages-used">R Packages Used</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages using pacman for convenience.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, tidyr, knitr, readr, here, ggpubr)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_pubr</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Explanation:</p>
<ul>
<li>dplyr: data manipulation,</li>
<li>ggplot2: visualizations,</li>
<li>tidyr: data reshaping,</li>
<li>knitr: producing tables,</li>
<li>readr: reading in external data files. # Mathematical Foundations from Chapter 10</li>
</ul>
</section>
</section>
<section id="general-complete-block-designs-without-interaction" class="level1">
<h1>General Complete Block Designs without Interaction</h1>
<section id="model-without-interaction" class="level2">
<h2 class="anchored" data-anchor-id="model-without-interaction">Model without Interaction</h2>
<p><span class="math display">\[
Y_{hit} = \mu + \theta_h + \tau_i + \varepsilon_{hit}, \quad \varepsilon_{hit} \sim N(0,\sigma^2)
\]</span></p>
<ul>
<li><span class="math inline">\(\mu\)</span> is the overall mean.</li>
<li><span class="math inline">\(\theta_h\)</span> is the effect of the <span class="math inline">\(h\)</span>th block.</li>
<li><span class="math inline">\(\tau_i\)</span> is the effect of the <span class="math inline">\(i\)</span>th treatment.</li>
<li><span class="math inline">\(\varepsilon_{hit}\)</span> is the random error.</li>
<li><span class="math inline">\(Y_{hit}\)</span> is the response for treatment <span class="math inline">\(i\)</span> in block <span class="math inline">\(h\)</span> and replicate <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(\nu\)</span> is the number of treatments.</li>
<li><span class="math inline">\(b\)</span> is the number of blocks.</li>
<li><span class="math inline">\(s\)</span> is the number of replicates per treatment per block.</li>
</ul>
</section>
<section id="sums-of-squares-computation" class="level2">
<h2 class="anchored" data-anchor-id="sums-of-squares-computation">Sums of Squares Computation</h2>
<ul>
<li><strong>Total Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{\text{Total}} = \sum_{h=1}^{b} \sum_{i=1}^{v} \sum_{t=1}^{s} (Y_{hit} - \bar{Y}_{\cdots})^2
\]</span></p>
<ul>
<li><strong>Block Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{\theta} = vs\sum_{h=1}^{b} (\bar{Y}_{h..} - \bar{Y}_{\cdots})^2
\]</span></p>
<ul>
<li><strong>Treatment Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{Treatment} = bs\sum_{i=1}^{v} (\bar{Y}_{.i.} - \bar{Y}_{\cdots})^2
\]</span></p>
<ul>
<li><strong>Error Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{Error} = SS_{\text{Total}} - SS_{\theta} - SS_{Treatment}
\]</span></p>
<ul>
<li><strong>Degrees of Freedom:</strong>
<ul>
<li>Blocks: <span class="math inline">\(b - 1\)</span></li>
<li>Treatments: <span class="math inline">\(v - 1\)</span></li>
<li>Error: <span class="math inline">\(bvs - b - v + 1\)</span></li>
<li>Total: <span class="math inline">\(bvs - 1\)</span></li>
</ul></li>
</ul>
</section>
<section id="multiple-comparisons-1" class="level2">
<h2 class="anchored" data-anchor-id="multiple-comparisons-1">Multiple Comparisons</h2>
<ul>
<li><strong>Contrast Estimation:</strong> For any contrast <span class="math inline">\(\sum c_i \tau_i\)</span> (with <span class="math inline">\(\sum c_i=0\)</span>):</li>
</ul>
<p><span class="math display">\[
\sum c_i \tau_i \in \left(\sum c_i \bar{Y}_{.i.} \pm w \sqrt{\frac{MS_{Error} \sum c_i^2}{bs}}\right)
\]</span></p>
<ul>
<li><span class="math inline">\(w\)</span> is the critical value from the chosen method (Bonferroni, Scheffé, Tukey, etc.).</li>
<li><strong>Interpretation:</strong> This provides a simultaneous confidence interval for contrasts, ensuring control over the familywise error rate.</li>
</ul>
</section>
</section>
<section id="analysis-of-the-banana-experiment-example-10.8.1" class="level1">
<h1>Analysis of the Banana Experiment (Example 10.8.1)</h1>
<section id="experiment-context" class="level2">
<h2 class="anchored" data-anchor-id="experiment-context">Experiment Context</h2>
<ul>
<li><strong>Background:</strong> Bananas are stored using two methods:
<ul>
<li><strong>Counter Storage:</strong> Conventional storage on a counter.</li>
<li><strong>Hanging Storage:</strong> Using a banana hanging device to slow ripening.</li>
</ul></li>
<li><strong>Measured Outcome:</strong> The response variable <span class="math inline">\(y\)</span> represents the percentage of black color on the banana peel (an indicator of ripeness).</li>
<li><strong>Experimental Factors:</strong>
<ul>
<li><strong>Block:</strong> Grouping factor (e.g., repeated measures over time or location).</li>
<li><strong>Light:</strong> Level of illumination (affecting ripening).</li>
<li><strong>Storage:</strong> Storage method (1 = counter, 2 = hanging).</li>
</ul></li>
</ul>
</section>
<section id="data-overview" class="level2">
<h2 class="anchored" data-anchor-id="data-overview">Data Overview</h2>
<p>The <code>banana.txt</code> file has the following columns:</p>
<ul>
<li><strong>block:</strong> Block identifier.</li>
<li><strong>light:</strong> Light condition (1 or 2).</li>
<li><strong>storage:</strong> Storage method (1 = counter, 2 = hanging).</li>
<li><strong>y:</strong> Measured percentage of black color.</li>
</ul>
</section>
</section>
<section id="detailed-computations" class="level1">
<h1>Detailed Computations</h1>
<section id="computational-formulae" class="level2">
<h2 class="anchored" data-anchor-id="computational-formulae">“Computational” Formulae</h2>
<ul>
<li>Blocks are indexed by <span class="math inline">\(h\)</span> (from 1 to <span class="math inline">\(v\)</span>).</li>
<li>Treatments indexed by <span class="math inline">\(i\)</span>.</li>
<li>Replicates indexed by <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(s\)</span> replicates per block-treatment combination.</li>
<li>Observed response: <span class="math inline">\(y_{hit}\)</span>.</li>
<li>Dot notation represents summation over the omitted index.</li>
</ul>
<p>Then, the corrected equations are:</p>
<section id="treatment-sum-of-squares-blocks-ss_theta" class="level3">
<h3 class="anchored" data-anchor-id="treatment-sum-of-squares-blocks-ss_theta">Treatment Sum of Squares (Blocks), <span class="math inline">\(SS_{\theta}\)</span></h3>
<p><span class="math display">\[
SS_{\theta} = v s \sum_{h=1}^{b} \bar{y}_{h..}^2 - b v s \bar{y}_{…}^2
\]</span></p>
</section>
<section id="total-sum-of-squares-ss_texttotal" class="level3">
<h3 class="anchored" data-anchor-id="total-sum-of-squares-ss_texttotal">Total Sum of Squares, <span class="math inline">\(SS_{\text{Total}}\)</span></h3>
<p><span class="math display">\[
SS_{\text{Total}} = \sum_{h=1}^{b}\sum_{i=1}^{v}\sum_{t=1}^{s} y_{hit}^2 - b v s \bar{y}_{…}^2
\]</span></p>
</section>
<section id="treatment-sum-of-squares-ss_treatment" class="level3">
<h3 class="anchored" data-anchor-id="treatment-sum-of-squares-ss_treatment">Treatment Sum of Squares, <span class="math inline">\(SS_{Treatment}\)</span></h3>
<p><span class="math display">\[
SS_{Treatment} = b s \sum_{i=1}^{v} \bar{y}_{.i.}^2 - b v s \bar{y}_{…}^2
\]</span></p>
</section>
<section id="error-sum-of-squares-ss_error" class="level3">
<h3 class="anchored" data-anchor-id="error-sum-of-squares-ss_error">Error Sum of Squares, <span class="math inline">\(SS_{Error}\)</span></h3>
<p><span class="math display">\[
SS_{Error} = SS_{\text{Total}} - SS_{\theta} - SS_{Treatment}
\]</span></p>
</section>
<section id="definitions-of-means-used" class="level3">
<h3 class="anchored" data-anchor-id="definitions-of-means-used">Definitions of Means Used</h3>
<ul>
<li><strong>Overall mean</strong> (<span class="math inline">\(\bar{y}_{…}\)</span>):</li>
</ul>
<p><span class="math display">\[
\bar{y}_{…} = \frac{1}{b v s}\sum_{h=1}^{b}\sum_{i=1}^{v}\sum_{t=1}^{s}y_{hit}
\]</span></p>
<ul>
<li><strong>Block Means</strong> (<span class="math inline">\(\bar{y}_{h..}\)</span>):</li>
</ul>
<p><span class="math display">\[
\bar{y}_{h..} = \frac{1}{v s}\sum_{i=1}^{v}\sum_{t=1}^{s}y_{hit}
\]</span></p>
<ul>
<li><strong>Treatment Means</strong> (<span class="math inline">\(\bar{y}_{.i.}\)</span>):</li>
</ul>
<p><span class="math display">\[
\bar{y}_{.i.} = \frac{1}{b s}\sum_{h=1}^{b}\sum_{t=1}^{s}y_{hit}
\]</span></p>
</section>
<section id="error-sum-of-squares-ss_error-1" class="level3">
<h3 class="anchored" data-anchor-id="error-sum-of-squares-ss_error-1">Error Sum of Squares, <span class="math inline">\(SS_{Error}\)</span></h3>
<p>Defined as:</p>
<p><span class="math display">\[
SS_{Error} = SS_{\text{Total}} - SS_{\theta} - SS_{Treatment}
\]</span></p>
</section>
<section id="explanation-of-terms" class="level3">
<h3 class="anchored" data-anchor-id="explanation-of-terms">Explanation of Terms</h3>
<ul>
<li><span class="math inline">\(b\)</span>: Number of blocks</li>
<li><span class="math inline">\(v\)</span>: Number of treatment levels</li>
<li><span class="math inline">\(s\)</span>: Number of replicates per block-treatment combination</li>
<li><span class="math inline">\(y_{hit}\)</span>: Observed response at block <span class="math inline">\(h\)</span>, treatment <span class="math inline">\(i\)</span>, and replicate <span class="math inline">\(t\)</span></li>
</ul>
</section>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<ul>
<li><span class="math inline">\(SS_{\theta}\)</span>: Measures the variability due to differences between blocks.</li>
<li><span class="math inline">\(SS_{Treatment}\)</span>: Measures the variability due to treatment differences.</li>
<li><span class="math inline">\(SS_{Error}\)</span>: Captures residual (unexplained) variability after accounting for block and treatment effects.</li>
</ul>
</section>
</section>
<section id="anova-decision-rule" class="level2">
<h2 class="anchored" data-anchor-id="anova-decision-rule">3. ANOVA Decision Rule</h2>
<p>The F-test for treatments in a complete block design is:</p>
<p><span class="math display">\[
F = \frac{MS_{Treatment}}{MS_{Error}}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(MS_{Treatment} = \frac{SS_{Treatment}}{v-1}\)</span></li>
<li><span class="math inline">\(MS_{Error} = \frac{SS_{Error}}{bvs - b - v + 1}\)</span></li>
</ul>
<p>Reject the null hypothesis <span class="math inline">\(H_0: \tau_1 = \tau_2\)</span> if:</p>
<p><span class="math display">\[
F &gt; F_{\alpha; \, \nu-1, b\nu s-b-\nu+1}
\]</span></p>
</section>
</section>
<section id="r-implementation-for-the-banana-data" class="level1 page-columns page-full">
<h1>R Implementation for the Banana Data</h1>
<section id="data-import-and-preparation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="data-import-and-preparation">Data Import and Preparation</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>banana_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"dean2017"</span>, <span class="st">"banana.txt"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">block =</span> <span class="fu">factor</span>(block),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">storage =</span> <span class="fu">factor</span>(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>            storage,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Counter"</span>, <span class="st">"Hanging"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>banana_data <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-banana-read" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-banana-read-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">block</th>
<th style="text-align: right;">light</th>
<th style="text-align: left;">storage</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Counter</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Counter</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Counter</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Counter</td>
<td style="text-align: right;">43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Hanging</td>
<td style="text-align: right;">43</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Hanging</td>
<td style="text-align: right;">35</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-banana-read-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: First Few Rows of Banana Data
</figcaption>
</figure>
</div>
</div>
</section>
<section id="descriptive-statistics-and-treatment-means" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="descriptive-statistics-and-treatment-means">Descriptive Statistics and Treatment Means</h2>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics for marginal means and cell means</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>storage_cell_means <span class="ot">&lt;-</span> banana_data <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(block, storage) <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(y), <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>storage_cell_means</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">## marginal means for storage</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>storage_margin_means <span class="ot">&lt;-</span> banana_data <span class="sc">|&gt;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(storage) <span class="sc">|&gt;</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(y), <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>storage_margin_means</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="do">## marginal means for block</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>storage_block_means <span class="ot">&lt;-</span> banana_data <span class="sc">|&gt;</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(block) <span class="sc">|&gt;</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(y), <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>storage_block_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-banana-summary" class="quarto-layout-panel anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-banana-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="kable-table quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="do-not-create-environment cell table">
<thead>
<tr class="header">
<th style="text-align: left;">block</th>
<th style="text-align: left;">storage</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Counter</td>
<td style="text-align: right;">33.875</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Hanging</td>
<td style="text-align: right;">37.875</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Counter</td>
<td style="text-align: right;">49.000</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Hanging</td>
<td style="text-align: right;">44.875</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Counter</td>
<td style="text-align: right;">41.625</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Hanging</td>
<td style="text-align: right;">31.000</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
<div class="kable-table quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="do-not-create-environment cell table">
<thead>
<tr class="header">
<th style="text-align: left;">storage</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Counter</td>
<td style="text-align: right;">41.50000</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hanging</td>
<td style="text-align: right;">37.91667</td>
<td style="text-align: right;">24</td>
</tr>
</tbody>
</table>
</div>
<div class="kable-table quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="do-not-create-environment cell table">
<thead>
<tr class="header">
<th style="text-align: left;">block</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">35.8750</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">46.9375</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">36.3125</td>
<td style="text-align: right;">16</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-banana-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: [“Summary Statistics for Banana Data”,“Marginal Means for Storage Method”,“Marginal Means for Block”]
</figcaption>
</figure>
</div>
</section>
<section id="calculating-sums-of-squares" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="calculating-sums-of-squares">Calculating Sums of Squares</h2>
<div class="cell page-columns page-full" data-output-location="slide">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sums of squares</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(banana_data<span class="sc">$</span>block))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(banana_data<span class="sc">$</span>storage))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> storage_cell_means<span class="sc">$</span>n[<span class="dv">1</span>]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(banana_data)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall mean</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>y_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(banana_data<span class="sc">$</span>y)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Block sum of squares</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>SS_theta <span class="ot">&lt;-</span> v <span class="sc">*</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    s <span class="sc">*</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>((storage_block_means<span class="sc">$</span>Mean <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">*</span> v <span class="sc">*</span> s <span class="sc">*</span> (<span class="fu">mean</span>(storage_block_means<span class="sc">$</span>Mean) <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment sum of squares</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>SS_Treatment <span class="ot">&lt;-</span> b <span class="sc">*</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    s <span class="sc">*</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>((storage_margin_means<span class="sc">$</span>Mean <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">*</span> v <span class="sc">*</span> s <span class="sc">*</span> (<span class="fu">mean</span>(storage_margin_means<span class="sc">$</span>Mean) <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Total sum of squares</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>SS_Total <span class="ot">&lt;-</span> <span class="fu">sum</span>(banana_data<span class="sc">$</span>y<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> b <span class="sc">*</span> v <span class="sc">*</span> s <span class="sc">*</span> y_bar<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Error sum of squares</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>SS_Error <span class="ot">&lt;-</span> SS_Total <span class="sc">-</span> SS_theta <span class="sc">-</span> SS_Treatment</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>df_theta <span class="ot">&lt;-</span> b <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>df_Treatment <span class="ot">&lt;-</span> v <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>df_Error <span class="ot">&lt;-</span> b <span class="sc">*</span> v <span class="sc">*</span> s <span class="sc">-</span> b <span class="sc">-</span> v <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>df_Total <span class="ot">&lt;-</span> b <span class="sc">*</span> v <span class="sc">*</span> s <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># MS for Treatment and Error</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>MS_Treatment <span class="ot">&lt;-</span> SS_Treatment <span class="sc">/</span> df_Treatment</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>MS_Error <span class="ot">&lt;-</span> SS_Error <span class="sc">/</span> df_Error</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co"># F-statistic</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>F_stat <span class="ot">&lt;-</span> MS_Treatment <span class="sc">/</span> MS_Error</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>res_aov_storage_block <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Block"</span>, <span class="st">"Treatment"</span>, <span class="st">"Error"</span>, <span class="st">"Total"</span>),</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">SS =</span> <span class="fu">c</span>(SS_theta, SS_Treatment, SS_Error, SS_Total),</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">DF =</span> <span class="fu">c</span>(df_theta, df_Treatment, df_Error, df_Total),</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">MS =</span> <span class="fu">c</span>(SS_theta <span class="sc">/</span> df_theta, MS_Treatment, MS_Error, <span class="cn">NA</span>),</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">F =</span> <span class="fu">c</span>(<span class="cn">NA</span>, F_stat, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">c</span>(</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NA</span>,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pf</span>(F_stat, df_Treatment, df_Error, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NA</span>,</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NA</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>res_aov_storage_block <span class="sc">|&gt;</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"ANOVA Components for Banana Experiment"</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-banana-ss" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-output-location="slide">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-banana-ss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Component</th>
<th style="text-align: right;">SS</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">MS</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Block</td>
<td style="text-align: right;">1255.7917</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">627.8958</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment</td>
<td style="text-align: right;">154.0833</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">154.0833</td>
<td style="text-align: right;">0.8302268</td>
<td style="text-align: right;">0.367172</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Error</td>
<td style="text-align: right;">8166.0417</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">185.5919</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">9575.9167</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-banana-ss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: ANOVA Components for Banana Experiment
</figcaption>
</figure>
</div>
</div>
</section>
<section id="fitting-the-block-design-model" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="fitting-the-block-design-model">Fitting the Block Design Model</h2>
<p>Assuming ‘block’ is our blocking factor and ‘storage’ is the treatment factor, we fit the model:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fit_banana <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> block <span class="sc">+</span> storage, <span class="at">data =</span> banana_data)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>anova_banana <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_banana)[[<span class="dv">1</span>]]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(anova_banana, <span class="at">caption =</span> <span class="st">"ANOVA Table for Banana Experiment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-banana-anova-1" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-banana-anova-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">block</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1255.7917</td>
<td style="text-align: right;">627.8958</td>
<td style="text-align: right;">3.3832079</td>
<td style="text-align: right;">0.0429809</td>
</tr>
<tr class="even">
<td style="text-align: left;">storage</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">154.0833</td>
<td style="text-align: right;">154.0833</td>
<td style="text-align: right;">0.8302268</td>
<td style="text-align: right;">0.3671720</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">8166.0417</td>
<td style="text-align: right;">185.5919</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-banana-anova-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: ANOVA Table for Banana Experiment
</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compare the results from the ANOVA table with the computed Anova components from the previous code chunk.</p>
</div>
</div>
</section>
<section id="derivation-of-treatment-contrast-variance" class="level2">
<h2 class="anchored" data-anchor-id="derivation-of-treatment-contrast-variance">Derivation of Treatment Contrast Variance</h2>
<p>For a contrast <span class="math inline">\(L = \sum c_i \tau_i\)</span>, the estimated contrast is:</p>
<p><span class="math display">\[
\hat{L} = \sum c_i \bar{Y}_{.i.}
\]</span></p>
<p>with variance given by:</p>
<p><span class="math display">\[
\text{Var}(\hat{L}) = \sigma^2 \sum \frac{c_i^2}{bs}
\]</span></p>
<p>Thus, a <span class="math inline">\(100(1-\alpha)\%\)</span> confidence interval for <span class="math inline">\(L\)</span> is:</p>
<p><span class="math display">\[
\hat{L} \pm w \sqrt{MS_{Error} \sum \frac{c_i^2}{bs}}
\]</span></p>
<p>where <span class="math inline">\(w\)</span> is the critical value from the chosen method:</p>
<ol type="1">
<li>Tukey’s method: <span class="math inline">\(w_T = q_{\alpha;\, \nu, bvs-b-v+1}/ \sqrt{2}\)</span></li>
<li>Scheffé’s method: <span class="math inline">\(w_S = \sqrt{(\nu-1) F_{\alpha; \,\nu-1, bvs-b-v+1}}\)</span></li>
<li>Bonferroni’s method: <span class="math inline">\(w_B = t_{\alpha/2m;\, bvs-b-v+1}\)</span>, where <span class="math inline">\(m\)</span> is the number of contrasts.</li>
</ol>
</section>
</section>
<section id="general-complete-block-designs-with-interaction" class="level1">
<h1>General Complete Block Designs with Interaction</h1>
<section id="model-overview" class="level2">
<h2 class="anchored" data-anchor-id="model-overview">Model Overview</h2>
<p>For experiments with replicated treatments within blocks, the model extends to include block × treatment interaction:</p>
<p><span class="math display">\[
Y_{hit} = \mu + \theta_h + \tau_i + (\theta \tau)_{hi} + \epsilon_{hit}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{hit}\)</span>: Response for treatment <span class="math inline">\(i\)</span> in block <span class="math inline">\(h\)</span> on replicate <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\theta_h\)</span>: Effect of block <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\tau_i\)</span>: Effect of treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\((\theta \tau)_{hi}\)</span>: Interaction effect between block <span class="math inline">\(h\)</span> and treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\epsilon_{hit}\)</span>: Random error, assumed <span class="math inline">\(N(0,\sigma^2)\)</span>.</li>
</ul>
</section>
<section id="component-explanation" class="level2">
<h2 class="anchored" data-anchor-id="component-explanation">Component Explanation</h2>
<section id="overall-mean-and-block-effects" class="level3">
<h3 class="anchored" data-anchor-id="overall-mean-and-block-effects">1. Overall Mean and Block Effects</h3>
<ul>
<li><strong>Overall Mean</strong> <span class="math inline">\(\mu\)</span>: The grand average of all observations.</li>
<li><strong>Block Effect</strong> <span class="math inline">\(\theta_h\)</span>: Adjusts for systematic differences among blocks (e.g., different environmental conditions).</li>
</ul>
</section>
<section id="treatment-effect-and-interaction" class="level3">
<h3 class="anchored" data-anchor-id="treatment-effect-and-interaction">2. Treatment Effect and Interaction</h3>
<ul>
<li><strong>Treatment Effect</strong> <span class="math inline">\(\tau_i\)</span>: The deviation of treatment <span class="math inline">\(i\)</span>’s mean from <span class="math inline">\(\mu\)</span>.</li>
<li><strong>Interaction</strong> <span class="math inline">\((\theta \tau)_{hi}\)</span>: Captures how treatment <span class="math inline">\(i\)</span>’s effect varies in block <span class="math inline">\(h\)</span>. <strong>Example:</strong> A storage method might perform differently in Block 1 than in Block 2 due to unobserved factors.</li>
</ul>
</section>
<section id="random-error-epsilon_hit" class="level3">
<h3 class="anchored" data-anchor-id="random-error-epsilon_hit">3. Random Error <span class="math inline">\(\epsilon_{hit}\)</span></h3>
<ul>
<li>Accounts for unexplained variation.</li>
<li>Assumed to be independent and normally distributed.</li>
</ul>
</section>
</section>
</section>
<section id="numerical-example-using-banana-data" class="level1">
<h1>Numerical Example Using Banana Data</h1>
<section id="data-overview-1" class="level2">
<h2 class="anchored" data-anchor-id="data-overview-1">Data Overview</h2>
<p>The banana data includes:</p>
<ul>
<li><strong>block:</strong> Block identifier (e.g., location or time).</li>
<li><strong>light:</strong> Light condition (1 = low light, 2 = high light).</li>
<li><strong>storage:</strong> Storage method (1 = Counter, 2 = Hanging).</li>
<li><strong>y:</strong> Percentage of black color on banana peel (measure of ripeness).</li>
</ul>
<p><em>We will focus on “storage” as the treatment and “block” as the blocking factor, and illustrate the block-by-treatment interaction.</em></p>
</section>
</section>
<section id="step-by-step-computation" class="level1">
<h1>Step-by-Step Computation</h1>
<section id="step-1.-compute-means" class="level2">
<h2 class="anchored" data-anchor-id="step-1.-compute-means">Step 1. Compute Means</h2>
<ul>
<li><strong>Overall Mean:</strong></li>
</ul>
<p><span class="math display">\[
\bar{Y}_{…} = \frac{1}{n}\sum y
\]</span></p>
<ul>
<li><strong>Treatment (Storage) Mean:</strong></li>
</ul>
<p><span class="math display">\[
\bar{Y}_{.i.} = \frac{1}{n_i}\sum_{\text{storage}=i} y
\]</span></p>
<ul>
<li><strong>Block Mean:</strong></li>
</ul>
<p><span class="math display">\[
\bar{Y}_{h..} = \frac{1}{n_h}\sum_{\text{block}=h} y
\]</span></p>
</section>
<section id="step-2.-sums-of-squares" class="level2">
<h2 class="anchored" data-anchor-id="step-2.-sums-of-squares">Step 2. Sums of Squares</h2>
<ul>
<li><strong>Total Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{\text{Total}} = \sum (y - \bar{Y}_{…})^2
\]</span></p>
<ul>
<li><strong>Block Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{\theta} = vs\sum_{h} (\bar{Y}_{h..} - \bar{Y}_{…})^2
\]</span></p>
<ul>
<li><strong>Treatment Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{Treatment} = bs\sum_{i} (\bar{Y}_{.i.} - \bar{Y}_{…})^2
\]</span></p>
<ul>
<li><strong>Interaction Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{\theta\tau} = \sum_{h}\sum_{i} \left(\bar{Y}_{hi.} - \bar{Y}_{h..} - \bar{Y}_{.i.} + \bar{Y}_{…}\right)^2
\]</span></p>
<ul>
<li><strong>Error Sum of Squares:</strong></li>
</ul>
<p><span class="math display">\[
SS_{Error} = SS_{\text{Total}} - SS_{\theta} - SS_{Treatment} - SS_{\theta\tau}
\]</span></p>
<p><em>Here,</em> <span class="math inline">\(b\)</span> is the number of blocks, <span class="math inline">\(v\)</span> the number of treatments, and <span class="math inline">\(s\)</span> the number of replicates per treatment per block.</p>
</section>
</section>
<section id="r-code-implementation-and-interpretation" class="level1 page-columns page-full">
<h1>R Code Implementation and Interpretation</h1>
<section id="fitting-the-general-complete-block-design-model" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="fitting-the-general-complete-block-design-model">Fitting the General Complete Block Design Model</h2>
<p>We now fit the model that includes the block, treatment (storage), and their interaction.</p>
<div id="tbl-banana-1" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-banana-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># including block:storage interaction.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fit_banana_int <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> block <span class="sc">*</span> storage, <span class="at">data =</span> banana_data)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_banana_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value Pr(&gt;F)  
block          2   1256   627.9   3.409 0.0425 *
storage        1    154   154.1   0.836 0.3656  
block:storage  2    430   214.8   1.166 0.3215  
Residuals     42   7736   184.2                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-banana-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13: Treatment Means by Storage Method
</figcaption>
</figure>
</div>
<p><em>Interpretation:</em></p>
<ul>
<li><strong>Block:</strong> Variation among blocks.</li>
<li><strong>Storage (Treatment):</strong> Main effect of storage method.</li>
<li><strong>Block:Storage:</strong> Interaction term, indicating if storage method performance varies by block.</li>
<li><strong>Residuals:</strong> Unexplained variability.</li>
</ul>
</section>
<section id="detailed-interpretation-of-anova-results" class="level2">
<h2 class="anchored" data-anchor-id="detailed-interpretation-of-anova-results">Detailed Interpretation of ANOVA Results</h2>
<ul>
<li><strong>F-statistics:</strong> Compare the mean squares (MS) for storage and the interaction against the error MS.</li>
<li><strong>p-values:</strong> Determine if storage method and/or the interaction is statistically significant.</li>
</ul>
<p>If the interaction term is significant, it suggests that the effect of the storage method on ripening (percentage black) differs among blocks.</p>
</section>
<section id="deriving-a-contrast-for-storage-methods" class="level2">
<h2 class="anchored" data-anchor-id="deriving-a-contrast-for-storage-methods">Deriving a Contrast for Storage Methods</h2>
<p>Assume we want to compare:</p>
<p><span class="math display">\[
L = \tau_1 - \tau_2
\]</span></p>
<p>with:</p>
<p><span class="math display">\[
\hat{L} = \bar{Y}_{.1.} - \bar{Y}_{.2.}
\]</span></p>
<p>The estimated variance of <span class="math inline">\(\hat{L}\)</span> is:</p>
<p><span class="math display">\[
\text{Var}(\hat{L}) = \sigma^2 \left(\frac{1}{bs} + \frac{1}{bs}\right) = \frac{2\sigma^2}{bs}
\]</span></p>
<p>Thus, a 95% confidence interval for <span class="math inline">\(L\)</span> is given by:</p>
<p><span class="math display">\[
\hat{L} \pm t_{df,0.025} \sqrt{\frac{2MS_{Error} }{bs}}
\]</span></p>
<p>where <span class="math inline">\(MS_{Error}\)</span> is the error mean square from the ANOVA.</p>
</section>
<section id="r-code-for-contrast-and-confidence-interval" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="r-code-for-contrast-and-confidence-interval">R Code for Contrast and Confidence Interval</h2>
<div id="tbl-banana-contrast" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-banana-contrast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>storage_means <span class="ot">&lt;-</span> banana_data <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(storage) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(y))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the error mean square from the ANOVA table</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> anova_banana[<span class="st">"Residuals"</span>, <span class="st">"Mean Sq"</span>]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define number of blocks (b) and replicates per cell (s)</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(banana_data<span class="sc">$</span>block))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For simplicity, assume equal replication: s = n / (b * number_of_treatments)</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">nrow</span>(banana_data) <span class="sc">/</span> (b <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute contrast: difference between storage method 1 and 2</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>L_hat <span class="ot">&lt;-</span> storage_means<span class="sc">$</span>Mean[<span class="dv">1</span>] <span class="sc">-</span> storage_means<span class="sc">$</span>Mean[<span class="dv">2</span>]</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom for error from ANOVA table</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>df_error <span class="ot">&lt;-</span> anova_banana[<span class="st">"Residuals"</span>, <span class="st">"Df"</span>]</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standard error of the contrast</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>SE_L <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> mse <span class="sc">/</span> (b <span class="sc">*</span> s))</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Critical t-value for 95% CI</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>t_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> df_error)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence Interval for the contrast</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>CI_lower <span class="ot">&lt;-</span> L_hat <span class="sc">-</span> t_val <span class="sc">*</span> SE_L</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>CI_upper <span class="ot">&lt;-</span> L_hat <span class="sc">+</span> t_val <span class="sc">*</span> SE_L</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Contrast (Storage 1 - Storage 2):"</span>, L_hat, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Contrast (Storage 1 - Storage 2): 3.583333 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI: ["</span>, CI_lower, <span class="st">","</span>, CI_upper, <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: [ -4.342467 , 11.50913 ]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conform with emmeans package</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fit_banana, <span class="sc">~</span>storage)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(emm, <span class="fu">list</span>(<span class="st">"1 - 2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate   SE df t.ratio p.value
 1 - 2        3.58 3.93 44   0.911  0.3672

Results are averaged over the levels of: block </code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-banana-contrast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;14: Treatment Means by Storage Method
</figcaption>
</figure>
</div>
<p><em>Interpretation:</em> This code computes the difference in means between storage methods, its standard error, and a 95% confidence interval using the error variance from the ANOVA table.</p>
</section>
<section id="summary-and-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-takeaways">Summary and Takeaways</h2>
<ul>
<li>We extended the basic block design model to include a block-by-treatment interaction.</li>
<li>Detailed computations:
<ul>
<li><strong>Means, Sums of Squares, and Variance Components</strong> are essential for constructing the ANOVA.</li>
<li><strong>Contrast and Confidence Intervals:</strong> Demonstrated using storage method differences.</li>
</ul></li>
<li>The R code illustrates how to read data, fit the model, and interpret the outputs.</li>
<li>Always check the significance of the interaction to decide whether to interpret the main effects directly.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<!-- filepath: /Users/dt/Library/CloudStorage/Dropbox/Teaching/DOE/assets/includes/footer.html -->
<footer class="site-footer">
    <div class="container text-center">
        <hr> 
        © <span id="current-year"></span> Dr. Davood Tofighi |
        <a href="https://canvasinfo.unm.edu/">UNM Canvas</a> |
        <a href="https://data-wise.github.io/doe">Course GitHub Page</a> |
    </div>
    <script>
        document.getElementById("current-year").textContent = new Date().getFullYear();
    </script>
</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Data-Wise\.github\.io\/doe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>